class n{constructor(){this.channels=new Map,this.eventHistory=[],this.maxHistory=500}static getInstance(){return n.instance||(n.instance=new n),n.instance}publish(s,t){console.log(`[EventBus] Publishing: ${s}`,t);const e={timestamp:new Date().toISOString(),type:s,data:t};this.eventHistory.push(e),this.eventHistory.length>this.maxHistory&&this.eventHistory.shift(),(this.channels.get(s)||[]).forEach(h=>h(t)),(this.channels.get("*")||[]).forEach(h=>h(e))}subscribe(s,t){return this.channels.has(s)||this.channels.set(s,[]),this.channels.get(s).push(t),()=>{const e=this.channels.get(s)||[],i=e.indexOf(t);i>-1&&e.splice(i,1)}}getHistory(){return[...this.eventHistory]}}const o=n.getInstance();export{o as e};
