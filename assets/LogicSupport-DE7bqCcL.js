import{r as m,j as e,s as w,d as x,D as p,L as k,X as y,e as u,g as h,Z as b}from"./index-D-P-TEXt.js";import{A as C}from"./arrow-right-CK3AoaAa.js";import{F as n,B as f}from"./flask-conical-B1EtDvGV.js";import{C as g}from"./calculator-Cjf2TzT8.js";const M=({lang:o,t:F,api:i})=>{const[r,d]=m.useState(null),[j,c]=m.useState(!1),l=o==="fa",v=async t=>{c(!0);try{let s=null;if(t==="Variables"){const a=await i.getMetadataInputs();s=a.inputs||a}else if(t==="Templates"){const a=await i.getMetadataCalculations();s=a.calculations||a.data||a}else if(t==="Data Types"){const a=await i.getMetadataDataTypes();s=a.dataTypes||a.data||a}d({label:t,data:s})}catch(s){console.error("Failed to fetch metadata",s)}finally{c(!1)}},N={en:[{id:"purpose",icon:e.jsx(f,{className:"text-blue-500"}),title:"Purpose",content:"This guide explains how to build formulas and rules for the analytics engine. It's written for non-developers who create rules in the UI — it covers inputs, allowed operators, common templates, and how anomalies are detected."},{id:"eval",icon:e.jsx(u,{className:"text-emerald-500"}),title:"Evaluation Context",content:"Rules and formulas are evaluated server-side. Key logic resides in the Rule Engine which processes daily summaries and triggers detections based on your provisioned logic."},{id:"concepts",icon:e.jsx(h,{className:"text-amber-500"}),title:"Basic Concepts",list:[{label:"Variable (Input)",desc:"A named value from the sensors or feed (e.g., totalFeedUsed, activeBirds)."},{label:"Formula",desc:"A mathematical expression using variables and operators to compute a specific metric."},{label:"Rule",desc:"A named formula linked to alert thresholds. When a rule is evaluated, it checks if the result is within safe bounds."}]},{id:"operators",icon:e.jsx(g,{className:"text-indigo-500"}),title:"Supported Operators",content:"We use standard mathematical syntax:",list:[{label:"Arithmetic",desc:"+ (add), - (sub), * (mul), / (div), % (mod)"},{label:"Grouping",desc:"Use parentheses (...) to control order of operations"},{label:"Comparison",desc:">, <, >=, <=, === (for advanced logic conditions)"}]},{id:"examples",icon:e.jsx(n,{className:"text-purple-500"}),title:"Common Blueprints",code:[{title:"Consumption per bird (kg)",formula:"totalFeedUsed / activeBirds"},{title:"Consumption deviation (%)",formula:"((totalFeedUsed - 0.07 * activeBirds) / (totalFeedUsed || 1)) * 100"},{title:"Feed cost per bird",formula:"(totalFeedUsed * feedPrice) / activeBirds"}]},{id:"precision",icon:e.jsx(b,{className:"text-rose-500"}),title:"Floating Point Epsilon",content:"To avoid false alerts from tiny binary rounding errors (e.g., -1.6e-14), the engine treats any absolute value smaller than 1e-9 as exactly zero. This ensures stability in logic comparisons."}],fa:[{id:"purpose",icon:e.jsx(f,{className:"text-blue-500"}),title:"هدف",content:"این راهنما نحوه ساخت فرمول‌ها و قوانین برای موتور تحلیلی را توضیح می‌دهد. این محتوا برای کاربران غیربرنامه‌نویس طراحی شده تا بتوانند از طریق رابط کاربری، منطق‌های نظارتی خود را تعریف کنند."},{id:"eval",icon:e.jsx(u,{className:"text-emerald-500"}),title:"محل اجرا",content:"تمامی قوانین و فرمول‌ها در سمت سرور توسط «موتور قوانین» ارزیابی می‌شوند. این سیستم داده‌های روزانه را پردازش کرده و در صورت انحراف از منطق شما، هشدار صادر می‌کند."},{id:"concepts",icon:e.jsx(h,{className:"text-amber-500"}),title:"مفاهیم پایه",list:[{label:"متغیر (Input)",desc:"یک مقدار نام‌گذاری شده از سنسورها یا فید داده (مانند totalFeedUsed یا activeBirds)."},{label:"فرمول (Formula)",desc:"یک عبارت ریاضی که از متغیرها و عملگرها برای محاسبه یک شاخص خاص استفاده می‌کند."},{label:"قانون (Rule)",desc:"یک فرمول متصل به آستانه‌های هشدار. این سیستم بررسی می‌کند که آیا خروجی در بازه امن قرار دارد یا خیر."}]},{id:"operators",icon:e.jsx(g,{className:"text-indigo-500"}),title:"عملگرهای مورد حمایت",content:"از نحو استاندارد ریاضی استفاده کنید:",list:[{label:"حساب اصلی",desc:"+ (جمع)، - (تفریق)، * (ضرب)، / (تقسیم)، % (باقیمانده)"},{label:"گروه‌بندی",desc:"استفاده از پرانتز (...) برای کنترل اولویت عملیات"},{label:"مقایسه",desc:">, <, >=, <=, === (برای شرایط منطقی پیشرفته)"}]},{id:"examples",icon:e.jsx(n,{className:"text-purple-500"}),title:"طرح‌های رایج (Blueprints)",code:[{title:"مصرف به ازای هر پرنده (kg)",formula:"totalFeedUsed / activeBirds"},{title:"انحراف مصرف (%)",formula:"((totalFeedUsed - 0.07 * activeBirds) / (totalFeedUsed || 1)) * 100"},{title:"هزینه دان برای هر پرنده",formula:"(totalFeedUsed * feedPrice) / activeBirds"}]},{id:"precision",icon:e.jsx(b,{className:"text-rose-500"}),title:"دقت محاسباتی (Epsilon)",content:"برای جلوگیری از هشدارهای کاذب ناشی از خطاهای بسیار کوچک گرد کردن (مانند -1.6e-14)، موتور تحلیلی هر مقداری که مطلقاً کوچکتر از 1e-9 باشد را دقیقاً صفر در نظر می‌گیرد."}]}[o];return e.jsxs("div",{className:"space-y-10 pb-20 animate-in fade-in duration-700",dir:l?"rtl":"ltr",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[2.5rem] p-10 lg:p-16 text-white relative overflow-hidden shadow-2xl border border-white/5",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-blue-600/10 rounded-full translate-x-48 -translate-y-48 blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-indigo-600/10 rounded-full -translate-x-48 translate-y-48 blur-3xl"}),e.jsxs("div",{className:"relative z-10 max-w-3xl",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mb-8 shadow-xl shadow-blue-600/20",children:e.jsx(w,{size:32,strokeWidth:2})}),e.jsx("h1",{className:"text-4xl lg:text-5xl font-black tracking-tighter uppercase mb-4",children:l?"راهنمای منطق و فرمول‌ها":"Logic Support Lab"}),e.jsx("p",{className:"text-lg text-slate-400 font-medium leading-relaxed",children:l?"راهنمای جامع برای ساخت قوانین شناسایی ناهنجاری و مدل‌سازی منابع در سیستم Sentinel.":"The comprehensive guide to building advanced anomaly detection rules and resource models in the Sentinel ecosystem."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:N.map(t=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] p-8 shadow-sm hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform",children:t.icon}),e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tight",children:t.title})]}),t.content&&e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed mb-6 font-medium",children:t.content}),t.list&&e.jsx("div",{className:"space-y-4 mb-6",children:t.list.map((s,a)=>e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-slate-50 rounded-2xl border border-slate-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 shrink-0"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-black text-slate-900 uppercase block mb-1",children:s.label}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:s.desc})]})]},a))}),t.code&&e.jsx("div",{className:"space-y-4",children:t.code.map((s,a)=>e.jsxs("div",{className:"bg-slate-950 rounded-2xl p-6 shadow-inner border border-white/5 group/code",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest mb-3",children:s.title}),e.jsx("code",{className:"text-sm font-mono text-slate-300 block overflow-x-auto whitespace-nowrap scrollbar-hide",children:s.formula})]},a))})]},t.id))}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-blue-600 rounded-[2rem] p-8 text-white shadow-xl shadow-blue-600/20 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(x,{size:120})}),e.jsxs("h4",{className:"text-sm font-black uppercase tracking-widest mb-4 flex items-center gap-2 relative z-10",children:[e.jsx(x,{size:18})," Best Practices"]}),e.jsxs("ul",{className:"space-y-4 text-xs font-bold relative z-10",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-1 h-1 bg-white rounded-full mt-2"}),e.jsx("span",{children:l?"همیشه برای جلوگیری از خطای تقسیم بر صفر از || 1 استفاده کنید.":"Guard divisions with || 1 to avoid runtime zero-errors."})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-1 h-1 bg-white rounded-full mt-2"}),e.jsx("span",{children:l?"فرمول‌ها را ساده نگه دارید و هدف را در نام قانون مستند کنید.":"Keep formulas simple and document the intent in the rule name."})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-1 h-1 bg-white rounded-full mt-2"}),e.jsx("span",{children:l?"از متغیرهای استاندارد معرفی شده در متادیتا استفاده کنید.":"Prefer named inputs from metadata for consistency."})]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] p-8 shadow-sm",children:[e.jsxs("h4",{className:"text-xs font-black text-slate-900 uppercase tracking-widest mb-6 flex items-center gap-2",children:[e.jsx(p,{size:16,className:"text-indigo-500"})," API Metadata"]}),e.jsx("div",{className:"space-y-4",children:[{label:"Variables",endpoint:"/metadata/inputs"},{label:"Templates",endpoint:"/metadata/calculations"},{label:"Data Types",endpoint:"/metadata/data-types"}].map((t,s)=>e.jsxs("div",{onClick:()=>v(t.label),className:"flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-100 group cursor-pointer hover:border-indigo-300 transition-all",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-800 uppercase",children:t.label}),e.jsx("span",{className:"text-[8px] font-mono text-slate-400 mt-1",children:t.endpoint})]}),j?e.jsx(k,{size:14,className:"animate-spin text-slate-300"}):e.jsx(C,{size:14,className:"text-slate-300 group-hover:text-indigo-500 transition-colors"})]},s))})]}),e.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-[2rem] p-8 text-center",children:[e.jsx(n,{size:32,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h4",{className:"text-xs font-black text-slate-800 uppercase tracking-widest mb-2",children:"Need a custom model?"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium leading-relaxed mb-6",children:"Our analytics team can craft specialized formulas for unique flock behaviors. Contact system administrators."}),e.jsx("a",{href:"https://t.me/quader864",target:"_blank",rel:"noopener noreferrer",className:"block w-full py-3 bg-slate-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg hover:bg-black transition-all text-center",children:"Contact Support"})]})]})]}),r&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 lg:p-10 bg-slate-900/60 backdrop-blur-md overflow-hidden animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl w-full max-w-4xl max-h-full flex flex-col relative overflow-hidden animate-in zoom-in-95 duration-500",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-900 uppercase tracking-tighter flex items-center gap-3",children:[e.jsx(p,{className:"text-indigo-600"})," ",r.label]}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-1",children:"Registry Exploration Interface"})]}),e.jsx("button",{onClick:()=>d(null),className:"p-3 bg-slate-100 hover:bg-rose-50 hover:text-rose-500 text-slate-400 rounded-2xl transition-all",children:e.jsx(y,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-slate-50/30 font-mono text-xs",children:e.jsx("div",{className:"bg-slate-950 rounded-3xl p-6 lg:p-10 shadow-inner border border-white/5",children:e.jsx("pre",{className:"text-blue-400 whitespace-pre-wrap leading-relaxed",children:JSON.stringify(r.data,null,2)})})}),e.jsx("div",{className:"p-6 border-t border-slate-100 bg-white flex justify-end shrink-0",children:e.jsx("button",{onClick:()=>d(null),className:"px-10 py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em]",children:"Close Registry View"})})]})})]})};export{M as default};
