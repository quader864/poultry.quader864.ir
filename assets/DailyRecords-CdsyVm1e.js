import{c as Z,r as o,j as e,X as Re,D as ht,A as We,L as X,C as ft,a as he,U as gt}from"./index-eXbwFsV9.js";import{T as $e}from"./terminal-lBdRCL80.js";import{C as Ee}from"./code-C6poAGeE.js";import{S as Ve}from"./scale-BFUYGN_y.js";import{S as fe}from"./shield-check-CYXm3aN8.js";import{u as ke,s as vt,m as bt,d as yt,i as jt,e as oe,g as ge,f as ve,h as kt,j as Pe,S as wt,k as K,l as Nt,n as At,o as Y,p as It,q as $,r as H,t as V,v as U,w as Ge,x as Fe,y as He,z as St,B as Ct,D as ze,E as Et,F as Oe,G as Pt,H as re,I as zt,J as Ot,K as we,M as Ue,N as Dt,O as Bt,P as Mt,Z as Ne,Q as Ye,U as Lt,V as _t,W as Tt,_ as Kt,$ as ie,a0 as Rt,a1 as qe,a2 as Wt,a3 as $t,a4 as Vt,a5 as Gt,a6 as De,a7 as Xe,a8 as Ft,a9 as Ze,aa as Ht,ab as Ut,ac as T,ad as Yt,ae as qt,af as Xt,ag as Zt,ah as Qt,ai as Be,aj as Qe,ak as Je,c as Jt,R as de,A as ea,a as xe,X as ue,Y as pe,T as me,b as ta,L as aa,C as sa}from"./AreaChart-BnHbAZa9.js";import{S as ra}from"./search-BySljtqC.js";import{H as Ae,P as Me}from"./package-C1hFpSZl.js";import{C as ia,T as et}from"./trash-2-0WOYhqer.js";import{A as la}from"./arrow-up-right-56z_QLPB.js";import{P as na}from"./pen-line-1Z8lis-I.js";import{T as Le}from"./trending-up-BTe_fcKt.js";import oa from"./MovementForm-B9J-2rz3.js";import{A as ca}from"./arrow-right-CLKC6aOb.js";import"./lightbulb-Dzq5jpmH.js";import"./circle-check-DQDcvGsQ.js";import"./info-BSE2oES5.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],xa=Z("arrow-down-left",da);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],pa=Z("circle-stop",ua);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],ha=Z("layout-list",ma);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],be=Z("lock-open",fa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],va=Z("star",ga);var tt=t=>null;tt.displayName="Cell";var at=(t,a,s)=>{var r=ke();return(l,i)=>c=>{t==null||t(l,i,c),r(vt({activeIndex:String(i),activeDataKey:a,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:s}))}},st=t=>{var a=ke();return(s,r)=>l=>{t==null||t(s,r,l),a(bt())}},rt=(t,a,s)=>{var r=ke();return(l,i)=>c=>{t==null||t(l,i,c),r(yt({activeIndex:String(i),activeDataKey:a,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:s}))}},_e=(t,a,s)=>{var r=s??t;if(!oe(r))return ge(r,a,0)},ba=(t,a,s)=>{var r={},l=t.filter(jt),i=t.filter(n=>n.stackId==null),c=l.reduce((n,d)=>(n[d.stackId]||(n[d.stackId]=[]),n[d.stackId].push(d),n),r),x=Object.entries(c).map(n=>{var[d,u]=n,p=u.map(b=>b.dataKey),v=_e(a,s,u[0].barSize);return{stackId:d,dataKeys:p,barSize:v}}),m=i.map(n=>{var d=[n.dataKey].filter(p=>p!=null),u=_e(a,s,n.barSize);return{stackId:void 0,dataKeys:d,barSize:u}});return[...x,...m]};function Te(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),s.push.apply(s,r)}return s}function se(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Te(Object(s),!0).forEach(function(r){ya(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Te(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function ya(t,a,s){return(a=ja(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function ja(t){var a=ka(t,"string");return typeof a=="symbol"?a:a+""}function ka(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function wa(t,a,s,r,l){var i=r.length;if(!(i<1)){var c=ge(t,s,0,!0),x,m=[];if(ve(r[0].barSize)){var n=!1,d=s/i,u=r.reduce((f,g)=>f+(g.barSize||0),0);u+=(i-1)*c,u>=s&&(u-=(i-1)*c,c=0),u>=s&&d>0&&(n=!0,d*=.9,u=i*d);var p=(s-u)/2>>0,v={offset:p-c,size:0};x=r.reduce((f,g)=>{var I,j={stackId:g.stackId,dataKeys:g.dataKeys,position:{offset:v.offset+v.size+c,size:n?d:(I=g.barSize)!==null&&I!==void 0?I:0}},z=[...f,j];return v=z[z.length-1].position,z},m)}else{var b=ge(a,s,0,!0);s-2*b-(i-1)*c<=0&&(c=0);var h=(s-2*b-(i-1)*c)/i;h>1&&(h>>=0);var w=ve(l)?Math.min(h,l):h;x=r.reduce((f,g,I)=>[...f,{stackId:g.stackId,dataKeys:g.dataKeys,position:{offset:b+(h+c)*I+(h-w)/2,size:w}}],m)}return x}}var Na=(t,a,s,r,l,i,c)=>{var x=oe(c)?a:c,m=wa(s,r,l!==i?l:i,t,x);return l!==i&&m!=null&&(m=m.map(n=>se(se({},n),{},{position:se(se({},n.position),{},{offset:n.position.offset-l/2})}))),m},Aa=(t,a)=>{var s=kt(a);if(!(!t||s==null||a==null)){var{stackId:r}=a;if(r!=null){var l=t[r];if(l){var{stackedData:i}=l;if(i)return i.find(c=>c.key===s)}}}};function Ia(t,a){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&ve(t.zIndex)?t.zIndex:a}var Sa="Invariant failed";function Ca(t,a){throw new Error(Sa)}function ye(){return ye=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},ye.apply(null,arguments)}function le(t){return o.createElement(wt,ye({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Ea=function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,l)=>{if(Pe(a))return a;var i=Pe(r)||oe(r);return i?a(r,l):(i||Ca(),s)}},Pa=(t,a,s)=>s,za=(t,a)=>a,Q=K([Fe,za],(t,a)=>t.filter(s=>s.type==="bar").find(s=>s.id===a)),Oa=K([Q],t=>t==null?void 0:t.maxBarSize),Da=(t,a,s,r)=>r,Ba=K([Y,Fe,$,V,Pa],(t,a,s,r,l)=>a.filter(i=>t==="horizontal"?i.xAxisId===s:i.yAxisId===r).filter(i=>i.isPanorama===l).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),Ma=(t,a,s)=>{var r=Y(t),l=$(t,a),i=V(t,a);if(!(l==null||i==null))return r==="horizontal"?ze(t,"yAxis",i,s):ze(t,"xAxis",l,s)},La=(t,a)=>{var s=Y(t),r=$(t,a),l=V(t,a);if(!(r==null||l==null))return s==="horizontal"?Oe(t,"xAxis",r):Oe(t,"yAxis",l)},_a=K([Ba,Et,La],ba),Ta=(t,a,s)=>{var r,l,i=Q(t,a);if(i!=null){var c=$(t,a),x=V(t,a);if(!(c==null||x==null)){var m=Y(t),n=He(t),{maxBarSize:d}=i,u=oe(d)?n:d,p,v;return m==="horizontal"?(p=H(t,"xAxis",c,s),v=U(t,"xAxis",c,s)):(p=H(t,"yAxis",x,s),v=U(t,"yAxis",x,s)),(r=(l=Ge(p,v,!0))!==null&&l!==void 0?l:u)!==null&&r!==void 0?r:0}}},it=(t,a,s)=>{var r=Y(t),l=$(t,a),i=V(t,a);if(!(l==null||i==null)){var c,x;return r==="horizontal"?(c=H(t,"xAxis",l,s),x=U(t,"xAxis",l,s)):(c=H(t,"yAxis",i,s),x=U(t,"yAxis",i,s)),Ge(c,x)}},Ka=K([_a,He,St,Ct,Ta,it,Oa],Na),Ra=(t,a,s)=>{var r=$(t,a);if(r!=null)return H(t,"xAxis",r,s)},Wa=(t,a,s)=>{var r=V(t,a);if(r!=null)return H(t,"yAxis",r,s)},$a=(t,a,s)=>{var r=$(t,a);if(r!=null)return U(t,"xAxis",r,s)},Va=(t,a,s)=>{var r=V(t,a);if(r!=null)return U(t,"yAxis",r,s)},Ga=K([Ka,Q],(t,a)=>{if(!(t==null||a==null)){var s=t.find(r=>r.stackId===a.stackId&&a.dataKey!=null&&r.dataKeys.includes(a.dataKey));if(s!=null)return s.position}}),Fa=K([Ma,Q],Aa),Ha=K([Nt,At,Ra,Wa,$a,Va,Ga,Y,It,it,Fa,Q,Da],(t,a,s,r,l,i,c,x,m,n,d,u,p)=>{var{chartData:v,dataStartIndex:b,dataEndIndex:h}=m;if(!(u==null||c==null||a==null||x!=="horizontal"&&x!=="vertical"||s==null||r==null||l==null||i==null||n==null)){var{data:w}=u,f;if(w!=null&&w.length>0?f=w:f=v==null?void 0:v.slice(b,h+1),f!=null)return js({layout:x,barSettings:u,pos:c,parentViewBox:a,bandSize:n,xAxis:s,yAxis:r,xAxisTicks:l,yAxisTicks:i,stackedData:d,displayedData:f,offset:t,cells:p,dataStartIndex:b})}}),Ua=["index"];function je(){return je=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},je.apply(null,arguments)}function Ya(t,a){if(t==null)return{};var s,r,l=qa(t,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)s=i[r],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(l[s]=t[s])}return l}function qa(t,a){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(a.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var lt=o.createContext(void 0),Xa=t=>{var a=o.useContext(lt);if(a!=null)return a.stackId;if(t!=null)return Pt(t)},Za=(t,a)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(a),Qa=t=>{var a=o.useContext(lt);if(a!=null){var{stackId:s}=a;return"url(#".concat(Za(s,t),")")}},Ja=t=>{var{index:a}=t,s=Ya(t,Ua),r=Qa(a);return o.createElement(re,je({className:"recharts-bar-stack-layer",clipPath:r},s))},es=["onMouseEnter","onMouseLeave","onClick"],ts=["value","background","tooltipPosition"],as=["id"],ss=["onMouseEnter","onClick","onMouseLeave"];function M(){return M=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},M.apply(null,arguments)}function Ke(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),s.push.apply(s,r)}return s}function O(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?Ke(Object(s),!0).forEach(function(r){rs(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ke(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function rs(t,a,s){return(a=is(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function is(t){var a=ls(t,"string");return typeof a=="symbol"?a:a+""}function ls(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function ne(t,a){if(t==null)return{};var s,r,l=ns(t,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)s=i[r],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(l[s]=t[s])}return l}function ns(t,a){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(a.indexOf(r)!==-1)continue;s[r]=t[r]}return s}var os=t=>{var{dataKey:a,name:s,fill:r,legendType:l,hide:i}=t;return[{inactive:i,dataKey:a,type:l,color:r,value:Ye(s,a),payload:t}]},cs=o.memo(t=>{var{dataKey:a,stroke:s,strokeWidth:r,fill:l,name:i,hide:c,unit:x,tooltipType:m,id:n}=t,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:s,strokeWidth:r,fill:l,dataKey:a,nameKey:void 0,name:Ye(i,a),hide:c,type:m,color:l,unit:x,graphicalItemId:n}};return o.createElement(Lt,{tooltipEntrySettings:d})});function ds(t){var a=ie(Xe),{data:s,dataKey:r,background:l,allOtherBarProps:i}=t,{onMouseEnter:c,onMouseLeave:x,onClick:m}=i,n=ne(i,es),d=at(c,r,i.id),u=st(x),p=rt(m,r,i.id);if(!l||s==null)return null;var v=Ft(l);return o.createElement(Ne,{zIndex:Ia(l,we.barBackground)},s.map((b,h)=>{var{value:w,background:f,tooltipPosition:g}=b,I=ne(b,ts);if(!f)return null;var j=d(b,h),z=u(b,h),k=p(b,h),D=O(O(O(O(O({option:l,isActive:String(h)===a},I),{},{fill:"#eee"},f),v),Ze(n,b,h)),{},{onMouseEnter:j,onMouseLeave:z,onClick:k,dataKey:r,index:h,className:"recharts-bar-background-rectangle"});return o.createElement(le,M({key:"background-bar-".concat(h)},D))}))}function xs(t){var{showLabels:a,children:s,rects:r}=t,l=r==null?void 0:r.map(i=>{var c={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return O(O({},c),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:c,fill:i.fill})});return o.createElement(qt,{value:a?l:void 0},s)}function us(t){var{shape:a,activeBar:s,baseProps:r,entry:l,index:i,dataKey:c}=t,x=ie(Xe),m=ie(Zt),n=s&&String(i)===x&&(m==null||c===m),d=n?s:a;return n?o.createElement(Ne,{zIndex:we.activeBar},o.createElement(le,M({},r,{name:String(r.name)},l,{isActive:n,option:d,index:i,dataKey:c}))):o.createElement(le,M({},r,{name:String(r.name)},l,{isActive:n,option:d,index:i,dataKey:c}))}function ps(t){var{shape:a,baseProps:s,entry:r,index:l,dataKey:i}=t;return o.createElement(le,M({},s,{name:String(s.name)},r,{isActive:!1,option:a,index:l,dataKey:i}))}function ms(t){var a,{data:s,props:r}=t,l=(a=Xt(r))!==null&&a!==void 0?a:{},{id:i}=l,c=ne(l,as),{shape:x,dataKey:m,activeBar:n}=r,{onMouseEnter:d,onClick:u,onMouseLeave:p}=r,v=ne(r,ss),b=at(d,m,i),h=st(p),w=rt(u,m,i);return s?o.createElement(o.Fragment,null,s.map((f,g)=>o.createElement(Ja,M({index:g,key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(g),className:"recharts-bar-rectangle"},Ze(v,f,g),{onMouseEnter:b(f,g),onMouseLeave:h(f,g),onClick:w(f,g)}),n?o.createElement(us,{shape:x,activeBar:n,baseProps:c,entry:f,index:g,dataKey:m}):o.createElement(ps,{shape:x,baseProps:c,entry:f,index:g,dataKey:m})))):null}function hs(t){var{props:a,previousRectanglesRef:s}=t,{data:r,layout:l,isAnimationActive:i,animationBegin:c,animationDuration:x,animationEasing:m,onAnimationEnd:n,onAnimationStart:d}=a,u=s.current,p=Ht(a,"recharts-bar-"),[v,b]=o.useState(!1),h=!v,w=o.useCallback(()=>{typeof n=="function"&&n(),b(!1)},[n]),f=o.useCallback(()=>{typeof d=="function"&&d(),b(!0)},[d]);return o.createElement(xs,{showLabels:h,rects:r},o.createElement(Ut,{animationId:p,begin:c,duration:x,isActive:i,easing:m,onAnimationEnd:w,onAnimationStart:f,key:p},g=>{var I=g===1?r:r==null?void 0:r.map((j,z)=>{var k=u&&u[z];if(k)return O(O({},j),{},{x:T(k.x,j.x,g),y:T(k.y,j.y,g),width:T(k.width,j.width,g),height:T(k.height,j.height,g)});if(l==="horizontal"){var D=T(0,j.height,g),C=T(j.stackedBarStart,j.y,g);return O(O({},j),{},{y:C,height:D})}var E=T(0,j.width,g),S=T(j.stackedBarStart,j.x,g);return O(O({},j),{},{width:E,x:S})});return g>0&&(s.current=I??null),I==null?null:o.createElement(re,null,o.createElement(ms,{props:a,data:I}))}),o.createElement(Yt,{label:a.label}),a.children)}function fs(t){var a=o.useRef(null);return o.createElement(hs,{previousRectanglesRef:a,props:t})}var nt=0,gs=(t,a)=>{var s=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:s,errorVal:qe(t,a)}};class vs extends o.PureComponent{render(){var{hide:a,data:s,dataKey:r,className:l,xAxisId:i,yAxisId:c,needClip:x,background:m,id:n}=this.props;if(a||s==null)return null;var d=Wt("recharts-bar",l),u=n;return o.createElement(re,{className:d,id:n},x&&o.createElement("defs",null,o.createElement($t,{clipPathId:u,xAxisId:i,yAxisId:c})),o.createElement(re,{className:"recharts-bar-rectangles",clipPath:x?"url(#clipPath-".concat(u,")"):void 0},o.createElement(ds,{data:s,dataKey:r,background:m,allOtherBarProps:this.props}),o.createElement(fs,this.props)))}}var bs={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:nt,xAxisId:0,yAxisId:0,zIndex:we.bar};function ys(t){var{xAxisId:a,yAxisId:s,hide:r,legendType:l,minPointSize:i,activeBar:c,animationBegin:x,animationDuration:m,animationEasing:n,isAnimationActive:d}=t,{needClip:u}=_t(a,s),p=Tt(),v=Ue(),b=Kt(t.children,tt),h=ie(g=>Ha(g,t.id,v,b));if(p!=="vertical"&&p!=="horizontal")return null;var w,f=h==null?void 0:h[0];return f==null||f.height==null||f.width==null?w=0:w=p==="vertical"?f.height/2:f.width/2,o.createElement(Rt,{xAxisId:a,yAxisId:s,data:h,dataPointFormatter:gs,errorBarOffset:w},o.createElement(vs,M({},t,{layout:p,needClip:u,data:h,xAxisId:a,yAxisId:s,hide:r,legendType:l,minPointSize:i,activeBar:c,animationBegin:x,animationDuration:m,animationEasing:n,isAnimationActive:d})))}function js(t){var{layout:a,barSettings:{dataKey:s,minPointSize:r},pos:l,bandSize:i,xAxis:c,yAxis:x,xAxisTicks:m,yAxisTicks:n,stackedData:d,displayedData:u,offset:p,cells:v,parentViewBox:b,dataStartIndex:h}=t,w=a==="horizontal"?x:c,f=d?w.scale.domain():null,g=Vt({numericAxis:w}),I=w.scale(g);return u.map((j,z)=>{var k,D,C,E,S,R;if(d){var W=d[z+h];if(W==null)return null;k=Gt(W,f)}else k=qe(j,s),Array.isArray(k)||(k=[g,k]);var B=Ea(r,nt)(k[1],z);if(a==="horizontal"){var G,[F,L]=[x.scale(k[0]),x.scale(k[1])];D=De({axis:c,ticks:m,bandSize:i,offset:l.offset,entry:j,index:z}),C=(G=L??F)!==null&&G!==void 0?G:void 0,E=l.size;var q=F-L;if(S=Qt(q)?0:q,R={x:D,y:p.top,width:E,height:p.height},Math.abs(B)>0&&Math.abs(S)<Math.abs(B)){var J=Be(S||B)*(Math.abs(B)-Math.abs(S));C-=J,S+=J}}else{var[ee,ce]=[c.scale(k[0]),c.scale(k[1])];if(D=ee,C=De({axis:x,ticks:n,bandSize:i,offset:l.offset,entry:j,index:z}),E=ce-ee,S=l.size,R={x:p.left,y:C,width:p.width,height:S},Math.abs(B)>0&&Math.abs(E)<Math.abs(B)){var te=Be(E||B)*(Math.abs(B)-Math.abs(E));E+=te}}if(D==null||C==null||E==null||S==null)return null;var A=O(O({},j),{},{stackedBarStart:I,x:D,y:C,width:E,height:S,value:d?k:k[1],payload:j,background:R,tooltipPosition:{x:D+E/2,y:C+S/2},parentViewBox:b},v&&v[z]&&v[z].props);return A}).filter(Boolean)}function ks(t){var a=Ot(t,bs),s=Xa(a.stackId),r=Ue();return o.createElement(Dt,{id:a.id,type:"bar"},l=>o.createElement(o.Fragment,null,o.createElement(Bt,{legendPayload:os(a)}),o.createElement(cs,{dataKey:a.dataKey,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType,id:l}),o.createElement(Mt,{type:"bar",id:l,data:void 0,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,stackId:s,hide:a.hide,barSize:a.barSize,minPointSize:a.minPointSize,maxBarSize:a.maxBarSize,isPanorama:r}),o.createElement(Ne,{zIndex:a.zIndex},o.createElement(ys,M({},a,{id:l})))))}var ot=o.memo(ks,zt);ot.displayName="Bar";var ws=["axis"],Ns=o.forwardRef((t,a)=>o.createElement(Qe,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ws,tooltipPayloadSearcher:Je,categoricalChartProps:t,ref:a})),As=["axis","item"],Is=o.forwardRef((t,a)=>o.createElement(Qe,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:As,tooltipPayloadSearcher:Je,categoricalChartProps:t,ref:a}));const Ss=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col overflow-hidden animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx($e,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter",children:"Unified Movement Registry API"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Endpoint: /flocks/:flockId/cycles/:cycleId/movements"})]})]}),e.jsx("button",{onClick:t,className:"p-3 bg-slate-100 hover:bg-rose-50 hover:text-rose-500 text-slate-400 rounded-2xl transition-all shadow-sm",children:e.jsx(Re,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-10 space-y-12 no-scrollbar",children:[e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"text-blue-500",size:24}),e.jsx("h3",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"Core Schemas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-blue-400 mb-6 flex items-center gap-2",children:[e.jsx(Ee,{size:12})," BIRD INFLOW"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-blue-300 leading-relaxed overflow-x-auto",children:`{
  "type": "bird_inflow",
  "reason": "purchase",
  "birdMetrics": {
    "count": 3400,
    "age": 16,
    "weightPerBird": 850,
    "source": "Supplier ABC"
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-emerald-400 mb-6 flex items-center gap-2",children:[e.jsx(Ee,{size:12})," FEED - PURCHASE"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-emerald-300 leading-relaxed overflow-x-auto",children:`{
  "type": "feed",
  "reason": "supply",
  "feedMetrics": {
    "purchasedKg": 3400,
    "feedType": "Layer Starter",
    "supplier": "Supplier ABC",
    "cost": 12.50
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-200",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-slate-500 mb-6 flex items-center gap-2",children:[e.jsx(Ve,{size:12})," WEIGHT SAMPLING"]}),e.jsx("div",{className:"bg-white p-5 rounded-2xl text-[11px] font-mono text-slate-700 leading-relaxed border border-slate-100 shadow-inner",children:`{
  "type": "weight",
  "weightMetrics": {
    "grams": 900,
    "method": "scale"
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-rose-50 rounded-[2.5rem] border border-rose-100",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-rose-500 mb-6 flex items-center gap-2",children:[e.jsx(fe,{size:12})," MORTALITY EVENT"]}),e.jsx("div",{className:"bg-white p-5 rounded-2xl text-[11px] font-mono text-rose-700 leading-relaxed border border-rose-100 shadow-inner",children:`{
  "type": "mortality",
  "reason": "disease",
  "mortalityMetrics": {
    "count": 3
  },
  "notes": "Respiratory infection"
}`})]})]})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-[2.5rem] p-8 flex items-center gap-8 shadow-sm",children:[e.jsx(fe,{size:48,className:"text-amber-600 shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-black text-amber-900 uppercase tracking-tight",children:"Security & Immutability"}),e.jsxs("p",{className:"text-[11px] font-medium text-amber-800 leading-relaxed",children:["All records once committed are assigned a ",e.jsx("code",{className:"bg-amber-200 p-0.5 rounded",children:"NODE_ID"})," and entered into the audit trail. Deletion requires an explicit ",e.jsx("code",{className:"bg-amber-200 p-0.5 rounded",children:"permanent=true"})," flag and high-level clearance."]})]})]})]}),e.jsx("div",{className:"p-8 border-t border-slate-100 flex justify-end bg-white",children:e.jsx("button",{onClick:t,className:"px-10 py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] shadow-xl hover:bg-black transition-all",children:"Close Documentation"})})]})}),Cs=({currentCycle:t,movementsCount:a,flockName:s,selectedCycleId:r,formatDate:l})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4 animate-in slide-in-from-top-4 duration-700",children:[e.jsxs("div",{className:"bg-slate-900 rounded-2xl lg:rounded-3xl p-4 lg:p-6 text-white border border-white/5 shadow-xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 group-hover:scale-110 transition-transform duration-1000",children:e.jsx(We,{size:60})}),e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-500 uppercase tracking-widest mb-1",children:"Cycle Integrity"}),e.jsx("h4",{className:"text-xl lg:text-2xl font-black tracking-tighter uppercase",children:(t==null?void 0:t.status)||"N/A"}),e.jsxs("div",{className:"mt-2 lg:mt-3 flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.status)==="active"?"bg-emerald-500 animate-pulse":"bg-slate-500"}`}),e.jsxs("span",{className:"text-[9px] lg:text-[10px] font-bold text-slate-400",children:["Since ",t?l(t.startDate):"---"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm group",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Total Logs"}),e.jsx("h4",{className:"text-2xl lg:text-3xl font-black text-slate-900 tabular-nums",children:a}),e.jsxs("p",{className:"text-[9px] lg:text-[10px] font-bold text-blue-600 mt-1 lg:mt-2",children:["ID: ",r]})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Production Node"}),e.jsx("h4",{className:"text-xl lg:text-2xl font-black text-slate-900 uppercase truncate",children:s||"---"}),e.jsx("p",{className:"text-[9px] lg:text-[10px] font-bold text-slate-400 mt-1 lg:mt-2 uppercase tracking-widest",children:"Fleet Active"})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm flex flex-col justify-between",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"System Health"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs lg:text-sm font-black text-slate-800 font-mono uppercase",children:"Nominal"}),e.jsx(fe,{size:18,className:"text-emerald-500"})]})]})]}),Es=({viewMode:t,setViewMode:a,searchTerm:s,setSearchTerm:r,selectedCycleId:l,onCycleChange:i,cycles:c,loadingCycles:x,onInitCycle:m,onEndCycle:n,endingCycle:d,canEndCycle:u,onShowDocs:p,isRtl:v,t:b})=>e.jsx("div",{className:"p-4 lg:p-8 border-b border-slate-100 bg-slate-50/30",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-4",children:[e.jsxs("div",{className:"flex bg-white border border-slate-200 p-1 rounded-xl shadow-sm",children:[e.jsxs("button",{onClick:()=>a("list"),className:`flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all ${t==="list"?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:[e.jsx(ha,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"List"})]}),e.jsxs("button",{onClick:()=>a("visual"),className:`flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all ${t==="visual"?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:[e.jsx(Jt,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Visual"})]})]}),e.jsxs("div",{className:"relative group flex-1",children:[e.jsx(ra,{className:`absolute ${v?"right-4":"left-4"} top-1/2 -translate-y-1/2 text-slate-400`,size:16}),e.jsx("input",{type:"text",placeholder:v?"جستجوی فید داده...":"Search stream...",className:`w-full ${v?"pr-10":"pl-10"} py-2.5 bg-white border border-slate-200 rounded-xl text-xs font-bold shadow-sm focus:ring-4 focus:ring-blue-500/10 outline-none`,value:s,onChange:h=>r(h.target.value)})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-white border border-slate-200 rounded-xl px-3 py-1.5 shadow-sm gap-2 h-[42px] flex-1 min-w-[140px]",children:[e.jsx(Ae,{size:14,className:"text-slate-400 shrink-0"}),e.jsxs("select",{value:l,onChange:h=>i(h.target.value),className:"bg-transparent border-none text-[9px] font-black uppercase tracking-widest text-slate-700 outline-none cursor-pointer w-full",children:[e.jsx("option",{value:"",children:x?"LOADING...":"SELECT CYCLE"}),c.map(h=>e.jsxs("option",{value:h.cycleId,children:[h.cycleId," ",h.status==="active"?"• ACT":""]},h.cycleId))]}),x&&e.jsx(X,{size:12,className:"animate-spin text-blue-500 shrink-0"})]}),e.jsxs("button",{onClick:m,className:"h-[42px] px-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-all flex items-center justify-center gap-2 text-[9px] font-black uppercase tracking-widest flex-1 min-w-[130px]",children:[e.jsx(ft,{size:14})," Initiate Cycle"]}),u&&e.jsxs("button",{onClick:n,disabled:d,className:"h-[42px] px-4 bg-rose-50 text-rose-600 border border-rose-100 rounded-xl hover:bg-rose-600 hover:text-white transition-all flex items-center justify-center gap-2 text-[9px] font-black uppercase tracking-widest flex-1 min-w-[110px]",children:[d?e.jsx(X,{size:12,className:"animate-spin"}):e.jsx(pa,{size:14}),"End Cycle"]}),e.jsxs("button",{onClick:p,className:"h-[42px] px-4 bg-white border border-slate-200 text-slate-600 rounded-xl hover:bg-slate-50 transition-all flex items-center justify-center gap-2 text-[9px] font-black uppercase tracking-widest shadow-sm flex-1 sm:flex-none",children:[e.jsx($e,{size:14})," Reference"]})]})]})}),Ps=({level:t})=>{const a=t==="high"?3:t==="medium"?2:1;return e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"flex items-center gap-0.5 text-amber-400",children:[...Array(3)].map((s,r)=>e.jsx(va,{size:10,fill:r<a?"currentColor":"none",className:r<a?"":"text-slate-200"},r))}),e.jsx("span",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest",children:t})]})},zs=({movements:t,formatDate:a,onEdit:s,onDelete:r,onLock:l,onUnlock:i,onViewHistory:c})=>{const x=n=>{var d,u,p,v,b,h;switch(n.type){case"bird_inflow":case"bird_outflow":case"mortality":case"sale":case"adjustment":return((d=n.birdMetrics)==null?void 0:d.count)??0;case"egg_collection":case"egg_breakage":return((u=n.eggMetrics)==null?void 0:u.count)??0;case"weight_measurement":return((p=n.weightMetrics)==null?void 0:p.endWeightGrams)??((v=n.weightMetrics)==null?void 0:v.grams)??0;case"feed_consumption":return((b=n.feedMetrics)==null?void 0:b.consumedKg)??((h=n.feedMetrics)==null?void 0:h.purchasedKg)??0;default:return 0}},m=n=>{switch(n.type){case"bird_inflow":case"bird_outflow":case"mortality":case"sale":case"adjustment":return"Birds";case"egg_collection":case"egg_breakage":return"Eggs";case"weight_measurement":return"Grams";case"feed_consumption":return"KG";default:return""}};return e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full text-left text-sm border-collapse min-w-[1100px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/80 text-slate-400 font-black border-b border-slate-200 uppercase tracking-[0.2em] text-[9px] lg:text-[10px]",children:[e.jsx("th",{className:"px-6 py-4 w-20 text-center",children:"Vector"}),e.jsx("th",{className:"px-6 py-4",children:"Event Time"}),e.jsx("th",{className:"px-6 py-4",children:"Type / Reason"}),e.jsx("th",{className:"px-6 py-4",children:"Quantity"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Consensus"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 bg-white",children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-24 text-center opacity-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(ia,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em]",children:"Registry Empty"})]})})}):t.map(n=>{var d;return e.jsxs("tr",{className:`hover:bg-blue-50/10 transition-all group ${n.locked?"bg-slate-50/30":""}`,children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:`w-10 h-10 mx-auto rounded-xl flex items-center justify-center transition-transform group-hover:scale-110 ${n.type==="bird_inflow"||n.type==="egg_collection"?"bg-emerald-50 text-emerald-600":n.type==="mortality"||n.type==="egg_breakage"?"bg-rose-50 text-rose-600":"bg-slate-50 text-slate-500"}`,children:n.type==="bird_inflow"||n.type==="egg_collection"?e.jsx(xa,{size:18}):e.jsx(la,{size:18})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-xs font-black text-slate-900",children:a(n.date)}),e.jsxs("div",{className:"text-[8px] font-bold text-slate-400 uppercase tracking-widest mt-0.5 font-mono",children:["NODE ID: ",n._id.slice(-6).toUpperCase()]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"px-2 py-0.5 bg-slate-900 text-white rounded text-[7px] font-black uppercase tracking-widest self-start",children:n.type.replace("_"," ")}),e.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-tight ml-1",children:((d=n.reason)==null?void 0:d.replace("_"," "))||"standard"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-end gap-1",children:[e.jsx("span",{className:"text-base font-black text-slate-900 tabular-nums",children:x(n).toLocaleString()}),e.jsx("span",{className:"text-[8px] font-bold text-slate-400 uppercase mb-1",children:m(n)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Ps,{level:n.confidence})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border ${n.locked?"bg-amber-50 text-amber-600 border-amber-100":"bg-emerald-50 text-emerald-600 border-emerald-100"}`,children:n.locked?e.jsxs(e.Fragment,{children:[e.jsx(he,{size:10})," Locked"]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{size:10})," Editable"]})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>c(n),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View Audit Trail",children:e.jsx(Ae,{size:16})}),!n.locked&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s(n),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Edit Metrics",children:e.jsx(na,{size:16})}),e.jsx("button",{onClick:()=>r(n),className:"p-2 text-rose-600 hover:bg-rose-50 rounded-lg transition-all",title:"Soft Delete",children:e.jsx(et,{size:16})})]}),e.jsx("button",{onClick:()=>n.locked?i(n):l(n),className:`p-2 rounded-lg transition-all ${n.locked?"text-amber-600 hover:bg-amber-50":"text-slate-400 hover:text-amber-600 hover:bg-amber-50"}`,title:n.locked?"Request Unlock":"Verify & Lock",children:n.locked?e.jsx(he,{size:16}):e.jsx(be,{size:16})})]})})]},n._id)})})]})})},Os=({loading:t,data:a})=>{if(t)return e.jsxs("div",{className:"h-[300px] flex flex-col items-center justify-center gap-4 opacity-40",children:[e.jsx(X,{size:32,className:"animate-spin text-blue-600"}),e.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.4em]",children:"Compiling Analytics..."})]});const s=a.weights&&a.weights.length>0,r=a.eggs&&a.eggs.length>0,l=a.feed&&a.feed.length>0;return e.jsx("div",{className:"p-6 lg:p-14 space-y-8 lg:space-y-14 animate-in fade-in duration-700",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-3xl p-6 lg:p-10 shadow-sm group min-h-[400px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-2xl group-hover:rotate-6 transition-transform",children:e.jsx(Ve,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-black text-slate-900 uppercase tracking-tight",children:"Mass Velocity"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:"Weight Growth (G)"})]})]}),e.jsx(Le,{size:20,className:"text-emerald-500"})]}),e.jsx("div",{className:"flex-1 min-h-[250px] w-full relative",children:s?e.jsx(de,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:e.jsxs(ea,{data:a.weights,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"massCurve",x1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.15}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(xe,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(ue,{dataKey:"date",hide:!0}),e.jsx(pe,{axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94a3b8"}}),e.jsx(me,{contentStyle:{borderRadius:"16px",border:"none",boxShadow:"0 10px 25px -5px rgb(0 0 0 / 0.1)"}}),e.jsx(ta,{type:"monotone",dataKey:"grams",stroke:"#3b82f6",strokeWidth:4,fillOpacity:1,fill:"url(#massCurve)",animationDuration:1e3})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-300 text-[10px] font-black uppercase tracking-widest",children:"Awaiting Data"})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-3xl p-6 lg:p-10 shadow-sm group min-h-[400px] flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-8 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-50 text-emerald-600 rounded-2xl group-hover:scale-110 transition-transform",children:e.jsx(Le,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-black text-slate-900 uppercase tracking-tight",children:"Yield Efficiency"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:"Egg Collection Yield"})]})]})}),e.jsx("div",{className:"flex-1 min-h-[250px] w-full relative",children:r?e.jsx(de,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:e.jsxs(Is,{data:a.eggs,children:[e.jsx(xe,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(ue,{dataKey:"date",hide:!0}),e.jsx(pe,{axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94a3b8"}}),e.jsx(me,{contentStyle:{borderRadius:"16px",border:"none"}}),e.jsx(ot,{dataKey:"count",fill:"#10b981",radius:[4,4,0,0],animationDuration:1e3})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-300 text-[10px] font-black uppercase tracking-widest",children:"Awaiting Data"})})]}),e.jsxs("div",{className:"bg-slate-900 rounded-[2rem] lg:rounded-[3.5rem] p-8 lg:p-12 xl:col-span-2 shadow-2xl relative overflow-hidden min-h-[400px] flex flex-col",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 text-white",children:e.jsx(Me,{size:120})}),e.jsxs("div",{className:"flex items-center gap-5 mb-10 relative z-10 shrink-0",children:[e.jsx("div",{className:"p-4 bg-white/10 text-white rounded-2xl",children:e.jsx(Me,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-black text-white uppercase tracking-tight",children:"Resource Drain Matrix"}),e.jsx("p",{className:"text-[9px] font-black text-slate-500 uppercase tracking-[0.3em] mt-1",children:"Consolidated Feed Intake (KG)"})]})]}),e.jsx("div",{className:"flex-1 min-h-[300px] relative z-10 w-full",children:l?e.jsx(de,{width:"100%",height:"100%",minWidth:0,minHeight:0,children:e.jsxs(Ns,{data:a.feed,children:[e.jsx(xe,{strokeDasharray:"3 3",vertical:!1,stroke:"#ffffff10"}),e.jsx(ue,{dataKey:"date",hide:!0}),e.jsx(pe,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#64748b"}}),e.jsx(me,{contentStyle:{backgroundColor:"#0f172a",borderRadius:"16px",border:"1px solid #1e293b",color:"white"},itemStyle:{color:"#60a5fa",fontWeight:900}}),e.jsx(aa,{type:"stepAfter",dataKey:"consumedKg",stroke:"#3b82f6",strokeWidth:4,dot:{r:6,fill:"#3b82f6",strokeWidth:3,stroke:"#0f172a"}})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-700 text-[10px] font-black uppercase tracking-widest",children:"Awaiting Data Feed"})})]})]})})},Ds=({movement:t,flockId:a,onClose:s,api:r})=>{const[l,i]=o.useState([]),[c,x]=o.useState(!0);o.useEffect(()=>{(async()=>{try{const d=t.flockId||a;if(!d||d==="all"){i([]),x(!1);return}const u=await r.getMovementHistory(d,t.cycleId,t._id);let p=[];u&&Array.isArray(u.history)?p=u.history:u&&Array.isArray(u.data)?p=u.data:Array.isArray(u)&&(p=u),i(p)}catch(d){console.error("Audit history inaccessible",d),i([])}finally{x(!1)}})()},[t._id,a,t.cycleId,r,t.flockId]);const m=Array.isArray(l)?l:[];return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[110] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(Ae,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"Audit Trail"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-1",children:["Ref: ",t._id.slice(-8).toUpperCase()]})]})]}),e.jsx("button",{onClick:s,className:"p-3 bg-white hover:bg-rose-50 hover:text-rose-500 text-slate-400 rounded-xl transition-all shadow-sm",children:e.jsx(Re,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 no-scrollbar",children:c?e.jsxs("div",{className:"py-20 flex flex-col items-center gap-4 opacity-40",children:[e.jsx(X,{className:"animate-spin text-blue-600",size:32}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em]",children:"Querying Node History..."})]}):m.length===0?e.jsxs("div",{className:"py-20 text-center flex flex-col items-center gap-4 opacity-30",children:[e.jsx(We,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-sm font-black uppercase tracking-widest",children:"No revision history found"})]}):e.jsxs("div",{className:"space-y-8 relative",children:[e.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-slate-100"}),m.map((n,d)=>e.jsxs("div",{className:"relative pl-14 group",children:[e.jsx("div",{className:"absolute left-[21px] top-0 w-2.5 h-2.5 rounded-full bg-slate-200 border-2 border-white group-hover:bg-blue-500 transition-colors"}),e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 group-hover:bg-white group-hover:border-blue-200 group-hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-slate-900 text-white rounded text-[8px] font-black uppercase tracking-widest",children:n.action}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-50",children:[e.jsx(sa,{size:12,className:"text-slate-400"})," ",new Date(n.timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black text-blue-600 uppercase",children:[e.jsx(gt,{size:12})," ",n.userName||"Operator"]})]}),n.changes&&Array.isArray(n.changes)&&n.changes.length>0&&e.jsx("div",{className:"space-y-3 pt-3 border-t border-slate-100",children:n.changes.map((u,p)=>e.jsxs("div",{className:"flex items-center gap-3 text-[11px] font-medium",children:[e.jsx("span",{className:"text-slate-400 font-black uppercase tracking-tighter w-24 truncate",children:u.field}),e.jsx("span",{className:"text-rose-500 line-through opacity-50",children:String(u.oldValue)}),e.jsx(ca,{size:10,className:"text-slate-300"}),e.jsx("span",{className:"text-emerald-600 font-black",children:String(u.newValue)})]},p))})]})]},d))]})}),e.jsx("div",{className:"p-8 border-t border-slate-100 flex justify-end",children:e.jsx("button",{onClick:s,className:"px-10 py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em]",children:"Close View"})})]})})},Zs=({movements:t,userRole:a,capabilities:s,t:r,api:l,selectedFlockId:i,flocks:c,selectedCycleId:x,onCycleChange:m,onRefresh:n})=>{var Ce;const[d,u]=o.useState("list"),[p,v]=o.useState(""),[b,h]=o.useState(!1),[w,f]=o.useState([]),[g,I]=o.useState(!1),[j,z]=o.useState(!1),[k,D]=o.useState(null),[C,E]=o.useState(null),[S,R]=o.useState(""),[W,B]=o.useState(!1),[G,F]=o.useState(null),[L,q]=o.useState(null),[J,ee]=o.useState({weights:[],feed:[],eggs:[]}),[ce,te]=o.useState(!1),A=r.langToggle==="EN",ct=async()=>{if(i&&i!=="all"){I(!0);try{const N=((await l.getCycles(i)).cycles||[]).sort((P,_)=>_.cycleId.localeCompare(P.cycleId));if(f(N),!x&&N.length>0){const P=N.find(_=>_.status==="active")||N[0];m(P.cycleId)}}catch(y){console.error("Failed to load cycles",y)}finally{I(!1)}}else f([])};o.useEffect(()=>{ct()},[i,l]),o.useEffect(()=>{(async()=>{if(d==="visual"&&i!=="all"&&x){te(!0);try{const[N,P,_]=await Promise.all([l.getWeights(i,x),l.getFeed(i,x),l.getEggs(i,x)]);ee({weights:N.weights||[],feed:P.feed||[],eggs:_.eggs||[]})}catch(N){console.error("Visual sync failed",N)}finally{te(!1)}}})()},[d,i,x,l]);const Ie=y=>{const N=y.flockId||(i!=="all"?i:null),P=y.cycleId||x||null;if(!N||N==="all")throw new Error("Target node ID missing.");if(!P)throw new Error("Cycle context lost.");return{fId:N,cId:P}},dt=async()=>{if(!(!k||W)){B(!0);try{const{fId:y,cId:N}=Ie(k),P=await l.deleteMovement(y,N,k._id,!0);if(P&&P.success)n(),D(null);else throw new Error("Server rejected request.")}catch(y){alert(y.message||"Operation failed.")}finally{B(!1)}}},xt=async()=>{if(!C||!S)return;const{movement:y,type:N}=C;try{const{fId:P,cId:_}=Ie(y);N==="lock"?await l.lockMovement(P,_,y._id,S):await l.unlockMovement(P,_,y._id,S),n(),E(null),R("")}catch(P){alert(P.message||"Operation failed.")}},Se=y=>new Date(y).toLocaleDateString(A?"fa-IR":"en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"Asia/Tehran"}),ut=t.filter(y=>{if(!p)return!0;const N=p.toLowerCase();return y.type.toLowerCase().includes(N)||(y.reason||"").toLowerCase().includes(N)}),ae=w.find(y=>y.cycleId===x),pt=(ae==null?void 0:ae.status)==="active",mt=(Ce=c.find(y=>y._id===i))==null?void 0:Ce.name;return e.jsxs("div",{className:"flex flex-col h-full gap-4 lg:gap-6 animate-in fade-in duration-500",dir:A?"rtl":"ltr",children:[i!=="all"&&x&&e.jsx(Cs,{currentCycle:ae,movementsCount:t.length,flockName:mt,selectedCycleId:x,isRtl:A,formatDate:Se}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[1.5rem] lg:rounded-[2.5rem] overflow-hidden shadow-sm flex flex-col h-full transition-all relative",children:[e.jsx(Es,{viewMode:d,setViewMode:u,searchTerm:p,setSearchTerm:v,selectedCycleId:x,onCycleChange:m,cycles:w,loadingCycles:g,onInitCycle:()=>{},onEndCycle:()=>{},endingCycle:j,canEndCycle:pt,onShowDocs:()=>h(!0),isRtl:A,t:r}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto no-scrollbar",children:d==="list"?e.jsx(zs,{movements:ut,formatDate:Se,onEdit:F,onDelete:D,onLock:y=>E({movement:y,type:"lock"}),onUnlock:y=>E({movement:y,type:"unlock"}),onViewHistory:q,userRole:a,capabilities:s}):e.jsx(Os,{loading:ce,data:J})}),b&&e.jsx(Ss,{onClose:()=>h(!1)})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] p-10 max-w-md w-full shadow-2xl space-y-8 animate-in zoom-in-95 duration-300 text-center",dir:A?"rtl":"ltr",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-50 text-rose-500 rounded-2xl flex items-center justify-center mx-auto shadow-inner",children:e.jsx(et,{size:32})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:A?"تایید حذف نهایی":"Confirm Registry Purge"}),e.jsx("p",{className:"text-xs text-slate-500 font-medium leading-relaxed",children:A?"شما در حال حذف دائمی رکورد هستید. این عملیات قابل بازگشت نیست.":"You are about to permanently delete record. This action is audited."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{disabled:W,onClick:()=>D(null),className:"flex-1 py-4 bg-slate-100 text-slate-600 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-slate-200 transition-all",children:A?"انصراف":"Cancel"}),e.jsx("button",{disabled:W,onClick:dt,className:"flex-[2] py-4 bg-rose-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-xl shadow-rose-500/20 hover:bg-rose-700 transition-all flex items-center justify-center gap-2",children:W?e.jsx(X,{size:16,className:"animate-spin"}):A?"تخریب رکورد":"Destroy Record"})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] p-10 max-w-lg w-full shadow-2xl space-y-8 animate-in zoom-in-95 duration-300",dir:A?"rtl":"ltr",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${C.type==="lock"?"bg-amber-50 text-amber-600":"bg-blue-50 text-blue-600"}`,children:C.type==="lock"?e.jsx(he,{size:24}):e.jsx(be,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 uppercase tracking-tighter",children:C.type==="lock"?A?"قفل پروتکل":"Protocol Lock":A?"درخواست آزادسازی":"Clearance Request"}),e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mt-1",children:A?"سیستم ثبت تغییرناپذیر":"Immutability Registry System"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:A?"دلیل تایید الزامی":"Required Verification Reason"}),e.jsx("textarea",{value:S,onChange:y=>R(y.target.value),placeholder:A?"مثال: تایید توسط ناظر، اصلاح مغایرت...":"e.g. Verified by site supervisor...",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl p-5 text-sm font-medium outline-none min-h-[120px] focus:bg-white transition-all"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{E(null),R("")},className:"flex-1 py-4 text-slate-400 text-[10px] font-black uppercase tracking-widest",children:A?"لغو":"Abort"}),e.jsx("button",{disabled:!S.trim(),onClick:xt,className:`flex-[2] py-4 rounded-xl text-[10px] font-black uppercase tracking-widest shadow-xl transition-all ${C.type==="lock"?"bg-slate-900 text-white shadow-slate-900/20 hover:bg-black":"bg-blue-600 text-white shadow-blue-500/20 hover:bg-blue-700"} disabled:opacity-30`,children:A?"ثبت تغییر وضعیت":"Submit Protocol Change"})]})]})}),G&&e.jsx(oa,{onClose:()=>F(null),onSubmit:async()=>{F(null),n()},flocks:c,t:r,api:l,onCreateFlock:async()=>{},editingMovement:G}),L&&e.jsx(Ds,{movement:L,flockId:L.flockId||i,onClose:()=>q(null),api:l})]})};export{Zs as default};
