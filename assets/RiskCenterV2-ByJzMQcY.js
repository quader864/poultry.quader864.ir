import{r,j as e,a as h,L as b,T as k,A as f}from"./index-BqfCj9Cx.js";import{C as g}from"./circle-check-nzM3eO1E.js";import{B as y}from"./brain-3f--sPLJ.js";import{I as C}from"./info-BRptETED.js";import{T as z}from"./trending-up-uU0_5pp5.js";import{C as R}from"./crosshair-BfuxKd61.js";const $=({flockId:l,cycleId:i,api:c,t:S,isRtl:A})=>{var m,p;const[d,u]=r.useState(null),[j,o]=r.useState(!1),[a,N]=r.useState(null),[n,v]=r.useState(null),[w,x]=r.useState(!1);return r.useEffect(()=>{(async()=>{if(!(!c.isValidObjectId(l)||!i)){o(!0);try{const t=await c.getCycleAnomaliesV2(l,i);u(t.data)}catch(t){console.error(t)}finally{o(!1)}}})()},[l,i,c]),r.useEffect(()=>{(async()=>{if(a){x(!0);try{const t=await c.getRootCauseV2(l,i,a.type);v(t.data)}catch(t){console.error(t)}finally{x(!1)}}})()},[a,l,i,c]),!c.isValidObjectId(l)||!i?e.jsxs("div",{className:"h-[40vh] flex flex-col items-center justify-center text-slate-400 opacity-40",children:[e.jsx(h,{size:64,strokeWidth:1}),e.jsx("p",{className:"mt-4 text-[10px] font-black uppercase tracking-[0.4em]",children:"Select a specific Node context for Risk Triage"})]}):j?e.jsxs("div",{className:"h-[60vh] flex flex-col items-center justify-center opacity-40",children:[e.jsx(b,{size:48,className:"animate-spin text-rose-600 mb-6"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em]",children:"Establishing Risk Consensus..."})]}):d?e.jsx("div",{className:"space-y-10 animate-in fade-in slide-in-from-bottom-6 duration-700",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-10",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx("h3",{className:"text-sm font-black text-slate-900 uppercase tracking-[0.2em] px-2",children:"Active Risk Stream"}),e.jsxs("div",{className:"space-y-4",children:[(m=d.detected)==null?void 0:m.map((s,t)=>e.jsxs("div",{onClick:()=>N(s),className:`p-6 rounded-[2rem] border transition-all cursor-pointer group ${a===s?"bg-slate-900 text-white border-slate-900 shadow-2xl":"bg-white border-slate-100 hover:border-rose-200 shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-widest ${s.severity==="medium"?"bg-amber-500/10 text-amber-500":"bg-rose-500 text-white"}`,children:s.severity}),e.jsxs("span",{className:"text-[9px] font-mono opacity-50",children:["DAY ",s.startDay]})]}),e.jsx("h4",{className:"text-sm font-black uppercase tracking-tight mb-2 truncate",children:s.type.replace("_"," ")}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:["Deviation: ",s.deviation,"%"]})]},t)),(!d.detected||d.detected.length===0)&&e.jsxs("div",{className:"py-20 text-center opacity-30 flex flex-col items-center gap-4",children:[e.jsx(g,{size:48,className:"text-emerald-500"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Horizon Clear"})]})]})]}),e.jsx("div",{className:"lg:col-span-3",children:a?e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3.5rem] shadow-sm flex flex-col overflow-hidden animate-in slide-in-from-right-8 duration-500",children:[e.jsxs("div",{className:"p-10 border-b border-slate-50 bg-slate-50/50 flex flex-col md:flex-row justify-between items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:`w-20 h-20 rounded-3xl flex items-center justify-center shadow-2xl text-white ${a.severity==="critical"?"bg-rose-600":"bg-amber-500"}`,children:e.jsx(k,{size:36})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:a.type.replace("_"," ")}),e.jsx("p",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.4em] mt-3",children:"Detection Logic: Statistical Outlier Analysis"})]})]}),e.jsxs("div",{className:"bg-white px-8 py-4 rounded-[2rem] border border-slate-200 shadow-sm flex items-center gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase mb-1",children:"Observed Value"}),e.jsx("p",{className:"text-xl font-black text-slate-900 tabular-nums",children:a.value})]}),e.jsx("div",{className:"w-px h-10 bg-slate-100"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase mb-1",children:"Threshold"}),e.jsx("p",{className:"text-xl font-black text-slate-900 tabular-nums",children:a.threshold})]})]})]}),e.jsxs("div",{className:"p-10 lg:p-14 grid grid-cols-1 lg:grid-cols-3 gap-14",children:[e.jsx("div",{className:"lg:col-span-2 space-y-12",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center gap-4 text-slate-900 font-black uppercase text-xs tracking-[0.3em] border-b border-slate-100 pb-6",children:[e.jsx(y,{size:20,className:"text-blue-600"})," Root Cause Hypothesis"]}),w?e.jsx("div",{className:"py-20 flex flex-col items-center opacity-30 gap-4",children:e.jsx(b,{className:"animate-spin"})}):n?e.jsxs("div",{className:"space-y-10 animate-in fade-in duration-500",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Object.entries(n.likelihood||{}).map(([s,t])=>e.jsxs("div",{className:"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-100 group hover:bg-white hover:border-blue-300 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-800 uppercase tracking-widest",children:s.replace("_"," ")}),e.jsxs("span",{className:"text-sm font-black text-blue-600",children:[(t*100).toFixed(0),"%"]})]}),e.jsx("div",{className:"h-1.5 w-full bg-slate-200 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all duration-1000",style:{width:`${t*100}%`}})})]},s))}),e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx(f,{size:100})}),e.jsxs("h4",{className:"text-xs font-black uppercase tracking-[0.2em] mb-10 flex items-center gap-3 relative z-10",children:[e.jsx(C,{size:16,className:"text-blue-400"})," Operational Correlations"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:Object.entries(n.correlations||{}).map(([s,t])=>e.jsxs("div",{className:`p-4 rounded-2xl border flex items-center justify-between ${t?"bg-rose-500/10 border-rose-500/20":"bg-white/5 border-white/5 opacity-40"}`,children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:s.replace("_"," ")}),t?e.jsx(z,{size:14,className:"text-rose-400"}):e.jsx(g,{size:14,className:"text-slate-500"})]},s))})]})]}):e.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase italic py-20 text-center",children:"Select an anomaly to activate inference engine..."})]})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-rose-600 text-white rounded-[2.5rem] p-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 rotate-12",children:e.jsx(h,{size:80})}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.3em] mb-8 relative z-10",children:"Remediation Protocol"}),e.jsx("div",{className:"space-y-6 relative z-10",children:(p=n==null?void 0:n.recommendations)==null?void 0:p.map((s,t)=>e.jsxs("div",{className:"flex gap-4 items-start bg-white/10 p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-rose-300 rounded-full mt-2 shrink-0"}),e.jsx("p",{className:"text-xs font-bold leading-relaxed",children:s})]},t))})]}),e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-[2.5rem] p-8",children:[e.jsx("h4",{className:"text-[10px] font-black text-slate-900 uppercase tracking-widest mb-6",children:"Staff Deployment"}),e.jsxs("button",{className:"w-full py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl hover:bg-black transition-all flex items-center justify-center gap-3",children:[e.jsx(R,{size:14})," Dispatch Triage Team"]})]})]})]})]}):e.jsxs("div",{className:"bg-white border border-slate-200 border-dashed rounded-[3.5rem] flex flex-col items-center justify-center text-center p-20 opacity-40",children:[e.jsx(f,{size:80,strokeWidth:1,className:"text-slate-300 mb-8"}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 uppercase tracking-widest mb-2",children:"Registry Investigation Mode"}),e.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-[0.2em]",children:"Select a detected risk vector from the stream to begin deep diagnosis"})]})})]})}):null};export{$ as default};
