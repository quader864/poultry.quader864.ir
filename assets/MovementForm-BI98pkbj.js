import{c as O,j as e,a as ce,Z as T,d as oe,g as B,i as $,r as p,X as de,L as H,k as xe}from"./index-Boji9h6s.js";import{D as V,T as q}from"./thermometer-Buf6xXJE.js";import{I as K}from"./info-C2nnCsUG.js";import{C as U}from"./circle-check-FUip_Tmw.js";import{S as pe}from"./scale-B5L0ggb0.js";import{P as me}from"./package-XmwZcQ4r.js";import{L as he}from"./layout-grid-Be9vMcls.js";import{F as ge}from"./file-text-BvGyBVBS.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],be=O("fingerprint-pattern",ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],L=O("wind",fe),je=({data:r,onChange:f,t:h,isRtl:j})=>{const n=(s,g)=>f({...r,[s]:g});return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 text-blue-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform",children:e.jsx(V,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Water Chemistry Matrix"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Direct Clinical Node Input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-8 bg-slate-50/50 p-8 rounded-[2.5rem] border border-slate-100",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center ml-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"pH Balance (6.5 - 8.5)"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black ${r.pH>8.5||r.pH<6.5?"bg-rose-100 text-rose-600":"bg-emerald-100 text-emerald-600"}`,children:r.pH||7})]}),e.jsx("input",{type:"range",min:"0",max:"14",step:"0.1",className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:r.pH||7,onChange:s=>n("pH",parseFloat(s.target.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Hardness (mg/L)"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-5 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:r.hardness||"",onChange:s=>n("hardness",parseFloat(s.target.value)),placeholder:"0.0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Free Chlorine"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full bg-white border border-slate-200 rounded-2xl px-5 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:r.freeChlorine||"",onChange:s=>n("freeChlorine",parseFloat(s.target.value)),placeholder:"0.00"})]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Water Supply Source"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["municipal","well","rainwater","trucked"].map(s=>e.jsx("button",{type:"button",onClick:()=>n("source",s),className:`px-4 py-3.5 rounded-xl text-[9px] font-black uppercase tracking-widest transition-all ${r.source===s?"bg-blue-600 text-white shadow-lg":"bg-slate-50 text-slate-400 hover:bg-slate-100"}`,children:s},s))})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(ce,{size:60})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] mb-4 flex items-center gap-2 relative z-10",children:[e.jsx(T,{size:14,className:"text-blue-400"})," Integrity Check"]}),e.jsx("div",{className:"space-y-3 relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-white/20 bg-transparent text-blue-500 focus:ring-0",onChange:s=>n("coliformDetected",s.target.checked)}),e.jsx("span",{className:"text-[10px] font-bold uppercase text-slate-400",children:"Biological Contaminants Detected?"})]})})]})]})]})]})},ve=({data:r,onChange:f,t:h,isRtl:j})=>{const n=(s,g)=>f({...r,[s]:g});return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-50 text-emerald-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform",children:e.jsx(L,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Atmospheric Node Registry"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Environmental Sensor Verification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx(q,{size:24,className:"text-rose-500 mb-6 group-hover:rotate-12 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Temp (Â°C)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:r.temperature||"",onChange:s=>n("temperature",parseFloat(s.target.value)),placeholder:"24.5"})]}),e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx(T,{size:24,className:"text-blue-500 mb-6 group-hover:scale-110 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Humidity (%)"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:r.humidity||"",onChange:s=>n("humidity",parseFloat(s.target.value)),placeholder:"65"})]}),e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx(L,{size:24,className:"text-indigo-500 mb-6 group-hover:-translate-y-1 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Vent Rate"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:r.ventilation||"",onChange:s=>n("ventilation",parseFloat(s.target.value)),placeholder:"12.0"})]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5",children:e.jsx(oe,{size:100})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.3em] mb-10 flex items-center gap-3 relative z-10",children:[e.jsx(K,{size:16,className:"text-blue-400"})," Advanced Gas Telemetry"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 relative z-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ammonia (PPM)"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black ${(r.ammoniaPpm||0)>25?"bg-rose-500 text-white":"bg-emerald-500/10 text-emerald-400"}`,children:r.ammoniaPpm||0})]}),e.jsx("input",{type:"range",min:"0",max:"100",className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500",value:r.ammoniaPpm||0,onChange:s=>n("ammoniaPpm",parseInt(s.target.value))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"CO2 (PPM)"}),e.jsx("span",{className:"bg-white/5 px-2 py-0.5 rounded text-[10px] font-black text-slate-300",children:r.co2Ppm||0})]}),e.jsx("input",{type:"range",min:"0",max:"5000",step:"100",className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-indigo-500",value:r.co2Ppm||0,onChange:s=>n("co2Ppm",parseInt(s.target.value))})]})]})]})]})},ye=({data:r,onChange:f,t:h,isRtl:j})=>{var s,g,k,C,S,d;const n=(m,u)=>{const b={...r};b.eggMetrics||(b.eggMetrics={}),b.eggMetrics[m]=u,["gradeA","gradeB","broken"].includes(m)&&(b.eggMetrics.count=(parseInt(b.eggMetrics.gradeA)||0)+(parseInt(b.eggMetrics.gradeB)||0)+(parseInt(b.eggMetrics.broken)||0)),f(b)};return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:rotate-6 transition-transform",children:e.jsx(B,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Yield Precision Registry"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Detailed Egg Grading & Mass"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"bg-white border-2 border-blue-100 p-10 rounded-[3rem] shadow-xl shadow-blue-500/5",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-widest mb-4",children:"Aggregated Yield"}),e.jsx("h4",{className:"text-6xl font-black text-slate-900 tabular-nums",children:((s=r.eggMetrics)==null?void 0:s.count)||0}),e.jsxs("p",{className:"text-[11px] font-bold text-slate-400 mt-4 uppercase flex items-center gap-2",children:[e.jsx(U,{size:14,className:"text-emerald-500"})," Automated Sum Consensus"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-blue-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-emerald-500 font-black",children:"A"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Grade A (Premium)"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((g=r.eggMetrics)==null?void 0:g.gradeA)||"",onChange:m=>n("gradeA",parseInt(m.target.value)),placeholder:"0"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-amber-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-amber-500 font-black",children:"B"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Grade B (Commercial)"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((k=r.eggMetrics)==null?void 0:k.gradeB)||"",onChange:m=>n("gradeB",parseInt(m.target.value)),placeholder:"0"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-rose-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-rose-500 font-black",children:"X"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Broken / Damage"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((C=r.eggMetrics)==null?void 0:C.broken)||"",onChange:m=>n("broken",parseInt(m.target.value)),placeholder:"0"})]})]})]})]}),e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx(pe,{size:100})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.3em] mb-10 flex items-center gap-3 relative z-10",children:[e.jsx(T,{size:16,className:"text-blue-400"})," Mass Metrology"]}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Total Weight (KG)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 text-xl font-black outline-none focus:bg-white/10 transition-all",value:((S=r.eggMetrics)==null?void 0:S.totalWeightKg)||"",onChange:m=>n("totalWeightKg",parseFloat(m.target.value)),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Avg Egg Mass (G)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 text-xl font-black outline-none focus:bg-white/10 transition-all",value:((d=r.eggMetrics)==null?void 0:d.avgWeightPerEgg)||"",onChange:m=>n("avgWeightPerEgg",parseFloat(m.target.value)),placeholder:"0.0"})]})]})]}),e.jsxs("div",{className:"p-8 bg-blue-50 border border-blue-100 rounded-[2.5rem] flex items-start gap-5",children:[e.jsx(K,{size:24,className:"text-blue-600 shrink-0 mt-1"}),e.jsx("p",{className:"text-[11px] font-bold text-blue-700 leading-loose uppercase",children:"Yield consistency check: Input grade distribution should match the total daily collection log for precision FCR calculations."})]})]})]})]})},Ne=[{id:"morning_eggs",label:"Morning Egg Collection",icon:e.jsx(B,{}),color:"text-amber-500 bg-amber-50",values:{type:"egg_collection",eggMetrics:{count:4800,gradeA:4600,gradeB:150,broken:50},reason:"daily_collection"}},{id:"standard_feed",label:"Standard Feed Delivery",icon:e.jsx(me,{}),color:"text-blue-500 bg-blue-50",values:{type:"feed",feedMetrics:{purchasedKg:1e3,feedType:"Starter",supplier:"Standard Supplier"},reason:"purchase"}},{id:"water_audit",label:"Weekly Water Audit",icon:e.jsx(V,{}),color:"text-indigo-500 bg-indigo-50",values:{type:"water_reading",pH:7.2,hardness:120,freeChlorine:.5,source:"well"}},{id:"env_check",label:"Mid-Day Env Check",icon:e.jsx(q,{}),color:"text-rose-500 bg-rose-50",values:{type:"environmental_reading",temperature:24.5,humidity:65,ventilation:12}}],we=({onApply:r,isRtl:f})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 px-2",children:[e.jsx($,{size:18,className:"text-blue-500"}),e.jsx("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Rapid Ingestion Presets"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Ne.map(h=>e.jsxs("button",{onClick:()=>r(h.values),className:"p-5 bg-white border border-slate-200 rounded-2xl flex items-center gap-4 hover:border-blue-300 hover:shadow-lg transition-all group text-left",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform ${h.color}`,children:h.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-black text-slate-800 uppercase truncate tracking-tight",children:h.label}),e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase mt-1",children:["Preset Vector: ",h.values.type.replace("_"," ")]})]})]},h.id))})]}),Pe=({onClose:r,onSubmit:f,flocks:h=[],t:j,api:n,editingMovement:s})=>{var G;const g=j.langToggle==="EN",k=()=>{const t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)},[C,S]=p.useState([]),[d,m]=p.useState((s==null?void 0:s.type)||""),[u,b]=p.useState((s==null?void 0:s.flockId)||((G=h[0])==null?void 0:G._id)||""),[F,Y]=p.useState((s==null?void 0:s.cycleId)||""),[M,Q]=p.useState(null),[v,y]=p.useState({}),[ke,X]=p.useState([]),[Z,J]=p.useState({}),[Ce,A]=p.useState(!1),[ee,P]=p.useState(!1),[E,D]=p.useState(!1),[z,I]=p.useState(""),[_,W]=p.useState(!1);p.useEffect(()=>{(async()=>{try{const c=(await n.getMovementInputSchema()).data||{},i=Object.entries(c).map(([o,x])=>({id:o,label:x.label||o,description:x.description}));S(i),!d&&i.length>0&&m(i[0].id)}catch(a){console.error("Failed to load vector types",a)}})()},[n,d]),p.useEffect(()=>{(async()=>{if(u){A(!0);try{const c=((await n.getCycles(u)).cycles||[]).sort((i,o)=>o.cycleId.localeCompare(i.cycleId));if(X(c),c.length>0&&!F){const i=c.find(o=>o.status==="active");Y(i?i.cycleId:c[0].cycleId)}}catch(a){console.error(a)}finally{A(!1)}}})()},[u,n,F]),p.useEffect(()=>{(async()=>{var a;if(d){P(!0),I("");try{const i=(await n.getMovementInputSchema(d)).data;Q(i),y(s||{date:k(),confidence:"high"});const x=[...i.requiredFields||[],...i.optionalFields||[]].filter(l=>l.apiEndpoint);for(const l of x)if(l.apiEndpoint&&u){const re=l.apiEndpoint.replace(":flockId",u);try{const w=await n.request(re,{},!0),ne=((a=w.data)==null?void 0:a.batches)||w.batches||w.data||[];J(ie=>({...ie,[l.name]:ne}))}catch(w){console.error(`Dynamic fetch failed for ${l.name}`,w)}}}catch{I("Schema sync failed")}finally{P(!1)}}})()},[d,n,s,u]);const te=(t,a)=>t.split(".").reduce((c,i)=>c&&c[i],a),N=p.useCallback((t,a)=>{y(c=>{const i={...c},o=t.split(".");let x=i;for(let l=0;l<o.length-1;l++)x[o[l]]={...x[o[l]]||{}},x=x[o[l]];return x[o[o.length-1]]=a,i})},[]),se=t=>{y({...v,...t}),m(t.type||d),W(!1)},ae=async t=>{var c;D(!0),I("");let a={...v,type:d};if(d==="mortality"&&((c=a.birdMetrics)!=null&&c.count)&&(a.mortalityMetrics={count:parseInt(a.birdMetrics.count)||0}),d==="weight"||d==="weight_measurement"){a.weightMetrics||(a.weightMetrics={});const i=parseFloat(a.weightMetrics.averageWeightGrams),o=parseFloat(a.weightMetrics.startWeightGrams)||0,x=parseFloat(a.weightMetrics.endWeightGrams)||0,l=parseFloat(a.weightMetrics.grams)||0;(!i||isNaN(i))&&(o>0&&x>0?a.weightMetrics.averageWeightGrams=(o+x)/2:o>0?a.weightMetrics.averageWeightGrams=o:x>0?a.weightMetrics.averageWeightGrams=x:l>0&&(a.weightMetrics.averageWeightGrams=l))}try{s?await n.updateMovement(u,F,s._id,a):await n.createMovement(u,F,a),r(),f(a)}catch(i){I(i.message||"Registry communication failure")}finally{D(!1)}},R=t=>{var i,o,x;const a=te(t.name,v)||"",c="w-full bg-white border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm";return e.jsxs("div",{className:"space-y-2 group",children:[e.jsxs("div",{className:"flex justify-between items-center ml-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:t.label}),t.example&&e.jsxs("span",{className:"text-[8px] font-bold text-slate-300 uppercase tracking-tight",children:["Example: ",t.example]})]}),t.type==="select"?e.jsxs("select",{className:c,value:a,onChange:l=>N(t.name,l.target.value),children:[e.jsx("option",{value:"",children:"Select Option..."}),t.apiEndpoint?(Z[t.name]||[]).map(l=>e.jsx("option",{value:l[t.valueField||"_id"],children:l[t.labelField||"displayLabel"]||l.displayLabel},l[t.valueField||"_id"])):(i=t.options)==null?void 0:i.map(l=>e.jsx("option",{value:l,children:l.replace(/_/g," ").toUpperCase()},l))]}):t.type==="textarea"?e.jsx("textarea",{className:`${c} min-h-[100px] font-medium leading-relaxed`,placeholder:t.placeholder,value:a,onChange:l=>N(t.name,l.target.value)}):t.type==="datetime"?e.jsx("input",{type:"datetime-local",className:c,value:a,onChange:l=>N(t.name,l.target.value)}):t.type==="date"?e.jsx("input",{type:"date",className:c,value:a,onChange:l=>N(t.name,l.target.value)}):e.jsx("input",{type:t.type==="number"?"number":"text",className:c,placeholder:t.placeholder,min:(o=t.validation)==null?void 0:o.min,max:(x=t.validation)==null?void 0:x.max,value:a,onChange:l=>N(t.name,t.type==="number"?parseFloat(l.target.value):l.target.value)}),t.hint&&e.jsx("p",{className:"text-[9px] font-medium text-slate-400 italic ml-1",children:t.hint})]},t.name)},le=["water_reading","environmental_reading"].includes(d);return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-4 overflow-y-auto",dir:g?"rtl":"ltr",children:e.jsxs("div",{className:"bg-white rounded-[4rem] shadow-2xl w-full max-w-6xl my-auto animate-in zoom-in-95 duration-500 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 flex items-center justify-between bg-slate-50/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx(be,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:"Intelligence Registry"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mt-3",children:["VECTOR PROTOCOL: ",d.replace(/_/g," ").toUpperCase()]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>W(!_),className:`px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${_?"bg-blue-600 text-white shadow-lg":"bg-white border border-slate-200 text-slate-600"}`,children:[e.jsx($,{size:16})," Templates"]}),e.jsx("button",{onClick:r,className:"p-4 bg-white hover:bg-rose-50 text-slate-400 hover:text-rose-500 rounded-2xl transition-all shadow-sm",children:e.jsx(de,{size:24})})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row h-[75vh] overflow-hidden",children:[e.jsxs("div",{className:"w-full lg:w-80 bg-slate-50 border-r border-slate-100 p-10 space-y-10 overflow-y-auto no-scrollbar shrink-0",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block ml-1",children:"Fleet Node"}),e.jsx("select",{className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none shadow-sm",value:u,onChange:t=>b(t.target.value),children:h.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block ml-1",children:"Vector Type"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:C.map(t=>e.jsx("button",{type:"button",onClick:()=>m(t.id),className:`text-left px-5 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${d===t.id?"bg-blue-600 text-white shadow-xl":"bg-white text-slate-400 border border-slate-200 hover:bg-slate-100"}`,children:t.label},t.id))})]})]}),e.jsx("div",{className:"flex-1 p-14 overflow-y-auto no-scrollbar bg-white relative",children:ee?e.jsx("div",{className:"h-full flex flex-col items-center justify-center opacity-40",children:e.jsx(H,{size:48,className:"animate-spin text-blue-600"})}):_?e.jsx("div",{className:"animate-in fade-in duration-300",children:e.jsx(we,{onApply:se,isRtl:g})}):e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500 pb-20",children:[z&&e.jsxs("div",{className:"bg-rose-50 text-rose-600 p-6 rounded-2xl border border-rose-100 flex items-center gap-4",children:[e.jsx(xe,{size:24}),e.jsx("p",{className:"text-xs font-black uppercase tracking-tight",children:Array.isArray(z)?z.join(", "):z})]}),d==="water_reading"&&e.jsx(je,{data:v,onChange:y,t:j,isRtl:g}),d==="environmental_reading"&&e.jsx(ve,{data:v,onChange:y,t:j,isRtl:g}),d==="egg_collection"&&e.jsx(ye,{data:v,onChange:y,t:j,isRtl:g}),!le&&M&&e.jsxs("div",{className:"space-y-12",children:[e.jsxs("div",{className:"bg-slate-50 p-10 rounded-[3rem] border border-slate-100 shadow-inner",children:[e.jsxs("h4",{className:"text-xs font-black text-slate-800 uppercase tracking-widest mb-10 flex items-center gap-3",children:[e.jsx(he,{className:"text-blue-600",size:18})," Primary Protocol (Required)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:M.requiredFields.map(t=>R(t))})]}),M.optionalFields.length>0&&e.jsxs("div",{className:"bg-white p-10 rounded-[3rem] border-2 border-dashed border-slate-100",children:[e.jsxs("h4",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mb-10 flex items-center gap-3",children:[e.jsx(ge,{className:"text-slate-300",size:18})," Contextual Metadata (Optional)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:M.optionalFields.map(t=>R(t))})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-10 pt-10 border-t border-slate-100",children:[e.jsx("div",{className:"flex-1 flex bg-slate-100 p-1.5 rounded-2xl shadow-inner min-w-[300px]",children:["high","medium","low"].map(t=>e.jsxs("button",{type:"button",onClick:()=>N("confidence",t),className:`flex-1 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${v.confidence===t?"bg-white text-blue-600 shadow-xl":"text-slate-400 hover:text-slate-600"}`,children:[t," Confidence"]},t))}),e.jsxs("div",{className:"flex gap-6 flex-[2] min-w-full sm:min-w-[400px]",children:[e.jsx("button",{type:"button",onClick:r,className:"flex-1 py-6 border-2 border-slate-100 rounded-2xl text-[12px] font-black uppercase tracking-[0.2em] text-slate-400 hover:bg-slate-50 transition-all",children:"Discard"}),e.jsx("button",{onClick:()=>ae(),disabled:E,className:"flex-[2] py-6 bg-slate-900 text-white rounded-2xl text-[12px] font-black uppercase tracking-[0.2em] shadow-2xl hover:bg-black transition-all flex items-center justify-center gap-4",children:E?e.jsx(H,{size:24,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(U,{size:24})," Commit to Registry"]})})]})]})]})})]})]})})};export{Pe as default};
