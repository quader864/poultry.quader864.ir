const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LogicArchitect-bg_vJws7.js","assets/index-BlS2-adh.js","assets/types-ajuHBdeq.js","assets/toggle-right-CIPAaOTA.js","assets/gauge-_rPxAkIP.js","assets/clock-C5NRjOsN.js","assets/circle-check-l3JID_ZS.js","assets/layout-grid-DxuinLnq.js","assets/play-CP_Hc1CR.js","assets/info-CHc_1WZ7.js","assets/book-open-BvLZ6rqQ.js","assets/code-BFk5Oc_t.js","assets/arrow-left-CcbpxBd6.js","assets/flask-conical-CeotN9ZT.js","assets/arrow-right-Bf8JONUp.js","assets/search-BwBcOq6b.js","assets/trash-2-CXq7EdYc.js","assets/download-j4Tk1Y9X.js"])))=>i.map(i=>d[i]);
import{c as _,r as o,j as e,t as V,D as j,C as G,L as W,R as C,d as B,A as F,T as U,Z,_ as q}from"./index-BlS2-adh.js";import{S as H}from"./search-BwBcOq6b.js";import{T as Y}from"./trash-2-CXq7EdYc.js";import{D as J}from"./download-j4Tk1Y9X.js";import{C as K}from"./circle-check-l3JID_ZS.js";import{C as Q}from"./clock-C5NRjOsN.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],ee=_("bell-ring",X);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],se=_("scan-line",te),me=a=>{const t=(a||"").toLowerCase();return t.includes("consumption")||t.includes("resource")||t.includes("production")||t.includes("efficiency")||t.includes("basic")?"consumption":t.includes("water")||t.includes("env")?"water":t.includes("mortality")||t.includes("growth")||t.includes("health")?"mortality":t.includes("weight")||t.includes("mass")?"weight":"custom"},M=(a,t=0,d)=>{if(!a||typeof a!="object"||t>6)return[];let l=[];return Array.isArray(a)?a.map(r=>({...r,domain:r.domain||d})):(Array.isArray(a.templates)&&(l=[...l,...a.templates.map(r=>({...r,domain:r.domain||a.category||d}))]),Array.isArray(a.blueprints)&&(l=[...l,...a.blueprints.map(r=>({...r,domain:r.domain||a.category||d}))]),Object.entries(a).forEach(([r,i])=>{if(i&&typeof i=="object"&&!Array.isArray(i)&&!["templates","blueprints"].includes(r)){const x=i.category||(typeof r=="string"&&!["calculations","data"].includes(r)?r:d);l=[...l,...M(i,t+1,x)]}else Array.isArray(i)&&["calculations","data"].includes(r)&&(l=[...l,...i.map(x=>({...x,domain:x.domain||d}))])}),l)},ae=a=>{const t={};return Object.entries(a).forEach(([d,l])=>{const r=Array.isArray(l.inputs)?l.inputs:[];t[l.category||d]=r.map(i=>({key:i.key,label:i.label||i.name||i.key,type:i.dataType||"number",unit:i.unit}))}),t},E=a=>{if(!a)return[];const t=/\|\||&&|==|!=|>=|<=|[\+\-\*\/\(\)\:\%><]|\d+\.\d+|\d+|\w+/g;return a.match(t)||[]},pe=(a,t)=>{const d=E(a);return Array.from(new Set(d.filter(l=>t.has(l))))},le=o.lazy(()=>q(()=>import("./LogicArchitect-bg_vJws7.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),re=({api:a,t,selectedFlockId:d="all",flocks:l=[],capabilities:r=[],setActiveModule:i})=>{const[x,N]=o.useState("rules"),[y,v]=o.useState(!1),[R,k]=o.useState(!1),[ie,A]=o.useState(null),[h,L]=o.useState([]),[f,T]=o.useState([]),[w,D]=o.useState({}),[I,O]=o.useState([]),z=t.langToggle==="EN",P=o.useMemo(()=>{const s=new Set;return Object.values(w).forEach(u=>{Array.isArray(u)&&u.forEach(n=>{n!=null&&n.key&&s.add(n.key)})}),s},[w]),b=async()=>{v(!0);try{const s=a.isValidObjectId(d)?d:void 0,[u,n]=await Promise.all([a.getRules({flockId:s}),a.getRuleAlerts(s,{status:"new"})]),p=u.rules||u.data||[];L(Array.isArray(p)?p:[]);const m=(n==null?void 0:n.alerts)||(n==null?void 0:n.data)||[];T(Array.isArray(m)?m:[])}catch(s){console.error("Policy engine sync failed:",s)}finally{v(!1)}},S=o.useCallback(async()=>{k(!0),A(null);try{const[s,u]=await Promise.all([a.getMetadataInputsWithTypes().catch(()=>({inputs:{}})),a.getMetadataCalculations().catch(()=>({data:[]}))]),n=ae(s.inputs||{});D(n);const p=M(u),m=new Set,g=p.map((c,$)=>({id:c.id||c._id||`bp-${$}`,label:c.name||c.label||c.title||"Standard Node",domain:c.domain||c.category||"General",description:c.description||"Verified operational logic template.",formula:c.formula||c.logic||c.calculation&&c.calculation.formula||""})).filter(c=>!c.formula||m.has(c.id)?!1:(m.add(c.id),!0));O(g.length>0?g:[{id:"fcr_basic",label:"Feed Conversion Ratio",domain:"Resources",description:"Standard calculation of feed efficiency per unit of mass gain.",formula:"totalFeedUsed / totalWeightGain"},{id:"mort_drift",label:"Mortality Drift Analysis",domain:"Growth",description:"Detects abnormal spikes in daily loss rates relative to population.",formula:"(dailyMortality / totalPopulation) * 100"}])}catch{A("Registry node synchronization failure.")}finally{k(!1)}},[a]);return o.useEffect(()=>{b()},[a,d]),o.useEffect(()=>{x==="builder"&&S()},[x,S]),e.jsxs("div",{className:"flex flex-col gap-6 animate-in fade-in duration-700 pb-32",dir:z?"rtl":"ltr",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[2.5rem] p-6 lg:p-10 text-white flex flex-col xl:flex-row items-center justify-between gap-8 relative overflow-hidden shadow-2xl border border-white/5 shrink-0",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-blue-600/10 rounded-full translate-x-48 -translate-y-48 blur-3xl"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10 w-full xl:w-auto",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl flex items-center justify-center shadow-2xl shrink-0",children:e.jsx(V,{size:32})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-black tracking-tighter uppercase truncate",children:t.logicEngine}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-1",children:"Multi-Vector Managed Registry"})]})]}),e.jsx("div",{className:"flex bg-slate-800/40 backdrop-blur-xl p-1.5 rounded-3xl border border-white/10 relative z-10 w-full xl:w-auto overflow-x-auto no-scrollbar shadow-inner",children:[{id:"rules",label:t.registry,icon:e.jsx(j,{size:16})},{id:"builder",label:t.builder,icon:e.jsx(G,{size:16})},{id:"alerts",label:t.alerts,icon:e.jsx(ee,{size:16}),badge:(f==null?void 0:f.length)||0}].map(s=>e.jsxs("button",{onClick:()=>{N(s.id)},className:`flex items-center justify-center gap-3 px-6 lg:px-8 py-3 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all relative z-10 flex-1 whitespace-nowrap ${x===s.id?"bg-blue-600 text-white shadow-xl shadow-blue-600/30":"text-slate-400 hover:text-white"}`,children:[s.icon," ",e.jsx("span",{children:s.label}),s.badge?e.jsx("span",{className:"absolute top-1 right-2 w-5 h-5 bg-rose-500 text-white rounded-full flex items-center justify-center text-[8px] font-bold border-2 border-slate-900 shadow-lg",children:s.badge}):null]},s.id))})]}),e.jsxs("div",{className:"w-full",children:[x==="builder"&&e.jsx(o.Suspense,{fallback:e.jsx("div",{className:"py-20 flex items-center justify-center",children:e.jsx(W,{className:"animate-spin"})}),children:e.jsx(le,{api:a,t,flocks:l||[],inputsWithTypes:w,allValidVariables:P,blueprints:I,onComplete:()=>{N("rules"),b()},setActiveModule:i,isRtl:z})}),x==="rules"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6 pb-20",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between px-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black text-slate-900 uppercase tracking-widest",children:t.activePolicies}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:y?"SYNCHRONIZING...":`${(h==null?void 0:h.length)||0} ENFORCED LOGIC NODES`})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white border border-slate-200 rounded-2xl px-4 py-2.5 flex-1 sm:w-64 shadow-sm group focus-within:border-blue-500 transition-all",children:[e.jsx(H,{size:16,className:"text-slate-300 group-focus-within:text-blue-500"}),e.jsx("input",{placeholder:t.searchPolicies,className:"bg-transparent border-none text-xs font-bold uppercase outline-none text-slate-600 placeholder:text-slate-300 w-full"})]}),e.jsx("button",{onClick:b,className:"p-3 bg-white border border-slate-200 rounded-2xl text-slate-400 hover:text-blue-600 shadow-sm",children:e.jsx(C,{size:18,className:y?"animate-spin":""})})]})]}),!Array.isArray(h)||h.length===0?e.jsxs("div",{className:"py-40 text-center opacity-30 flex flex-col items-center gap-6",children:[e.jsx(j,{size:80,strokeWidth:1}),e.jsx("p",{className:"text-xl font-black uppercase tracking-[0.4em]",children:t.horizonClear})]}):h.map(s=>{var u,n,p;return e.jsxs("div",{className:"bg-white border border-slate-200 p-8 rounded-[3rem] shadow-sm hover:shadow-2xl transition-all group relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg ${s.status==="active"?"bg-blue-600 text-white":"bg-slate-100 text-slate-400"}`,children:e.jsx(B,{size:28})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-slate-900 text-lg uppercase tracking-tight truncate",children:s.name}),e.jsxs("div",{className:"flex wrap gap-2 mt-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-widest border border-current ${((u=s.anomalyDetection)==null?void 0:u.severity)==="critical"?"bg-rose-50 text-rose-500":"bg-blue-50 text-blue-500"}`,children:(n=s.anomalyDetection)==null?void 0:n.severity}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-500 rounded text-[8px] font-black uppercase tracking-widest",children:s.type})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"p-2.5 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded-xl transition-all shadow-sm",onClick:()=>a.deleteRule(s._id).then(b),children:e.jsx(Y,{size:20})})})]}),e.jsx("div",{className:"bg-slate-950 rounded-2xl p-6 border border-slate-800 font-mono text-[10px] font-bold text-blue-400 overflow-x-auto flex wrap gap-2 shadow-inner relative",children:E(((p=s.calculation)==null?void 0:p.formula)||"").map((m,g)=>e.jsx("span",{className:`px-2.5 py-1 rounded-lg ${["(",")","||","&&","+","-","*","/","%","==",">","<"].includes(m)?"bg-white/5 text-indigo-300":"bg-blue-600 text-white"}`,children:m},g))})]},s._id)})]}),e.jsx("div",{className:"hidden lg:block space-y-6",children:e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3rem] p-10 shadow-sm sticky top-6",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-900 uppercase tracking-widest mb-10 flex items-center gap-3",children:[e.jsx(F,{size:18,className:"text-blue-600"})," ",t.fleetGovernance]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"p-8 bg-blue-50 rounded-[2.5rem] border border-blue-100",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-600 uppercase mb-3 tracking-widest",children:t.healthScore}),e.jsx("p",{className:"text-5xl font-black text-blue-900 tracking-tighter tabular-nums",children:"98.4%"})]}),e.jsxs("button",{className:"w-full py-5 bg-slate-900 text-white rounded-3xl text-[10px] font-black uppercase tracking-widest shadow-xl hover:bg-black transition-all flex items-center justify-center gap-3",children:[e.jsx(J,{size:16})," ",t.auditExport]})]})]})})]}),x==="alerts"&&e.jsxs("div",{className:"max-w-5xl mx-auto space-y-8 py-6 px-4 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("h2",{className:"text-2xl font-black text-slate-900 uppercase tracking-tighter flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(se,{size:24})}),t.detectionStream]}),e.jsx("button",{onClick:b,className:"p-3 bg-white border border-slate-200 rounded-2xl text-slate-400 hover:text-blue-600 transition-all shadow-sm",children:e.jsx(C,{size:18,className:y?"animate-spin":""})})]}),!Array.isArray(f)||f.length===0?e.jsxs("div",{className:"py-48 text-center flex flex-col items-center gap-12 opacity-20 grayscale",children:[e.jsx(K,{size:160,strokeWidth:1,className:"text-emerald-500"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-4xl font-black uppercase tracking-[0.4em]",children:t.horizonClear}),e.jsx("p",{className:"text-sm font-bold uppercase tracking-[0.2em]",children:t.noAuditLogs})]})]}):f.map(s=>e.jsxs("div",{className:"bg-white border border-slate-200 p-10 rounded-[4rem] shadow-sm hover:shadow-2xl transition-all flex flex-col sm:flex-row items-start gap-12 group relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-3 h-full ${s.severity==="critical"?"bg-rose-500":"bg-amber-500"}`}),e.jsx("div",{className:`w-24 h-24 rounded-[2.5rem] flex items-center justify-center shrink-0 shadow-2xl ${s.severity==="critical"?"bg-rose-50 text-rose-600 border border-rose-100":"bg-amber-50 text-amber-500 border border-amber-100"}`,children:e.jsx(U,{size:48})}),e.jsxs("div",{className:"flex-1 min-w-0 py-2",children:[e.jsx("h4",{className:"font-black text-slate-900 text-3xl uppercase tracking-tighter truncate mb-4",children:s.ruleName}),e.jsx("div",{className:"flex wrap gap-4 mb-10",children:e.jsxs("div",{className:"px-6 py-3 bg-slate-50 border border-slate-100 rounded-2xl",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase mb-1",children:"Calculated Signal"}),e.jsx("p",{className:"text-2xl font-black text-slate-900 tabular-nums",children:(s.calculatedValue??0).toFixed(4)})]})}),e.jsxs("div",{className:"flex items-center gap-10 text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] border-t border-slate-50 pt-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{size:18,className:"text-slate-300"})," ",new Date(s.createdAt).toLocaleString()]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{size:18,className:"text-slate-300"})," Node ID: ",(s.flockId||"â€”").slice(-8).toUpperCase()]})]})]}),e.jsx("button",{onClick:async()=>{await a.acknowledgeAlert(s._id,"Manually acknowledged"),b()},className:"w-full sm:w-64 py-6 bg-slate-900 text-white rounded-[2.5rem] text-[12px] font-black uppercase tracking-[0.2em] shadow-2xl hover:bg-black hover:-translate-y-1 transition-all self-center",children:t.acknowledge})]},s._id))]})]}),R&&x==="builder"&&e.jsx("div",{className:"fixed bottom-12 right-12 z-[100] animate-in slide-in-from-bottom-20 duration-1000",children:e.jsxs("div",{className:"bg-slate-900 text-white px-12 py-8 rounded-[3rem] shadow-2xl flex items-center gap-8 border border-white/10 backdrop-blur-2xl",children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-14 h-14 border-4 border-blue-500/20 border-t-blue-500 rounded-full animate-spin"}),e.jsx(Z,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-blue-500",size:20})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[12px] font-black uppercase tracking-[0.4em]",children:"Syncing Registry Logic"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-500 uppercase mt-1",children:"Updating from Sentinel Node Fabric..."})]})]})})]})},he=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{re as L,he as a,pe as e,E as g,me as m};
