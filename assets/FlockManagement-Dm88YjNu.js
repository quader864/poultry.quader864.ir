import{c as P,r as a,j as e,X as I,d as O,L as F,T as q,B as E,q as _,R as W,A as H,C as T,m as U}from"./index-BqfCj9Cx.js";import{P as M,C as Z}from"./CycleModal-DVsSmCn5.js";import{H as A}from"./history-pvMIkCk2.js";import{M as V}from"./message-square-DL_XctjU.js";import{C as B}from"./circle-check-nzM3eO1E.js";import{A as R}from"./arrow-left-DTNnOFbX.js";import{M as Y}from"./map-pin-slr9aYZ0.js";import{P as K}from"./plus-CPqBnqM0.js";import{C as X}from"./chart-column-BpoMgOJ7.js";import{P as G}from"./package-BkE9y1L1.js";import{S as J}from"./scale-DVVoC5M5.js";import{S as Q}from"./search-Ddf_DBck.js";import{S as ee}from"./save-CFcdqXGh.js";import{C as te}from"./calendar-BSOwSEYW.js";import{T as se}from"./trash-2-7Xu59JKU.js";import"./info-BRptETED.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],le=P("archive",ae);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],L=P("circle-stop",re),ne=({flockId:i,cycle:x,onClose:m,onSuccess:f,api:v,t:c,isRtl:l})=>{const[b,C]=a.useState(x.startDate.slice(0,16)),[p,w]=a.useState(x.endDate?x.endDate.slice(0,16):""),[n,j]=a.useState(x.status),[N,u]=a.useState(x.initialBirdAge||0),[g,r]=a.useState(x.notes||""),[h,k]=a.useState(!1),[s,o]=a.useState(""),y=async d=>{d.preventDefault(),k(!0),o("");try{const D={initialBirdAge:N,cycleStartDate:new Date(b).toISOString(),cycleEndDate:n==="ended"&&p?new Date(p).toISOString():null,status:n,notes:g};await v.updateCycle(i,x.cycleId,D),f()}catch(D){o(D.message||"Registry update failed")}finally{k(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300",dir:l?"rtl":"ltr",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-blue-50/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(M,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:l?"ویرایش دوره":"Edit Cycle"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:["Registry Correction Protocol: ",x.cycleId]})]})]}),e.jsx("button",{onClick:m,className:"p-2 text-slate-400 hover:text-rose-500 transition-colors",children:e.jsx(I,{size:24})})]}),e.jsxs("form",{onSubmit:y,className:"p-10 space-y-8 overflow-y-auto no-scrollbar max-h-[70vh]",children:[s&&e.jsx("div",{className:"p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-xs font-black uppercase",children:s}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:l?"وضعیت":"Cycle Status"}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black uppercase outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:n,onChange:d=>j(d.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"ended",children:"Ended"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1 flex items-center gap-2",children:[e.jsx(A,{size:12,className:"text-blue-500"})," ",l?"سن اولیه گله (روز)":"Initial Bird Age (Days)"]}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all tabular-nums",value:N,onChange:d=>u(parseInt(d.target.value)||0),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:l?"تاریخ شروع":"Start Date"}),e.jsx("input",{type:"datetime-local",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:b,onChange:d=>C(d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:l?"تاریخ پایان":"End Date"}),e.jsx("input",{type:"datetime-local",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all disabled:opacity-30",value:p,onChange:d=>w(d.target.value),disabled:n!=="ended"})]}),e.jsxs("div",{className:"space-y-2 col-span-full",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1 flex items-center gap-2",children:[e.jsx(V,{size:12,className:"text-indigo-500"})," ",l?"یادداشت‌های عملیاتی":"Operational Notes"]}),e.jsx("textarea",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-sm font-medium outline-none focus:ring-8 focus:ring-blue-500/5 transition-all min-h-[100px]",value:g,onChange:d=>r(d.target.value),placeholder:l?"توضیحات مربوط به اصلاحات یا وضعیت دوره...":"Reasons for manual registry adjustment or cycle context..."})]})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-100 p-5 rounded-[1.5rem] flex items-start gap-4",children:[e.jsx(O,{className:"text-amber-600 shrink-0",size:20}),e.jsx("p",{className:"text-[11px] font-medium text-amber-800 leading-relaxed",children:l?"تغییر تاریخ‌ها و سن اولیه بر تحلیل‌های پیش‌بینانه و منحنی‌های رشد تاثیر می‌گذارد.":"Updating boundaries and initial age affects predictive analytics and growth curve parity."})]}),e.jsxs("div",{className:"flex gap-4 pt-4 shrink-0",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 py-5 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-slate-600",children:l?"انصراف":"Cancel"}),e.jsx("button",{disabled:h,type:"submit",className:"flex-[2] py-5 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-2xl hover:bg-black transition-all flex items-center justify-center gap-3",children:h?e.jsx(F,{size:16,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{size:16})," Save Changes"]})})]})]})]})})},ie=({flockId:i,cycle:x,onClose:m,onSuccess:f,api:v,t:c,isRtl:l})=>{const[b,C]=a.useState(new Date().toISOString().slice(0,16)),[p,w]=a.useState(!1),[n,j]=a.useState(!1),[N,u]=a.useState(""),g=async r=>{if(r.preventDefault(),!p)return u("Please confirm the action.");j(!0),u("");try{await v.updateCycleStatus(i,x.cycleId,"ended",b),f()}catch(h){u(h.message||"Termination protocol failed")}finally{j(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl w-full max-w-lg overflow-hidden animate-in zoom-in-95 duration-300",dir:l?"rtl":"ltr",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-rose-50/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-50 text-rose-600 rounded-2xl flex items-center justify-center shadow-sm",children:e.jsx(L,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:l?"اتمام دوره عملیاتی":"End Production Cycle"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Lifecycle Termination Protocol"})]})]}),e.jsx("button",{onClick:m,className:"p-2 text-slate-400 hover:text-rose-500 transition-colors",children:e.jsx(I,{size:24})})]}),e.jsxs("form",{onSubmit:g,className:"p-10 space-y-8",children:[N&&e.jsxs("div",{className:"p-4 bg-rose-50 border border-rose-100 rounded-2xl text-rose-600 text-xs font-black uppercase flex items-center gap-3",children:[e.jsx(q,{size:16})," ",N]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-6 bg-slate-50 border border-slate-100 rounded-2xl",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Target Cycle"}),e.jsx("p",{className:"text-lg font-black text-slate-800",children:x.cycleId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:l?"تاریخ و زمان اتمام":"Operational End Date"}),e.jsx("input",{type:"datetime-local",className:"w-full bg-white border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-rose-500/5 transition-all",value:b,onChange:r=>C(r.target.value)})]}),e.jsxs("label",{className:"flex items-start gap-4 p-5 bg-slate-50 border border-slate-100 rounded-2xl cursor-pointer group hover:bg-white hover:border-rose-300 transition-all",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center shrink-0 transition-all ${p?"bg-rose-600 border-rose-600 text-white":"border-slate-200 group-hover:border-rose-400"}`,children:p&&e.jsx(B,{size:16,strokeWidth:3})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:p,onChange:r=>w(r.target.checked)}),e.jsx("span",{className:"text-[11px] font-bold text-slate-600 leading-relaxed uppercase",children:l?"تایید می‌کنم که عملیات این دوره پایان یافته و داده‌ها نهایی شده‌اند.":"I confirm that this production cycle is finalized and all telemetry is locked for audit."})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"flex-1 py-5 text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-slate-600",children:l?"انصراف":"Cancel"}),e.jsx("button",{disabled:n||!p,type:"submit",className:"flex-[2] py-5 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-2xl hover:bg-black transition-all flex items-center justify-center gap-3 disabled:opacity-30",children:n?e.jsx(F,{size:16,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(L,{size:16})," Finalize Termination"]})})]})]})]})})},ce=({flock:i,onBack:x,api:m,t:f})=>{const[v,c]=a.useState([]),[l,b]=a.useState(!0),[C,p]=a.useState(null),[w,n]=a.useState(!1),[j,N]=a.useState(null),[u,g]=a.useState(null),r=f.langToggle==="EN",h=async()=>{b(!0),p(null);try{const o=((await m.getCycles(i._id)).cycles||[]).sort((y,d)=>d.startDate.localeCompare(y.startDate));c(o)}catch(s){p(s.message||"Failed to load cycles")}finally{b(!1)}};a.useEffect(()=>{h()},[i._id,m]);const k=s=>s?new Date(s).toLocaleDateString(r?"fa-IR":"en-US",{timeZone:"Asia/Tehran"}):"---";return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",dir:r?"rtl":"ltr",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-6 px-2",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:x,className:"p-3 bg-white border border-slate-200 rounded-2xl text-slate-400 hover:text-slate-900 transition-all shadow-sm group",children:e.jsx(R,{size:20,className:"group-hover:-translate-x-1 transition-transform"})}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 text-white rounded-3xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:e.jsx(E,{size:32})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:i.name}),e.jsxs("div",{className:"flex wrap items-center gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[e.jsx(Y,{size:12,className:"text-blue-500"})," ",i.location||"Fleet Node Alpha"]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[e.jsx(_,{size:12,className:"text-indigo-500"})," ",i.capacity.toLocaleString()," Capacity"]}),e.jsx("span",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border ${i.status==="active"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-slate-50 text-slate-400 border-slate-100"}`,children:i.status})]})]})]})]}),e.jsxs("button",{onClick:h,className:"flex items-center gap-2 px-6 py-3 bg-white border border-slate-200 rounded-2xl text-xs font-black uppercase tracking-widest text-slate-600 hover:bg-slate-50 transition-all shadow-sm",children:[e.jsx(W,{size:16,className:l?"animate-spin":""}),f.refreshRegistry]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3rem] overflow-hidden shadow-sm flex flex-col",children:[e.jsxs("div",{className:"p-8 lg:p-10 border-b border-slate-100 bg-slate-50/30 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-slate-900 text-white rounded-2xl",children:e.jsx(A,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tight",children:"Lifecycle Registry"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Managed Operational Cycles"})]})]}),e.jsxs("button",{onClick:()=>n(!0),className:"px-8 py-3 bg-blue-600 text-white rounded-2xl text-[11px] font-black uppercase tracking-widest shadow-xl shadow-blue-500/20 hover:bg-blue-700 transition-all flex items-center gap-3",children:[e.jsx(K,{size:18,strokeWidth:3})," ",r?"شروع دوره جدید":"Initiate New Cycle"]})]}),e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full text-left border-collapse min-w-[1000px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/80 text-slate-400 font-black border-b border-slate-200 uppercase tracking-[0.2em] text-[10px]",children:[e.jsx("th",{className:"px-10 py-5",children:"Cycle ID"}),e.jsx("th",{className:"px-8 py-5",children:"Status"}),e.jsx("th",{className:"px-8 py-5",children:"Start Date"}),e.jsx("th",{className:"px-8 py-5",children:"End Date"}),e.jsx("th",{className:"px-8 py-5 text-center",children:"Movements"}),e.jsx("th",{className:"px-10 py-5 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:l&&v.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"py-24 text-center",children:[e.jsx(F,{className:"animate-spin text-blue-600 mx-auto",size:48}),e.jsx("p",{className:"mt-4 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Accessing Node Database..."})]})}):v.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"py-32 text-center opacity-30",children:[e.jsx(A,{size:80,strokeWidth:1,className:"mx-auto mb-6 text-slate-300"}),e.jsx("p",{className:"text-xl font-black uppercase tracking-[0.4em]",children:"Zero History Cycles"}),e.jsx("p",{className:"text-xs font-bold uppercase mt-2",children:"Initialize your first production cycle to begin tracking."})]})}):v.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50/50 transition-all group",children:[e.jsx("td",{className:"px-10 py-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg font-black text-slate-900 tabular-nums",children:s.cycleId}),e.jsxs("span",{className:"text-[9px] font-bold text-slate-400 uppercase mt-0.5",children:["Year ",s.year," • Sequence ",s.n]})]})}),e.jsx("td",{className:"px-8 py-6",children:e.jsxs("span",{className:`px-4 py-1.5 rounded-xl text-[9px] font-black uppercase tracking-widest border flex items-center gap-2 w-fit ${s.status==="active"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-slate-100 text-slate-500 border-slate-200"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s.status==="active"?"bg-emerald-500 animate-pulse":"bg-slate-400"}`}),s.status]})}),e.jsx("td",{className:"px-8 py-6 text-sm font-bold text-slate-600 tabular-nums",children:k(s.startDate)}),e.jsx("td",{className:"px-8 py-6 text-sm font-bold text-slate-600 tabular-nums",children:s.endDate?k(s.endDate):"Active Stream"}),e.jsx("td",{className:"px-8 py-6 text-center",children:e.jsxs("div",{className:"inline-flex flex-col items-center",children:[e.jsx("span",{className:"text-lg font-black text-slate-900 tabular-nums",children:s.movementCount||0}),e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest",children:"Ledger Entries"})]})}),e.jsx("td",{className:"px-10 py-6 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-3 opacity-0 group-hover:opacity-100 transition-all",children:[e.jsx("button",{onClick:()=>N(s),className:"p-3 bg-white border border-slate-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300 rounded-2xl transition-all shadow-sm",title:"Edit Registry",children:e.jsx(M,{size:18})}),s.status==="active"&&e.jsx("button",{onClick:()=>g(s),className:"p-3 bg-white border border-rose-100 text-rose-600 hover:bg-rose-50 hover:border-rose-300 rounded-2xl transition-all shadow-sm",title:"End Production Cycle",children:e.jsx(L,{size:18})})]})})]},s.cycleId))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white border border-slate-200 p-8 rounded-[2.5rem] shadow-sm flex items-center gap-6 group hover:shadow-xl transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(X,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5",children:"Yield Velocity"}),e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase",children:"Weight Trends"})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 p-8 rounded-[2.5rem] shadow-sm flex items-center gap-6 group hover:shadow-xl transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(H,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5",children:"Health Logic"}),e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase",children:"Mortality Scan"})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 p-8 rounded-[2.5rem] shadow-sm flex items-center gap-6 group hover:shadow-xl transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-amber-50 text-amber-600 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(G,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5",children:"Resource Drain"}),e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase",children:"Feed Analysis"})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 p-8 rounded-[2.5rem] shadow-sm flex items-center gap-6 group hover:shadow-xl transition-all",children:[e.jsx("div",{className:"w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(J,{size:28})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-0.5",children:"Mass Consensus"}),e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase",children:"Bird Balances"})]})]})]}),w&&e.jsx(Z,{flockId:i._id,onClose:()=>n(!1),onSuccess:()=>{n(!1),h()},api:m,t:f,isRtl:r}),j&&e.jsx(ne,{flockId:i._id,cycle:j,onClose:()=>N(null),onSuccess:()=>{N(null),h()},api:m,t:f,isRtl:r}),u&&e.jsx(ie,{flockId:i._id,cycle:u,onClose:()=>g(null),onSuccess:()=>{g(null),h()},api:m,t:f,isRtl:r})]})},Ce=({flocks:i,onUpdate:x,onArchive:m,onDelete:f,onCreate:v,t:c,api:l})=>{const[b,C]=a.useState(""),[p,w]=a.useState(null),[n,j]=a.useState({}),[N,u]=a.useState(!1),[g,r]=a.useState(!1),[h,k]=a.useState(null),s=()=>new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Tehran"}).format(new Date),[o,y]=a.useState({name:"",capacity:5e3,startDate:s(),breed:"",location:""});if(h)return e.jsx(ce,{flock:h,onBack:()=>k(null),api:l,t:c});const d=i.filter(t=>{var z;return t.name.toLowerCase().includes(b.toLowerCase())||((z=t.breed)==null?void 0:z.toLowerCase().includes(b.toLowerCase()))}),D=async t=>{r(!0);try{await x(t,n),w(null)}finally{r(!1)}},$=async t=>{t.preventDefault(),r(!0);try{await v(o),u(!1),y({name:"",capacity:5e3,startDate:s(),breed:"",location:""})}finally{r(!1)}},S=c.langToggle==="EN";return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative group flex-1 max-w-md",children:[e.jsx(Q,{className:`absolute ${S?"right-4":"left-4"} top-1/2 -translate-y-1/2 text-slate-400`,size:18}),e.jsx("input",{type:"text",placeholder:S?"جستجوی گله...":"Search flocks...",className:`w-full ${S?"pr-12 pl-4":"pl-12 pr-4"} py-3 bg-white border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 transition-all shadow-sm font-medium`,value:b,onChange:t=>C(t.target.value)})]}),e.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-2xl font-black text-xs uppercase tracking-[0.15em] shadow-xl shadow-blue-500/20 hover:bg-blue-700 transition-all flex items-center justify-center gap-3",children:[e.jsx(T,{size:18})," ",c.addFlock]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:d.map(t=>e.jsxs("div",{className:"group bg-white rounded-[2rem] border border-slate-200 p-6 shadow-sm hover:shadow-2xl hover:border-blue-300 transition-all duration-500 flex flex-col relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 ${S?"left-0":"right-0"} w-24 h-24 bg-blue-50 rounded-full -translate-y-12 translate-x-12 opacity-50 group-hover:scale-150 transition-transform duration-700`}),e.jsxs("div",{className:"flex justify-between items-start mb-6 z-10",children:[e.jsx("div",{className:"w-14 h-14 bg-blue-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/30 group-hover:rotate-12 transition-transform duration-500",children:e.jsx(E,{size:28})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(t),className:"p-2 bg-slate-50 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all shadow-sm",title:"View Cycle Details",children:e.jsx(U,{size:20})}),e.jsx("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border ${t.status==="active"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-slate-50 text-slate-400 border-slate-100"}`,children:t.status})]})]}),p===t._id?e.jsxs("div",{className:"space-y-4 z-10 animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Name"}),e.jsx("input",{className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-3 py-2 text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none",value:n.name||t.name,onChange:z=>j({...n,name:z.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Capacity"}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-3 py-2 text-sm font-bold focus:ring-2 focus:ring-blue-500 outline-none",value:n.capacity||t.capacity,onChange:z=>j({...n,capacity:Number(z.target.value)})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>D(t._id),className:"flex-1 py-3 bg-blue-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2",children:g?e.jsx(F,{className:"animate-spin",size:14}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{size:14})," Save"]})}),e.jsx("button",{onClick:()=>w(null),className:"flex-1 py-3 bg-slate-100 text-slate-600 rounded-xl text-[10px] font-black uppercase tracking-widest",children:"Cancel"})]})]}):e.jsxs("div",{className:"z-10 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-xl font-black text-slate-800 tracking-tight mb-2 group-hover:text-blue-600 transition-colors",children:t.name}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(_,{size:14,className:"text-blue-400"}),e.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-tight",children:[t.capacity.toLocaleString()," Birds Capacity"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(te,{size:14,className:"text-indigo-400"}),e.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-tight",children:["Started: ",new Date(t.startDate).toLocaleDateString(S?"fa-IR":"en-US",{timeZone:"Asia/Tehran"})]})]}),t.breed&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(E,{size:14,className:"text-emerald-400"}),e.jsxs("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-tight",children:["Breed: ",t.breed]})]})]}),e.jsxs("div",{className:"mt-auto flex flex-wrap items-center gap-4 pt-5 border-t border-slate-50",children:[e.jsxs("button",{onClick:()=>{w(t._id),j(t)},className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-blue-600 hover:bg-blue-50 px-2 py-1.5 rounded-lg transition-all",children:[e.jsx(M,{size:14})," ",c.editFlock]}),e.jsxs("button",{onClick:()=>m(t._id),className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-amber-600 hover:bg-amber-50 px-2 py-1.5 rounded-lg transition-all",children:[e.jsx(le,{size:14})," ",c.archiveFlock]}),e.jsxs("button",{onClick:()=>f(t._id),className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-rose-600 hover:bg-rose-50 px-2 py-1.5 rounded-lg transition-all ml-auto",children:[e.jsx(se,{size:14})," Delete"]})]})]})]},t._id))}),N&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-[70] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-lg overflow-hidden animate-in zoom-in-95 duration-200",dir:S?"rtl":"ltr",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:c.addFlock}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-400",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:$,className:"p-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2 space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:c.flockName}),e.jsx("input",{required:!0,className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3.5 text-sm font-bold focus:ring-4 focus:ring-blue-500/10 outline-none",placeholder:"ALPHA-FLOCK-01",value:o.name,onChange:t=>y({...o,name:t.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:c.capacity}),e.jsx("input",{type:"number",required:!0,className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3.5 text-sm font-bold outline-none",value:o.capacity,onChange:t=>y({...o,capacity:Number(t.target.value)})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:[c.startDate," (Tehran)"]}),e.jsx("input",{type:"date",required:!0,className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3.5 text-sm font-bold outline-none",value:o.startDate,onChange:t=>y({...o,startDate:t.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:c.breed}),e.jsx("input",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3.5 text-sm font-bold outline-none",placeholder:"Ross 308",value:o.breed,onChange:t=>y({...o,breed:t.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:c.location}),e.jsx("input",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3.5 text-sm font-bold outline-none",placeholder:"Building 04, North Wing",value:o.location,onChange:t=>y({...o,location:t.target.value})})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 py-4 border border-slate-200 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-500",children:c.cancel}),e.jsx("button",{type:"submit",disabled:g,className:"flex-1 py-4 bg-blue-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl flex items-center justify-center gap-2",children:g?e.jsx(F,{size:16,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(T,{size:16})," Create Flock"]})})]})]})]})}),d.length===0&&e.jsxs("div",{className:"col-span-full py-40 flex flex-col items-center justify-center text-center opacity-30",children:[e.jsx(E,{size:80,className:"text-slate-300 mb-6",strokeWidth:1}),e.jsx("h3",{className:"text-xl font-black text-slate-400 uppercase tracking-[0.2em]",children:"Zero Managed Nodes"}),e.jsx("p",{className:"text-sm font-bold text-slate-300 uppercase mt-2",children:"Provision your first flock to begin telemetry."})]})]})};export{Ce as default};
