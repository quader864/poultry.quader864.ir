import{r as i,j as e,d as T,L as B,Z as D,A as F,g as V,R as E}from"./index-D-P-TEXt.js";import{G as j}from"./git-compare-zFBp9WbN.js";import{A as _}from"./AnalyticsLab-CqjdvX1-.js";import{T as $}from"./trophy-qRwRID1k.js";import{A as M}from"./award-BwKZvoEc.js";import{C as L}from"./chart-column-CrgVJdd7.js";import{T as G}from"./trending-up-BYFYVXzO.js";import{T as W}from"./trending-down-D34o6TKB.js";import"./wind--BVULmoI.js";import"./clock-Cu403Q11.js";import"./box-DQ43xKPC.js";const ae=({api:d,t:Z,isRtl:H,flocks:x,initialFlockA:v,initialCycleA:k})=>{var f,b;const[t,p]=i.useState({flockId:v||"",cycleId:k||""}),[a,m]=i.useState({flockId:"",cycleId:""}),[N,w]=i.useState([]),[I,C]=i.useState([]),[l,A]=i.useState(null),[h,g]=i.useState(!1);i.useEffect(()=>{t.flockId&&t.flockId!=="all"&&d.getCycles(t.flockId).then(s=>w(s.cycles||[]))},[t.flockId,d]),i.useEffect(()=>{a.flockId&&a.flockId!=="all"&&d.getCycles(a.flockId).then(s=>C(s.cycles||[]))},[a.flockId,d]);const z=async()=>{if(!(!t.cycleId||!a.cycleId)){g(!0);try{const s=await d.compareCyclesV2([{flockId:t.flockId,cycleId:t.cycleId},{flockId:a.flockId,cycleId:a.cycleId}]);A(s.data||s)}catch(s){console.error("Cross-analysis failed",s)}finally{g(!1)}}},P=({val:s,inverse:c=!1})=>{if(s===0||isNaN(s))return e.jsx("span",{className:"text-slate-400",children:"0%"});const r=s>0,o=c?!r:r;return e.jsxs("div",{className:`flex items-center gap-1 ${o?"text-emerald-500":"text-rose-500"} font-black tabular-nums text-xs lg:text-sm`,children:[r?e.jsx(G,{size:14}):e.jsx(W,{size:14}),Math.abs(s).toFixed(2),"%"]})},u=(s,c)=>{var o,y;if(!((o=l==null?void 0:l.comparison)!=null&&o[s]))return 0;const r=(y=l.comparison[s].rankings)==null?void 0:y.find(S=>S.cycleId===c);return r?r.value:0},R=[{label:"Eggs Per Bird / Day",key:"eggsPerBirdPerDay",inverse:!1,format:s=>s.toFixed(4)},{label:"Mortality Rate / Day",key:"mortalityPerBirdPerDay",inverse:!0,format:s=>(s*100).toFixed(3)+"%"},{label:"Revenue / Bird / Day",key:"revenuePerBirdPerDay",inverse:!1,format:s=>"$"+s.toFixed(2)},{label:"Cost / Bird / Day",key:"costPerBirdPerDay",inverse:!0,format:s=>"$"+s.toFixed(2)},{label:"Profit / Bird / Day",key:"profitPerBirdPerDay",inverse:!1,format:s=>"$"+s.toFixed(2)}],n=(f=l==null?void 0:l.ranking)==null?void 0:f[0];return e.jsxs("div",{className:"space-y-10 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3rem] p-10 lg:p-14 shadow-sm space-y-10",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 text-slate-900 font-black uppercase text-xs tracking-[0.3em]",children:[e.jsx(j,{size:20,className:"text-purple-600"})," Comparison Anchors"]}),l&&e.jsxs("div",{className:"flex items-center gap-3 bg-emerald-50 text-emerald-600 px-5 py-2 rounded-xl border border-emerald-100",children:[e.jsx(T,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Cross-Analysis Verified"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 relative",children:[e.jsx("div",{className:"hidden lg:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-slate-900 text-white rounded-full items-center justify-center shadow-2xl z-10 border-4 border-white",children:e.jsx("span",{className:"text-[10px] font-black uppercase",children:"VS"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})," Target A (Primary)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{value:t.flockId,onChange:s=>p({...t,flockId:s.target.value,cycleId:""}),className:"bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none focus:ring-4 focus:ring-blue-500/5 transition-all",children:[e.jsx("option",{value:"",children:"Select Flock"}),x.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]}),e.jsxs("select",{value:t.cycleId,onChange:s=>p({...t,cycleId:s.target.value}),className:"bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none focus:ring-4 focus:ring-blue-500/5 transition-all",disabled:!t.flockId,children:[e.jsx("option",{value:"",children:"Select Cycle"}),N.map(s=>e.jsxs("option",{value:s.cycleId,children:[s.cycleId," ",s.status==="active"?"(ACT)":""]},s.cycleId))]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center justify-end gap-2",children:["Target B (Reference) ",e.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-300"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{value:a.flockId,onChange:s=>m({...a,flockId:s.target.value,cycleId:""}),className:"bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none focus:ring-4 focus:ring-blue-500/5 transition-all",children:[e.jsx("option",{value:"",children:"Select Flock"}),x.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]}),e.jsxs("select",{value:a.cycleId,onChange:s=>m({...a,cycleId:s.target.value}),className:"bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none focus:ring-4 focus:ring-blue-500/5 transition-all",disabled:!a.flockId,children:[e.jsx("option",{value:"",children:"Select Cycle"}),I.map(s=>e.jsxs("option",{value:s.cycleId,children:[s.cycleId," ",s.status==="active"?"(ACT)":""]},s.cycleId))]})]})]})]}),e.jsx("div",{className:"pt-6 flex justify-center",children:e.jsx("button",{onClick:z,disabled:h||!t.cycleId||!a.cycleId,className:"px-16 py-5 bg-slate-900 text-white rounded-2xl text-[11px] font-black uppercase tracking-[0.2em] shadow-2xl hover:bg-black transition-all flex items-center gap-3 disabled:opacity-30 disabled:cursor-not-allowed group",children:h?e.jsx(B,{size:18,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(_,{size:18,className:"group-hover:rotate-180 transition-transform duration-500"})," Run Cross-Analysis"]})})})]}),l?e.jsxs("div",{className:"space-y-12 animate-in slide-in-from-bottom-6 duration-700",children:[n&&e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-3xl p-1 px-1 shadow-xl",children:e.jsxs("div",{className:"bg-white rounded-[1.6rem] p-6 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center shadow-inner",children:e.jsx($,{size:32})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Statistical Performance Winner"}),e.jsxs("h3",{className:"text-2xl font-black text-slate-900 uppercase tracking-tight",children:[n.flockName," (",n.cycleId,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase",children:"Analysis Confidence"}),e.jsx("p",{className:"text-xl font-black text-blue-600",children:"High Consensus"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(M,{size:24})})]})]})}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3.5rem] overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center gap-3 bg-slate-50/50",children:[e.jsx(L,{size:20,className:"text-slate-400"}),e.jsx("h4",{className:"text-xs font-black text-slate-900 uppercase tracking-widest",children:"Vector Delta Matrix"})]}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900 text-slate-500 font-black uppercase tracking-[0.2em] text-[9px]",children:[e.jsx("th",{className:"px-10 py-6",children:"Performance Vector"}),e.jsxs("th",{className:"px-10 py-6 text-center text-blue-400",children:[t.cycleId," (Target)"]}),e.jsxs("th",{className:"px-10 py-6 text-center",children:[a.cycleId," (Reference)"]}),e.jsx("th",{className:"px-10 py-6 text-right",children:"Variance (Î”)"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:R.map(s=>{const c=u(s.key,t.cycleId),r=u(s.key,a.cycleId),o=r!==0?(c-r)/Math.abs(r)*100:0;return e.jsxs("tr",{className:"group hover:bg-blue-50/30 transition-colors",children:[e.jsx("td",{className:"px-10 py-8",children:e.jsx("span",{className:"text-sm font-black text-slate-800 uppercase tracking-tight",children:s.label})}),e.jsx("td",{className:"px-10 py-8 text-center",children:e.jsx("span",{className:"text-base font-black text-slate-900 tabular-nums",children:s.format(c)})}),e.jsx("td",{className:"px-10 py-8 text-center",children:e.jsx("span",{className:"text-base font-black text-slate-400 tabular-nums",children:s.format(r)})}),e.jsx("td",{className:"px-10 py-8 text-right",children:e.jsx(P,{val:o,inverse:s.inverse})})]},s.key)})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-12 text-white shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:scale-110 transition-transform",children:e.jsx(D,{size:120})}),e.jsxs("h4",{className:"text-xs font-black uppercase tracking-[0.2em] mb-10 flex items-center gap-4 text-blue-400",children:[e.jsx(F,{size:20})," Registry Insights"]}),e.jsxs("div",{className:"space-y-6 relative z-10 max-h-[400px] overflow-y-auto no-scrollbar",children:[(b=l.insights)==null?void 0:b.map((s,c)=>e.jsxs("div",{className:"p-6 bg-white/5 border border-white/5 rounded-3xl group hover:bg-white/10 transition-all flex items-start gap-5",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 shrink-0 shadow-[0_0_8px_rgba(59,130,246,0.6)]"}),e.jsx("p",{className:"text-sm font-bold text-slate-300 leading-relaxed uppercase tracking-tight",children:s})]},c)),(!l.insights||l.insights.length===0)&&e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase italic",children:"No comparative anomalies detected by sentinel logic."})]})]}),e.jsxs("div",{className:"bg-indigo-600 rounded-[3rem] p-12 text-white shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute bottom-0 right-0 p-8 opacity-10 group-hover:rotate-12 transition-transform duration-700",children:e.jsx(V,{size:140})}),e.jsx("h4",{className:"text-xs font-black uppercase tracking-[0.2em] mb-10 text-indigo-200",children:"System Optimization"}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsx("p",{className:"text-xl lg:text-2xl font-black leading-tight uppercase tracking-tight",children:(n==null?void 0:n.cycleId)===t.cycleId?`The Target Cycle (${t.cycleId}) is showing superior efficiency. Recommend auditing its resource batch logs for fleet-wide replication.`:`Performance Drift detected in Target. Cross-referencing against Reference (${a.cycleId}) suggests a potential optimization path in feed velocity.`}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[e.jsxs("button",{className:"px-8 py-4 bg-slate-900 rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl hover:bg-black transition-all flex items-center gap-2",children:[e.jsx(E,{size:14})," Re-sync Analysis"]}),e.jsx("button",{className:"px-8 py-4 bg-white/10 border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-white/20 transition-all",children:"Export Delta Report"})]})]})]})]})]}):e.jsxs("div",{className:"bg-white border border-slate-200 border-dashed rounded-[3.5rem] flex flex-col items-center justify-center text-center p-32 opacity-40 group hover:border-blue-300 transition-all duration-500",children:[e.jsx(j,{size:80,strokeWidth:1,className:"text-slate-300 mb-8 group-hover:rotate-12 transition-transform"}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 uppercase tracking-widest mb-2",children:"Registry Comparison Engine"}),e.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-[0.2em] max-w-sm",children:"Anchor two separate production cycles to begin cross-vector delta analysis and performance ranking"})]})]})};export{ae as default};
