import{c as H,j as e,a as ee,Z as S,d as se,g as G,r as d,X as te,L as W,h as ae}from"./index-Dfm8v7ej.js";import{D as L}from"./droplets-XYTlFp_P.js";import{W as B}from"./wind-Cp8vbkoN.js";import{T as $}from"./thermometer-DEO5nHHu.js";import{I as O}from"./info-KoxbNrkG.js";import{C as V}from"./circle-check-VEIAJ82F.js";import{S as le}from"./scale-BPmcQ8e1.js";import{P as re}from"./package-CVn6tmlZ.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],ce=H("fingerprint-pattern",ne);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],K=H("sparkles",ie),oe=({data:t,onChange:j,t:p,isRtl:y})=>{const l=(s,m)=>j({...t,[s]:m});return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-50 text-blue-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform",children:e.jsx(L,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Water Chemistry Matrix"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Direct Clinical Node Input"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-8 bg-slate-50/50 p-8 rounded-[2.5rem] border border-slate-100",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center ml-1",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"pH Balance (6.5 - 8.5)"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black ${t.pH>8.5||t.pH<6.5?"bg-rose-100 text-rose-600":"bg-emerald-100 text-emerald-600"}`,children:t.pH||7})]}),e.jsx("input",{type:"range",min:"0",max:"14",step:"0.1",className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:t.pH||7,onChange:s=>l("pH",parseFloat(s.target.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Hardness (mg/L)"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-5 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:t.hardness||"",onChange:s=>l("hardness",parseFloat(s.target.value)),placeholder:"0.0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Free Chlorine"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full bg-white border border-slate-200 rounded-2xl px-5 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:t.freeChlorine||"",onChange:s=>l("freeChlorine",parseFloat(s.target.value)),placeholder:"0.00"})]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Water Supply Source"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["municipal","well","rainwater","trucked"].map(s=>e.jsx("button",{type:"button",onClick:()=>l("source",s),className:`px-4 py-3.5 rounded-xl text-[9px] font-black uppercase tracking-widest transition-all ${t.source===s?"bg-blue-600 text-white shadow-lg":"bg-slate-50 text-slate-400 hover:bg-slate-100"}`,children:s},s))})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10",children:e.jsx(ee,{size:60})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] mb-4 flex items-center gap-2 relative z-10",children:[e.jsx(S,{size:14,className:"text-blue-400"})," Integrity Check"]}),e.jsx("div",{className:"space-y-3 relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-white/20 bg-transparent text-blue-500 focus:ring-0",onChange:s=>l("coliformDetected",s.target.checked)}),e.jsx("span",{className:"text-[10px] font-bold uppercase text-slate-400",children:"Biological Contaminants Detected?"})]})})]})]})]})]})},de=({data:t,onChange:j,t:p,isRtl:y})=>{const l=(s,m)=>j({...t,[s]:m});return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-50 text-emerald-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:scale-110 transition-transform",children:e.jsx(B,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Atmospheric Node Registry"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Environmental Sensor Verification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx($,{size:24,className:"text-rose-500 mb-6 group-hover:rotate-12 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Temp (Â°C)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:t.temperature||"",onChange:s=>l("temperature",parseFloat(s.target.value)),placeholder:"24.5"})]}),e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx(S,{size:24,className:"text-blue-500 mb-6 group-hover:scale-110 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Humidity (%)"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:t.humidity||"",onChange:s=>l("humidity",parseFloat(s.target.value)),placeholder:"65"})]}),e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100 flex flex-col items-center group",children:[e.jsx(B,{size:24,className:"text-indigo-500 mb-6 group-hover:-translate-y-1 transition-transform"}),e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4",children:"Vent Rate"}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-4 py-4 text-center text-xl font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",value:t.ventilation||"",onChange:s=>l("ventilation",parseFloat(s.target.value)),placeholder:"12.0"})]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5",children:e.jsx(se,{size:100})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.3em] mb-10 flex items-center gap-3 relative z-10",children:[e.jsx(O,{size:16,className:"text-blue-400"})," Advanced Gas Telemetry"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 relative z-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Ammonia (PPM)"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-black ${(t.ammoniaPpm||0)>25?"bg-rose-500 text-white":"bg-emerald-500/10 text-emerald-400"}`,children:t.ammoniaPpm||0})]}),e.jsx("input",{type:"range",min:"0",max:"100",className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500",value:t.ammoniaPpm||0,onChange:s=>l("ammoniaPpm",parseInt(s.target.value))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"CO2 (PPM)"}),e.jsx("span",{className:"bg-white/5 px-2 py-0.5 rounded text-[10px] font-black text-slate-300",children:t.co2Ppm||0})]}),e.jsx("input",{type:"range",min:"0",max:"5000",step:"100",className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-indigo-500",value:t.co2Ppm||0,onChange:s=>l("co2Ppm",parseInt(s.target.value))})]})]})]})]})},xe=({data:t,onChange:j,t:p,isRtl:y})=>{var s,m,N,w,k,n;const l=(c,b)=>{const f={...t};f.eggMetrics||(f.eggMetrics={}),f.eggMetrics[c]=b,["gradeA","gradeB","broken"].includes(c)&&(f.eggMetrics.count=(parseInt(f.eggMetrics.gradeA)||0)+(parseInt(f.eggMetrics.gradeB)||0)+(parseInt(f.eggMetrics.broken)||0)),j(f)};return e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-50 pb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-50 text-amber-600 rounded-[1.5rem] flex items-center justify-center shadow-inner group-hover:rotate-6 transition-transform",children:e.jsx(G,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter",children:"Yield Precision Registry"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Detailed Egg Grading & Mass"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"bg-white border-2 border-blue-100 p-10 rounded-[3rem] shadow-xl shadow-blue-500/5",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-500 uppercase tracking-widest mb-4",children:"Aggregated Yield"}),e.jsx("h4",{className:"text-6xl font-black text-slate-900 tabular-nums",children:((s=t.eggMetrics)==null?void 0:s.count)||0}),e.jsxs("p",{className:"text-[11px] font-bold text-slate-400 mt-4 uppercase flex items-center gap-2",children:[e.jsx(V,{size:14,className:"text-emerald-500"})," Automated Sum Consensus"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-blue-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-emerald-500 font-black",children:"A"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Grade A (Premium)"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((m=t.eggMetrics)==null?void 0:m.gradeA)||"",onChange:c=>l("gradeA",parseInt(c.target.value)),placeholder:"0"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-amber-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-amber-500 font-black",children:"B"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Grade B (Commercial)"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((N=t.eggMetrics)==null?void 0:N.gradeB)||"",onChange:c=>l("gradeB",parseInt(c.target.value)),placeholder:"0"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 p-6 bg-slate-50 border border-slate-100 rounded-[2rem] group hover:bg-white hover:border-rose-200 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-2xl flex items-center justify-center shadow-sm text-rose-500 font-black",children:"X"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-1",children:"Broken / Damage"}),e.jsx("input",{type:"number",className:"w-full bg-transparent border-none text-lg font-black outline-none",value:((w=t.eggMetrics)==null?void 0:w.broken)||"",onChange:c=>l("broken",parseInt(c.target.value)),placeholder:"0"})]})]})]})]}),e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx(le,{size:100})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.3em] mb-10 flex items-center gap-3 relative z-10",children:[e.jsx(S,{size:16,className:"text-blue-400"})," Mass Metrology"]}),e.jsxs("div",{className:"space-y-8 relative z-10",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Total Weight (KG)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 text-xl font-black outline-none focus:bg-white/10 transition-all",value:((k=t.eggMetrics)==null?void 0:k.totalWeightKg)||"",onChange:c=>l("totalWeightKg",parseFloat(c.target.value)),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1",children:"Avg Egg Mass (G)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 text-xl font-black outline-none focus:bg-white/10 transition-all",value:((n=t.eggMetrics)==null?void 0:n.avgWeightPerEgg)||"",onChange:c=>l("avgWeightPerEgg",parseFloat(c.target.value)),placeholder:"0.0"})]})]})]}),e.jsxs("div",{className:"p-8 bg-blue-50 border border-blue-100 rounded-[2.5rem] flex items-start gap-5",children:[e.jsx(O,{size:24,className:"text-blue-600 shrink-0 mt-1"}),e.jsx("p",{className:"text-[11px] font-bold text-blue-700 leading-loose uppercase",children:"Yield consistency check: Input grade distribution should match the total daily collection log for precision FCR calculations."})]})]})]})]})},pe=[{id:"morning_eggs",label:"Morning Egg Collection",icon:e.jsx(G,{}),color:"text-amber-500 bg-amber-50",values:{type:"egg_collection",eggMetrics:{count:4800,gradeA:4600,gradeB:150,broken:50},reason:"daily_collection"}},{id:"standard_feed",label:"Standard Feed Delivery",icon:e.jsx(re,{}),color:"text-blue-500 bg-blue-50",values:{type:"feed",feedMetrics:{purchasedKg:1e3,feedType:"Starter",supplier:"Standard Supplier"},reason:"purchase"}},{id:"water_audit",label:"Weekly Water Audit",icon:e.jsx(L,{}),color:"text-indigo-500 bg-indigo-50",values:{type:"water_reading",pH:7.2,hardness:120,freeChlorine:.5,source:"well"}},{id:"env_check",label:"Mid-Day Env Check",icon:e.jsx($,{}),color:"text-rose-500 bg-rose-50",values:{type:"environmental_reading",temperature:24.5,humidity:65,ventilation:12}}],me=({onApply:t,isRtl:j})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 px-2",children:[e.jsx(K,{size:18,className:"text-blue-500"}),e.jsx("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Rapid Ingestion Presets"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:pe.map(p=>e.jsxs("button",{onClick:()=>t(p.values),className:"p-5 bg-white border border-slate-200 rounded-2xl flex items-center gap-4 hover:border-blue-300 hover:shadow-lg transition-all group text-left",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 group-hover:scale-110 transition-transform ${p.color}`,children:p.icon}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-black text-slate-800 uppercase truncate tracking-tight",children:p.label}),e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase mt-1",children:["Preset Vector: ",p.values.type.replace("_"," ")]})]})]},p.id))})]}),ke=({onClose:t,onSubmit:j,flocks:p=[],t:y,api:l,editingMovement:s})=>{var D;const m=y.langToggle==="EN",N=()=>new Date().toISOString().split("T")[0],[w,k]=d.useState([]),[n,c]=d.useState((s==null?void 0:s.type)||""),[b,f]=d.useState((s==null?void 0:s.flockId)||((D=p[0])==null?void 0:D._id)||""),[I,q]=d.useState((s==null?void 0:s.cycleId)||""),[M,Q]=d.useState(null),[r,v]=d.useState({}),[ge,Y]=d.useState([]),[he,P]=d.useState(!1),[X,_]=d.useState(!1),[F,T]=d.useState(!1),[E,C]=d.useState(""),[z,A]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const h=(await l.getMovementInputSchema()).data||{},x=Object.entries(h).map(([o,u])=>({id:o,label:u.label||o,description:u.description}));k(x),!n&&x.length>0&&c(x[0].id)}catch(i){console.error("Failed to load vector types",i)}})()},[l]),d.useEffect(()=>{(async()=>{if(b){P(!0);try{const h=((await l.getCycles(b)).cycles||[]).sort((x,o)=>o.cycleId.localeCompare(x.cycleId));if(Y(h),h.length>0&&!I){const x=h.find(o=>o.status==="active");q(x?x.cycleId:h[0].cycleId)}}catch(i){console.error(i)}finally{P(!1)}}})()},[b,l]),d.useEffect(()=>{(async()=>{if(n){_(!0),C("");try{const i=await l.getMovementInputSchema(n);Q(i.data),v(s||{date:N(),confidence:"high"})}catch{C("Schema sync failed")}finally{_(!1)}}})()},[n,l,s]);const R=d.useCallback((a,i)=>{v(h=>{const x={...h},o=a.split(".");let u=x;for(let g=0;g<o.length-1;g++)u[o[g]]={...u[o[g]]||{}},u=u[o[g]];return u[o[o.length-1]]=i,x})},[]),Z=a=>{v({...r,...a}),c(a.type||n),A(!1)},J=async a=>{var i,h,x,o,u;T(!0),C("");try{const g=[];n==="water_reading"?g.push(l.recordWaterQuality({flockId:b,pH:r.pH||7,hardness:r.hardness||0,freeChlorine:r.freeChlorine||0,source:r.source||"well"})):n==="environmental_reading"?g.push(l.recordEnvironmentalReading({flockId:b,temperature:r.temperature||25,humidity:r.humidity||65,ventilationRate:r.ventilation||0,ammoniaPpm:r.ammoniaPpm,co2Ppm:r.co2Ppm})):n==="egg_collection"&&g.push(l.recordEggProduction({flockId:b,totalEggs:((i=r.eggMetrics)==null?void 0:i.count)||0,gradeA:((h=r.eggMetrics)==null?void 0:h.gradeA)||0,gradeB:((x=r.eggMetrics)==null?void 0:x.gradeB)||0,broken:((o=r.eggMetrics)==null?void 0:o.broken)||0,avgWeight:(u=r.eggMetrics)==null?void 0:u.avgWeightPerEgg})),await l.createMovement(b,I,{...r,type:n}),await Promise.all(g),t(),j(r)}catch(g){C(g.message||"Registry communication failure")}finally{T(!1)}},U=["water_reading","environmental_reading","egg_collection"].includes(n);return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-4 overflow-y-auto",dir:m?"rtl":"ltr",children:e.jsxs("div",{className:"bg-white rounded-[4rem] shadow-2xl w-full max-w-6xl my-auto animate-in zoom-in-95 duration-500 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 flex items-center justify-between bg-slate-50/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx(ce,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:"Intelligence Registry"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mt-3",children:["VECTOR PROTOCOL: ",n.replace(/_/g," ")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>A(!z),className:`px-6 py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 ${z?"bg-blue-600 text-white shadow-lg":"bg-white border border-slate-200 text-slate-600"}`,children:[e.jsx(K,{size:16})," Templates"]}),e.jsx("button",{onClick:t,className:"p-4 bg-white hover:bg-rose-50 text-slate-400 hover:text-rose-500 rounded-2xl transition-all shadow-sm",children:e.jsx(te,{size:24})})]})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row h-[75vh] overflow-hidden",children:[e.jsxs("div",{className:"w-full lg:w-80 bg-slate-50 border-r border-slate-100 p-10 space-y-10 overflow-y-auto no-scrollbar shrink-0",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:"Fleet Node"}),e.jsx("select",{className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 text-xs font-black uppercase outline-none shadow-sm",value:b,onChange:a=>f(a.target.value),children:p.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:"Vector Type"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:w.map(a=>e.jsx("button",{type:"button",onClick:()=>c(a.id),className:`text-left px-5 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${n===a.id?"bg-blue-600 text-white shadow-xl":"bg-white text-slate-400 border border-slate-200 hover:bg-slate-100"}`,children:a.label},a.id))})]})]}),e.jsx("div",{className:"flex-1 p-14 overflow-y-auto no-scrollbar bg-white relative",children:X?e.jsx("div",{className:"h-full flex flex-col items-center justify-center opacity-40",children:e.jsx(W,{size:48,className:"animate-spin text-blue-600"})}):z?e.jsx("div",{className:"animate-in fade-in duration-300",children:e.jsx(me,{onApply:Z,isRtl:m})}):e.jsxs("div",{className:"space-y-12 animate-in fade-in duration-500",children:[E&&e.jsxs("div",{className:"bg-rose-50 text-rose-600 p-6 rounded-2xl border border-rose-100 flex items-center gap-4",children:[e.jsx(ae,{size:24}),e.jsx("p",{className:"text-xs font-black uppercase tracking-tight",children:E})]}),n==="water_reading"&&e.jsx(oe,{data:r,onChange:v,t:y,isRtl:m}),n==="environmental_reading"&&e.jsx(de,{data:r,onChange:v,t:y,isRtl:m}),n==="egg_collection"&&e.jsx(xe,{data:r,onChange:v,t:y,isRtl:m}),!U&&M&&e.jsxs("div",{className:"bg-slate-50 p-10 rounded-[3rem] border border-slate-100 shadow-inner",children:[e.jsxs("h4",{className:"text-sm font-black text-slate-800 uppercase tracking-widest mb-10 flex items-center gap-3",children:[e.jsx(S,{className:"text-blue-600"})," Generic Telemetry Schema"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:M.requiredFields.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:a.label}),e.jsx("input",{type:a.type==="number"?"number":"text",className:"w-full bg-white border border-slate-200 rounded-2xl px-6 py-4 text-sm font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all shadow-sm",onChange:i=>R(a.name,a.type==="number"?parseFloat(i.target.value):i.target.value)})]},a.name))})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-10 pt-10 border-t border-slate-100",children:[e.jsx("div",{className:"flex-1 flex bg-slate-100 p-1.5 rounded-2xl shadow-inner min-w-[300px]",children:["high","medium","low"].map(a=>e.jsxs("button",{type:"button",onClick:()=>R("confidence",a),className:`flex-1 py-4 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${r.confidence===a?"bg-white text-blue-600 shadow-xl":"text-slate-400 hover:text-slate-600"}`,children:[a," Confidence"]},a))}),e.jsxs("div",{className:"flex gap-6 flex-[2] min-w-full sm:min-w-[400px]",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 py-6 border-2 border-slate-100 rounded-2xl text-[12px] font-black uppercase tracking-[0.2em] text-slate-400 hover:bg-slate-50 transition-all",children:"Discard"}),e.jsx("button",{onClick:()=>J(),disabled:F,className:"flex-[2] py-6 bg-slate-900 text-white rounded-2xl text-[12px] font-black uppercase tracking-[0.2em] shadow-2xl hover:bg-black transition-all flex items-center justify-center gap-4",children:F?e.jsx(W,{size:24,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(V,{size:24})," Commit to Registry"]})})]})]})]})})]})]})})};export{ke as default};
