import{c as V,r as c,j as e,e as Ye,X as Ae,D as kt,d as ue,A as qe,L as se,f as Le,g as wt,B as _e,U as Nt,C as At}from"./index-BlS2-adh.js";import{C as Te}from"./code-BFk5Oc_t.js";import{P as pe}from"./package-DlWeqhoU.js";import{S as Ze}from"./scale-X-Oesm-K.js";import{C as Ct}from"./chart-column-XUqnyj18.js";import{S as St}from"./search-BwBcOq6b.js";import{H as Y}from"./history-Cmaxreuc.js";import{C as It}from"./calendar-jzh-RY2a.js";import{A as zt}from"./arrow-up-right-OQQdAJPS.js";import{P as Et,C as Pt}from"./CycleModal-DpzBmTlS.js";import{T as Ce}from"./trash-2-CXq7EdYc.js";import{T as Mt}from"./trending-up-X983Lwjd.js";import{u as Se,s as Bt,m as Ot,a as Dt,i as Lt,b as be,g as ye,c as ke,d as _t,e as Ke,S as Tt,f as G,h as Kt,j as Wt,k as X,l as Rt,n as U,o as q,p as F,q as Z,r as Xe,t as Je,v as Qe,w as Gt,x as $t,y as We,z as Vt,A as Re,B as Ut,L as me,C as Ft,D as Ht,E as Ie,F as et,R as Yt,G as qt,H as Zt,Z as ze,I as tt,J as Xt,K as Jt,M as Qt,N as ea,O as ta,P as he,Q as aa,T as at,U as sa,V as ra,W as la,X as ia,Y as Ge,_ as st,$ as na,a0 as rt,a1 as oa,a2 as ca,a3 as R,a4 as da,a5 as xa,a6 as pa,a7 as ua,a8 as ma,a9 as $e,aa as ha,ab as fa,ac as ie,ad as ve,ae as ne,af as oe,ag as ce,ah as de,ai as je,aj as ga}from"./AreaChart-DTaJkfl6.js";import ba from"./MovementForm-BMmLmkA6.js";import{C as va}from"./clock-C5NRjOsN.js";import{A as ja}from"./arrow-right-Bf8JONUp.js";import{F as ya}from"./file-text-DXWc4s_U.js";import{P as ka}from"./plus-CtlIzq35.js";import{C as wa}from"./circle-check-l3JID_ZS.js";import{L as Na}from"./layout-grid-DxuinLnq.js";import"./info-CHc_1WZ7.js";import"./droplets-Lpd5qF8J.js";import"./wind-Df6K6pUD.js";import"./thermometer-CBRrmUoz.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],Ca=V("arrow-down-left",Aa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],Ia=V("layout-list",Sa);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Ve=V("lock-open",za);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Pa=V("star",Ea);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],lt=V("table",Ma);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Oa=V("upload",Ba);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],La=V("weight",Da);var it=t=>null;it.displayName="Cell";var nt=(t,a,r)=>{var s=Se();return(n,l)=>x=>{t==null||t(n,l,x),s(Bt({activeIndex:String(l),activeDataKey:a,activeCoordinate:n.tooltipPosition,activeGraphicalItemId:r}))}},ot=t=>{var a=Se();return(r,s)=>n=>{t==null||t(r,s,n),a(Ot())}},ct=(t,a,r)=>{var s=Se();return(n,l)=>x=>{t==null||t(n,l,x),s(Dt({activeIndex:String(l),activeDataKey:a,activeCoordinate:n.tooltipPosition,activeGraphicalItemId:r}))}},Ue=(t,a,r)=>{var s=r??t;if(!be(s))return ye(s,a,0)},_a=(t,a,r)=>{var s={},n=t.filter(Lt),l=t.filter(d=>d.stackId==null),x=n.reduce((d,i)=>{var o=d[i.stackId];return o==null&&(o=[]),o.push(i),d[i.stackId]=o,d},s),p=Object.entries(x).map(d=>{var i,[o,u]=d,y=u.map(g=>g.dataKey),k=Ue(a,r,(i=u[0])===null||i===void 0?void 0:i.barSize);return{stackId:o,dataKeys:y,barSize:k}}),m=l.map(d=>{var i=[d.dataKey].filter(u=>u!=null),o=Ue(a,r,d.barSize);return{stackId:void 0,dataKeys:i,barSize:o}});return[...p,...m]};function Fe(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function xe(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?Fe(Object(r),!0).forEach(function(s){Ta(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ta(t,a,r){return(a=Ka(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function Ka(t){var a=Wa(t,"string");return typeof a=="symbol"?a:a+""}function Wa(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function Ra(t,a,r,s,n){var l,x=s.length;if(!(x<1)){var p=ye(t,r,0,!0),m,d=[];if(ke((l=s[0])===null||l===void 0?void 0:l.barSize)){var i=!1,o=r/x,u=s.reduce((f,b)=>f+(b.barSize||0),0);u+=(x-1)*p,u>=r&&(u-=(x-1)*p,p=0),u>=r&&o>0&&(i=!0,o*=.9,u=x*o);var y=(r-u)/2>>0,k={offset:y-p,size:0};m=s.reduce((f,b)=>{var j,C={stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:k.offset+k.size+p,size:i?o:(j=b.barSize)!==null&&j!==void 0?j:0}},w=[...f,C];return k=C.position,w},d)}else{var g=ye(a,r,0,!0);r-2*g-(x-1)*p<=0&&(p=0);var v=(r-2*g-(x-1)*p)/x;v>1&&(v>>=0);var h=ke(n)?Math.min(v,n):v;m=s.reduce((f,b,j)=>[...f,{stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:g+(v+p)*j+(v-h)/2,size:h}}],d)}return m}}var Ga=(t,a,r,s,n,l,x)=>{var p=be(x)?a:x,m=Ra(r,s,n!==l?n:l,t,p);return n!==l&&m!=null&&(m=m.map(d=>xe(xe({},d),{},{position:xe(xe({},d.position),{},{offset:d.position.offset-n/2})}))),m},$a=(t,a)=>{var r=_t(a);if(!(!t||r==null||a==null)){var{stackId:s}=a;if(s!=null){var n=t[s];if(n){var{stackedData:l}=n;if(l)return l.find(x=>x.key===r)}}}},Va=(t,a)=>{if(!(t==null||a==null)){var r=t.find(s=>s.stackId===a.stackId&&a.dataKey!=null&&s.dataKeys.includes(a.dataKey));if(r!=null)return r.position}};function Ua(t,a){return t&&typeof t=="object"&&"zIndex"in t&&typeof t.zIndex=="number"&&ke(t.zIndex)?t.zIndex:a}var Fa="Invariant failed";function Ha(t,a){throw new Error(Fa)}function we(){return we=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},we.apply(null,arguments)}function fe(t){return c.createElement(Tt,we({shapeType:"rectangle",activeClassName:"recharts-active-bar"},t))}var Ya=function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,n)=>{if(Ke(a))return a;var l=Ke(s)||be(s);return l?a(s,n):(l||Ha(),r)}},qa=(t,a,r)=>r,Za=(t,a)=>a,re=G([Je,Za],(t,a)=>t.filter(r=>r.type==="bar").find(r=>r.id===a)),Xa=G([re],t=>t==null?void 0:t.maxBarSize),Ja=(t,a,r,s)=>s,Qa=G([X,Je,U,F,qa],(t,a,r,s,n)=>a.filter(l=>t==="horizontal"?l.xAxisId===r:l.yAxisId===s).filter(l=>l.isPanorama===n).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),es=(t,a,r)=>{var s=X(t),n=U(t,a),l=F(t,a);if(!(n==null||l==null))return s==="horizontal"?We(t,"yAxis",l,r):We(t,"xAxis",n,r)},ts=(t,a)=>{var r=X(t),s=U(t,a),n=F(t,a);if(!(s==null||n==null))return r==="horizontal"?Re(t,"xAxis",s):Re(t,"yAxis",n)},as=G([Qa,Vt,ts],_a),ss=(t,a,r)=>{var s,n,l=re(t,a);if(l==null)return 0;var x=U(t,a),p=F(t,a);if(x==null||p==null)return 0;var m=X(t),d=Qe(t),{maxBarSize:i}=l,o=be(i)?d:i,u,y;return m==="horizontal"?(u=q(t,"xAxis",x,r),y=Z(t,"xAxis",x,r)):(u=q(t,"yAxis",p,r),y=Z(t,"yAxis",p,r)),(s=(n=Xe(u,y,!0))!==null&&n!==void 0?n:o)!==null&&s!==void 0?s:0},dt=(t,a,r)=>{var s=X(t),n=U(t,a),l=F(t,a);if(!(n==null||l==null)){var x,p;return s==="horizontal"?(x=q(t,"xAxis",n,r),p=Z(t,"xAxis",n,r)):(x=q(t,"yAxis",l,r),p=Z(t,"yAxis",l,r)),Xe(x,p)}},rs=G([as,Qe,Gt,$t,ss,dt,Xa],Ga),ls=(t,a,r)=>{var s=U(t,a);if(s!=null)return q(t,"xAxis",s,r)},is=(t,a,r)=>{var s=F(t,a);if(s!=null)return q(t,"yAxis",s,r)},ns=(t,a,r)=>{var s=U(t,a);if(s!=null)return Z(t,"xAxis",s,r)},os=(t,a,r)=>{var s=F(t,a);if(s!=null)return Z(t,"yAxis",s,r)},cs=G([rs,re],Va),ds=G([es,re],$a),xs=G([Kt,Wt,ls,is,ns,os,cs,X,Rt,dt,ds,re,Ja],(t,a,r,s,n,l,x,p,m,d,i,o,u)=>{var{chartData:y,dataStartIndex:k,dataEndIndex:g}=m;if(!(o==null||x==null||a==null||p!=="horizontal"&&p!=="vertical"||r==null||s==null||n==null||l==null||d==null)){var{data:v}=o,h;if(v!=null&&v.length>0?h=v:h=y==null?void 0:y.slice(k,g+1),h!=null)return Ks({layout:p,barSettings:o,pos:x,parentViewBox:a,bandSize:d,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:l,stackedData:i,displayedData:h,offset:t,cells:u,dataStartIndex:k})}}),ps=["index"];function Ne(){return Ne=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ne.apply(null,arguments)}function us(t,a){if(t==null)return{};var r,s,n=ms(t,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(s=0;s<l.length;s++)r=l[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ms(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var xt=c.createContext(void 0),hs=t=>{var a=c.useContext(xt);if(a!=null)return a.stackId;if(t!=null)return Ut(t)},fs=(t,a)=>"recharts-bar-stack-clip-path-".concat(t,"-").concat(a),gs=t=>{var a=c.useContext(xt);if(a!=null){var{stackId:r}=a;return"url(#".concat(fs(r,t),")")}},pt=t=>{var{index:a}=t,r=us(t,ps),s=gs(a);return c.createElement(me,Ne({className:"recharts-bar-stack-layer",clipPath:s},r))},bs=["onMouseEnter","onMouseLeave","onClick"],vs=["value","background","tooltipPosition"],js=["id"],ys=["onMouseEnter","onClick","onMouseLeave"];function T(){return T=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},T.apply(null,arguments)}function He(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function O(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?He(Object(r),!0).forEach(function(s){ks(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ks(t,a,r){return(a=ws(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function ws(t){var a=Ns(t,"string");return typeof a=="symbol"?a:a+""}function Ns(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function ge(t,a){if(t==null)return{};var r,s,n=As(t,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(s=0;s<l.length;s++)r=l[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function As(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}var Cs=t=>{var{dataKey:a,name:r,fill:s,legendType:n,hide:l}=t;return[{inactive:l,dataKey:a,type:n,color:s,value:tt(r,a),payload:t}]},Ss=c.memo(t=>{var{dataKey:a,stroke:r,strokeWidth:s,fill:n,name:l,hide:x,unit:p,tooltipType:m,id:d}=t,i={dataDefinedOnItem:void 0,getPosition:Jt,settings:{stroke:r,strokeWidth:s,fill:n,dataKey:a,nameKey:void 0,name:tt(l,a),hide:x,type:m,color:n,unit:p,graphicalItemId:d}};return c.createElement(Xt,{tooltipEntrySettings:i})});function Is(t){var a=he(st),{data:r,dataKey:s,background:n,allOtherBarProps:l}=t,{onMouseEnter:x,onMouseLeave:p,onClick:m}=l,d=ge(l,bs),i=nt(x,s,l.id),o=ot(p),u=ct(m,s,l.id);if(!n||r==null)return null;var y=na(n);return c.createElement(ze,{zIndex:Ua(n,Ie.barBackground)},r.map((k,g)=>{var{value:v,background:h,tooltipPosition:f}=k,b=ge(k,vs);if(!h)return null;var j=i(k,g),C=o(k,g),w=u(k,g),P=O(O(O(O(O({option:n,isActive:String(g)===a},b),{},{fill:"#eee"},h),y),rt(d,k,g)),{},{onMouseEnter:j,onMouseLeave:C,onClick:w,dataKey:s,index:g,className:"recharts-bar-background-rectangle"});return c.createElement(fe,T({key:"background-bar-".concat(g)},P))}))}function zs(t){var{showLabels:a,children:r,rects:s}=t,n=s==null?void 0:s.map(l=>{var x={x:l.x,y:l.y,width:l.width,lowerWidth:l.width,upperWidth:l.width,height:l.height};return O(O({},x),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:x,fill:l.fill})});return c.createElement(xa,{value:a?n:void 0},r)}function Es(t){var{shape:a,activeBar:r,baseProps:s,entry:n,index:l,dataKey:x}=t,p=he(st),m=he(ua),d=r&&String(l)===p&&(m==null||x===m),i=d?r:a;return d?c.createElement(ze,{zIndex:Ie.activeBar},c.createElement(pt,{index:l},c.createElement(fe,T({},s,{name:String(s.name)},n,{isActive:d,option:i,index:l,dataKey:x})))):c.createElement(fe,T({},s,{name:String(s.name)},n,{isActive:d,option:i,index:l,dataKey:x}))}function Ps(t){var{shape:a,baseProps:r,entry:s,index:n,dataKey:l}=t;return c.createElement(fe,T({},r,{name:String(r.name)},s,{isActive:!1,option:a,index:n,dataKey:l}))}function Ms(t){var a,{data:r,props:s}=t,n=(a=pa(s))!==null&&a!==void 0?a:{},{id:l}=n,x=ge(n,js),{shape:p,dataKey:m,activeBar:d}=s,{onMouseEnter:i,onClick:o,onMouseLeave:u}=s,y=ge(s,ys),k=nt(i,m,l),g=ot(u),v=ct(o,m,l);return r?c.createElement(c.Fragment,null,r.map((h,f)=>c.createElement(pt,T({index:f,key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f),className:"recharts-bar-rectangle"},rt(y,h,f),{onMouseEnter:k(h,f),onMouseLeave:g(h,f),onClick:v(h,f)}),d?c.createElement(Es,{shape:p,activeBar:d,baseProps:x,entry:h,index:f,dataKey:m}):c.createElement(Ps,{shape:p,baseProps:x,entry:h,index:f,dataKey:m})))):null}function Bs(t){var{props:a,previousRectanglesRef:r}=t,{data:s,layout:n,isAnimationActive:l,animationBegin:x,animationDuration:p,animationEasing:m,onAnimationEnd:d,onAnimationStart:i}=a,o=r.current,u=oa(a,"recharts-bar-"),[y,k]=c.useState(!1),g=!y,v=c.useCallback(()=>{typeof d=="function"&&d(),k(!1)},[d]),h=c.useCallback(()=>{typeof i=="function"&&i(),k(!0)},[i]);return c.createElement(zs,{showLabels:g,rects:s},c.createElement(ca,{animationId:u,begin:x,duration:p,isActive:l,easing:m,onAnimationEnd:v,onAnimationStart:h,key:u},f=>{var b=f===1?s:s==null?void 0:s.map((j,C)=>{var w=o&&o[C];if(w)return O(O({},j),{},{x:R(w.x,j.x,f),y:R(w.y,j.y,f),width:R(w.width,j.width,f),height:R(w.height,j.height,f)});if(n==="horizontal"){var P=R(0,j.height,f),M=R(j.stackedBarStart,j.y,f);return O(O({},j),{},{y:M,height:P})}var I=R(0,j.width,f),A=R(j.stackedBarStart,j.x,f);return O(O({},j),{},{width:I,x:A})});return f>0&&(r.current=b??null),b==null?null:c.createElement(me,null,c.createElement(Ms,{props:a,data:b}))}),c.createElement(da,{label:a.label}),a.children)}function Os(t){var a=c.useRef(null);return c.createElement(Bs,{previousRectanglesRef:a,props:t})}var ut=0,Ds=(t,a)=>{var r=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:r,errorVal:at(t,a)}};class Ls extends c.PureComponent{render(){var{hide:a,data:r,dataKey:s,className:n,xAxisId:l,yAxisId:x,needClip:p,background:m,id:d}=this.props;if(a||r==null)return null;var i=sa("recharts-bar",n),o=d;return c.createElement(me,{className:i,id:d},p&&c.createElement("defs",null,c.createElement(ra,{clipPathId:o,xAxisId:l,yAxisId:x})),c.createElement(me,{className:"recharts-bar-rectangles",clipPath:p?"url(#clipPath-".concat(o,")"):void 0},c.createElement(Is,{data:r,dataKey:s,background:m,allOtherBarProps:this.props}),c.createElement(Os,this.props)))}}var _s={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:ut,xAxisId:0,yAxisId:0,zIndex:Ie.bar};function Ts(t){var{xAxisId:a,yAxisId:r,hide:s,legendType:n,minPointSize:l,activeBar:x,animationBegin:p,animationDuration:m,animationEasing:d,isAnimationActive:i}=t,{needClip:o}=Qt(a,r),u=ea(),y=et(),k=ta(t.children,it),g=he(f=>xs(f,t.id,y,k));if(u!=="vertical"&&u!=="horizontal")return null;var v,h=g==null?void 0:g[0];return h==null||h.height==null||h.width==null?v=0:v=u==="vertical"?h.height/2:h.width/2,c.createElement(aa,{xAxisId:a,yAxisId:r,data:g,dataPointFormatter:Ds,errorBarOffset:v},c.createElement(Ls,T({},t,{layout:u,needClip:o,data:g,xAxisId:a,yAxisId:r,hide:s,legendType:n,minPointSize:l,activeBar:x,animationBegin:p,animationDuration:m,animationEasing:d,isAnimationActive:i})))}function Ks(t){var{layout:a,barSettings:{dataKey:r,minPointSize:s},pos:n,bandSize:l,xAxis:x,yAxis:p,xAxisTicks:m,yAxisTicks:d,stackedData:i,displayedData:o,offset:u,cells:y,parentViewBox:k,dataStartIndex:g}=t,v=a==="horizontal"?p:x,h=i?v.scale.domain():null,f=la({numericAxis:v}),b=v.scale.map(f);return o.map((j,C)=>{var w,P,M,I,A,D;if(i){var L=i[C+g];if(L==null)return null;w=ia(L,h)}else w=at(j,r),Array.isArray(w)||(w=[f,w]);var E=Ya(s,ut)(w[1],C);if(a==="horizontal"){var K,W=p.scale.map(w[0]),_=p.scale.map(w[1]);if(W==null||_==null)return null;P=Ge({axis:x,ticks:m,bandSize:l,offset:n.offset,entry:j,index:C}),M=(K=_??W)!==null&&K!==void 0?K:void 0,I=n.size;var J=W-_;if(A=ma(J)?0:J,D={x:P,y:u.top,width:I,height:u.height},Math.abs(E)>0&&Math.abs(A)<Math.abs(E)){var Q=$e(A||E)*(Math.abs(E)-Math.abs(A));M-=Q,A+=Q}}else{var H=x.scale.map(w[0]),ee=x.scale.map(w[1]);if(H==null||ee==null)return null;if(P=H,M=Ge({axis:p,ticks:d,bandSize:l,offset:n.offset,entry:j,index:C}),I=ee-H,A=n.size,D={x:u.left,y:M,width:u.width,height:A},Math.abs(E)>0&&Math.abs(I)<Math.abs(E)){var te=$e(I||E)*(Math.abs(E)-Math.abs(I));I+=te}}if(P==null||M==null||I==null||A==null)return null;var ae=O(O({},j),{},{stackedBarStart:b,x:P,y:M,width:I,height:A,value:i?w:w[1],payload:j,background:D,tooltipPosition:{x:P+I/2,y:M+A/2},parentViewBox:k},y&&y[C]&&y[C].props);return ae}).filter(Boolean)}function Ws(t){var a=Ht(t,_s),r=hs(a.stackId),s=et();return c.createElement(Yt,{id:a.id,type:"bar"},n=>c.createElement(c.Fragment,null,c.createElement(qt,{legendPayload:Cs(a)}),c.createElement(Ss,{dataKey:a.dataKey,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType,id:n}),c.createElement(Zt,{type:"bar",id:n,data:void 0,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,stackId:r,hide:a.hide,barSize:a.barSize,minPointSize:a.minPointSize,maxBarSize:a.maxBarSize,isPanorama:s}),c.createElement(ze,{zIndex:a.zIndex},c.createElement(Ts,T({},a,{id:n})))))}var mt=c.memo(Ws,Ft);mt.displayName="Bar";var Rs=["axis","item"],Gs=c.forwardRef((t,a)=>c.createElement(ha,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Rs,tooltipPayloadSearcher:fa,categoricalChartProps:t,ref:a}));const $s=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col overflow-hidden animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(Ye,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter",children:"Unified Movement Registry API"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mt-1",children:"Endpoint: /flocks/:flockId/cycles/:cycleId/movements"})]})]}),e.jsx("button",{onClick:t,className:"p-3 bg-slate-100 hover:bg-rose-50 hover:text-rose-500 text-slate-400 rounded-2xl transition-all shadow-sm",children:e.jsx(Ae,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-10 space-y-12 no-scrollbar",children:[e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(kt,{className:"text-blue-500",size:24}),e.jsx("h3",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"Core Schemas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-blue-400 mb-6 flex items-center gap-2",children:[e.jsx(Te,{size:12})," BIRD INFLOW (in)"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-blue-300 leading-relaxed overflow-x-auto",children:`{
  "type": "in",
  "reason": "purchase",
  "birdMetrics": {
    "count": 5000,
    "ageAtMovement": 4,
    "breed": "Lohmann Brown"
  },
  "weightMetrics": {
    "startWeightGrams": 1200
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-amber-400 mb-6 flex items-center gap-2",children:[e.jsx(pe,{size:12})," RESOURCE INTAKE (feed)"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-amber-300 leading-relaxed overflow-x-auto",children:`{
  "type": "feed",
  "date": "2024-03-20T10:00:00Z",
  "feedMetrics": {
    "consumedKg": 350,
    "purchasedKg": 1000,
    "feedType": "Starter",
    "supplier": "Cargill Node 4"
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-emerald-400 mb-6 flex items-center gap-2",children:[e.jsx(Te,{size:12})," EGG COLLECTION"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-emerald-300 leading-relaxed overflow-x-auto",children:`{
  "type": "egg_collection",
  "reason": "daily_collection",
  "eggMetrics": {
    "count": 4850,
    "totalWeightKg": 291
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-900 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-indigo-400 mb-6 flex items-center gap-2",children:[e.jsx(La,{size:12})," MASS SAMPLE (weight)"]}),e.jsx("div",{className:"bg-black/30 p-5 rounded-2xl text-[11px] font-mono text-indigo-300 leading-relaxed overflow-x-auto",children:`{
  "type": "weight",
  "weightMetrics": {
    "averageWeightGrams": 1890,
    "startWeightGrams": 1850,
    "endWeightGrams": 1920,
    "measurementMethod": "scale"
  }
}`})]}),e.jsxs("div",{className:"p-8 bg-slate-50 rounded-[2.5rem] border border-slate-200",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-slate-500 mb-6 flex items-center gap-2",children:[e.jsx(Ze,{size:12})," MANUAL ADJUSTMENT"]}),e.jsx("div",{className:"bg-white p-5 rounded-2xl text-[11px] font-mono text-slate-700 leading-relaxed border border-slate-100 shadow-inner",children:`{
  "type": "adjustment",
  "reason": "inspection",
  "birdMetrics": {
    "count": -2
  },
  "notes": "Physical audit correction"
}`})]}),e.jsxs("div",{className:"p-8 bg-rose-50 rounded-[2.5rem] border border-rose-100",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-rose-500 mb-6 flex items-center gap-2",children:[e.jsx(ue,{size:12})," MORTALITY EVENT"]}),e.jsx("div",{className:"bg-white p-5 rounded-2xl text-[11px] font-mono text-rose-700 leading-relaxed border border-rose-100 shadow-inner",children:`{
  "type": "mortality",
  "reason": "disease",
  "mortalityMetrics": {
    "count": 3
  },
  "notes": "Respiratory infection"
}`})]})]})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-[2.5rem] p-8 flex items-center gap-8 shadow-sm",children:[e.jsx(ue,{size:48,className:"text-amber-600 shrink-0"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-black text-amber-900 uppercase tracking-tight",children:"Security & Immutability"}),e.jsxs("p",{className:"text-[11px] font-medium text-amber-800 leading-relaxed",children:["All records once committed are assigned a ",e.jsx("code",{className:"bg-amber-200 p-0.5 rounded",children:"NODE_ID"})," and entered into the audit trail. Deletion requires an explicit ",e.jsx("code",{className:"bg-amber-200 p-0.5 rounded",children:"permanent=true"})," flag and high-level clearance."]})]})]})]}),e.jsx("div",{className:"p-8 border-t border-slate-100 flex justify-end bg-white",children:e.jsx("button",{onClick:t,className:"px-10 py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] shadow-xl hover:bg-black transition-all",children:"Close Documentation"})})]})}),Vs=({currentCycle:t,movementsCount:a,flockName:r,selectedCycleId:s,formatDate:n})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4 animate-in slide-in-from-top-4 duration-700",children:[e.jsxs("div",{className:"bg-slate-900 rounded-2xl lg:rounded-3xl p-4 lg:p-6 text-white border border-white/5 shadow-xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 group-hover:scale-110 transition-transform duration-1000",children:e.jsx(qe,{size:60})}),e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-500 uppercase tracking-widest mb-1",children:"Cycle Integrity"}),e.jsx("h4",{className:"text-xl lg:text-2xl font-black tracking-tighter uppercase",children:(t==null?void 0:t.status)||"N/A"}),e.jsxs("div",{className:"mt-2 lg:mt-3 flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${(t==null?void 0:t.status)==="active"?"bg-emerald-500 animate-pulse":"bg-slate-500"}`}),e.jsxs("span",{className:"text-[9px] lg:text-[10px] font-bold text-slate-400",children:["Since ",t?n(t.startDate):"---"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm group",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Total Logs"}),e.jsx("h4",{className:"text-2xl lg:text-3xl font-black text-slate-900 tabular-nums",children:a}),e.jsxs("p",{className:"text-[9px] lg:text-[10px] font-bold text-blue-600 mt-1 lg:mt-2",children:["ID: ",s]})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Production Node"}),e.jsx("h4",{className:"text-xl lg:text-2xl font-black text-slate-900 uppercase truncate",children:r||"---"}),e.jsx("p",{className:"text-[9px] lg:text-[10px] font-bold text-slate-400 mt-1 lg:mt-2 uppercase tracking-widest",children:"Fleet Active"})]}),e.jsxs("div",{className:"bg-white rounded-2xl lg:rounded-3xl p-4 lg:p-6 border border-slate-200 shadow-sm flex flex-col justify-between",children:[e.jsx("p",{className:"text-[8px] lg:text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"System Health"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs lg:text-sm font-black text-slate-800 font-mono uppercase",children:"Nominal"}),e.jsx(ue,{size:18,className:"text-emerald-500"})]})]})]}),Us=({viewMode:t,setViewMode:a,searchTerm:r,setSearchTerm:s,selectedCycleId:n,onCycleChange:l,cycles:x,loadingCycles:p,onShowDocs:m,isRtl:d,t:i})=>e.jsx("div",{className:"p-4 lg:p-8 border-b border-slate-100 bg-slate-50/30",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-4",children:[e.jsxs("div",{className:"flex bg-white border border-slate-200 p-1 rounded-xl shadow-sm",children:[e.jsxs("button",{onClick:()=>a("list"),className:`flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all ${t==="list"?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:[e.jsx(Ia,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"List"})]}),e.jsxs("button",{onClick:()=>a("visual"),className:`flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all ${t==="visual"?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:[e.jsx(Ct,{size:16}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Visual"})]})]}),e.jsxs("div",{className:"relative group flex-1",children:[e.jsx(St,{className:`absolute ${d?"right-4":"left-4"} top-1/2 -translate-y-1/2 text-slate-400`,size:16}),e.jsx("input",{type:"text",placeholder:d?"جستجوی فید داده...":"Search stream...",className:`w-full ${d?"pr-10":"pl-10"} py-2.5 bg-white border border-slate-200 rounded-xl text-xs font-bold shadow-sm focus:ring-4 focus:ring-blue-500/10 outline-none`,value:r,onChange:o=>s(o.target.value)})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-white border border-slate-200 rounded-xl px-3 py-1.5 shadow-sm gap-2 h-[42px] flex-1 min-w-[200px]",children:[e.jsx(Y,{size:14,className:"text-slate-400 shrink-0"}),e.jsxs("select",{value:n,onChange:o=>l(o.target.value),className:"bg-transparent border-none text-[9px] font-black uppercase tracking-widest text-slate-700 outline-none cursor-pointer w-full",children:[e.jsx("option",{value:"",children:p?i.loading:i.selectCycle}),x.map(o=>e.jsxs("option",{value:o.cycleId,children:[o.cycleId," ",o.status==="active"?"• ACT":""]},o.cycleId))]}),p&&e.jsx(se,{size:12,className:"animate-spin text-blue-500 shrink-0"})]}),e.jsxs("button",{onClick:m,className:"h-[42px] px-6 py-2 bg-white border border-slate-200 text-slate-600 rounded-xl hover:bg-slate-50 transition-all flex items-center justify-center gap-2 text-[9px] font-black uppercase tracking-widest shadow-sm ml-auto",children:[e.jsx(Ye,{size:14})," ",i.reference]})]})]})}),Fs=({level:t})=>{const a=t==="high"?3:t==="medium"?2:1;return e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"flex items-center gap-0.5 text-amber-400",children:[...Array(3)].map((r,s)=>e.jsx(Pa,{size:10,fill:s<a?"currentColor":"none",className:s<a?"":"text-slate-200"},s))}),e.jsx("span",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest",children:t})]})},Hs=({movements:t,formatDate:a,onEdit:r,onDelete:s,onLock:n,onUnlock:l,onViewHistory:x})=>{const p=i=>{var u,y,k,g,v,h,f,b,j,C,w;switch(i.type.toLowerCase()){case"bird_inflow":case"in":case"bird_outflow":case"out":case"adjustment":case"sale":return((u=i.birdMetrics)==null?void 0:u.count)??0;case"mortality":return((y=i.mortalityMetrics)==null?void 0:y.count)??((k=i.birdMetrics)==null?void 0:k.count)??0;case"egg_collection":case"egg_breakage":return((g=i.eggMetrics)==null?void 0:g.count)??0;case"weight_measurement":case"weight":return((v=i.weightMetrics)==null?void 0:v.currentWeightGrams)??((h=i.weightMetrics)==null?void 0:h.averageWeightGrams)??((f=i.weightMetrics)==null?void 0:f.grams)??((b=i.weightMetrics)==null?void 0:b.startWeightGrams)??((j=i.weightMetrics)==null?void 0:j.endWeightGrams)??0;case"feed_consumption":case"feed":return((C=i.feedMetrics)==null?void 0:C.consumedKg)??((w=i.feedMetrics)==null?void 0:w.purchasedKg)??0;default:return 0}},m=i=>{switch(i.type.toLowerCase()){case"bird_inflow":case"in":case"bird_outflow":case"out":case"mortality":case"sale":case"adjustment":return"Birds";case"egg_collection":case"egg_breakage":return"Eggs";case"weight_measurement":case"weight":return"Grams";case"feed_consumption":case"feed":return"KG";default:return""}},d=i=>{const o=i.type.toLowerCase();return o==="in"?"Bird Inflow":o==="out"?"Bird Outflow":o==="weight"?"Mass Sample":o==="feed"?"Resource Intake":i.type.replace(/_/g," ")};return e.jsx("div",{className:"overflow-x-auto no-scrollbar",children:e.jsxs("table",{className:"w-full text-left text-sm border-collapse min-w-[1100px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/80 text-slate-400 font-black border-b border-slate-200 uppercase tracking-[0.2em] text-[9px] lg:text-[10px]",children:[e.jsx("th",{className:"px-6 py-4 w-20 text-center",children:"Vector"}),e.jsx("th",{className:"px-6 py-4",children:"Event Time"}),e.jsx("th",{className:"px-6 py-4",children:"Type / Reason"}),e.jsx("th",{className:"px-6 py-4",children:"Quantity"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Consensus"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50 bg-white",children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"py-24 text-center opacity-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(It,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em]",children:"Registry Empty"})]})})}):t.map(i=>{var o;return e.jsxs("tr",{className:`hover:bg-blue-50/10 transition-all group ${i.locked?"bg-slate-50/30":""}`,children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:`w-10 h-10 mx-auto rounded-xl flex items-center justify-center transition-transform group-hover:scale-110 ${i.type==="bird_inflow"||i.type==="in"||i.type==="egg_collection"?"bg-emerald-50 text-emerald-600":i.type==="mortality"||i.type==="egg_breakage"||i.type==="bird_outflow"||i.type==="out"?"bg-rose-50 text-rose-600":i.type==="weight"||i.type==="weight_measurement"?"bg-blue-50 text-blue-600":i.type==="feed"||i.type==="feed_consumption"?"bg-amber-50 text-amber-600":"bg-slate-50 text-slate-500"}`,children:i.type==="bird_inflow"||i.type==="in"||i.type==="egg_collection"?e.jsx(Ca,{size:18}):e.jsx(zt,{size:18})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-xs font-black text-slate-900",children:a(i.date)}),e.jsxs("div",{className:"text-[8px] font-bold text-slate-400 uppercase tracking-widest mt-0.5 font-mono",children:["NODE ID: ",i._id.slice(-6).toUpperCase()]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"px-2 py-0.5 bg-slate-900 text-white rounded text-[7px] font-black uppercase tracking-widest self-start",children:d(i)}),e.jsx("span",{className:"text-[9px] font-bold text-slate-500 uppercase tracking-tight ml-1",children:((o=i.reason)==null?void 0:o.replace(/_/g," "))||"standard"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-end gap-1",children:[e.jsx("span",{className:"text-base font-black text-slate-900 tabular-nums",children:p(i).toLocaleString()}),e.jsx("span",{className:"text-[8px] font-bold text-slate-400 uppercase mb-1",children:m(i)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Fs,{level:i.confidence})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border ${i.locked?"bg-amber-50 text-amber-600 border-amber-100":"bg-emerald-50 text-emerald-600 border-emerald-100"}`,children:i.locked?e.jsxs(e.Fragment,{children:[e.jsx(Le,{size:10})," Locked"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{size:10})," Editable"]})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>x(i),className:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all",title:"View Audit Trail",children:e.jsx(Y,{size:16})}),!i.locked&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>r(i),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Edit Metrics",children:e.jsx(Et,{size:16})}),e.jsx("button",{onClick:()=>s(i),className:"p-2 text-rose-600 hover:bg-rose-50 rounded-lg transition-all",title:"Soft Delete",children:e.jsx(Ce,{size:16})})]}),e.jsx("button",{onClick:()=>i.locked?l(i):n(i),className:`p-2 rounded-lg transition-all ${i.locked?"text-amber-600 hover:bg-amber-50":"text-slate-400 hover:text-amber-600 hover:bg-amber-50"}`,title:i.locked?"Request Unlock":"Verify & Lock",children:i.locked?e.jsx(Le,{size:16}):e.jsx(Ve,{size:16})})]})})]},i._id)})})]})})},Ys=({loading:t,data:a})=>{if(t)return e.jsxs("div",{className:"h-[400px] flex flex-col items-center justify-center gap-4 opacity-40",children:[e.jsx(se,{size:32,className:"animate-spin text-blue-600"}),e.jsx("p",{className:"text-[9px] font-black uppercase tracking-[0.4em]",children:"Compiling Analytics..."})]});const r=a.weights&&a.weights.length>0,s=a.eggs&&a.eggs.length>0,n=a.feed&&a.feed.length>0,l=a.birdBalance&&a.birdBalance.length>0,x=m=>{switch(m){case"in":return"#10b981";case"mortality":return"#ef4444";case"sale":case"out":return"#f59e0b";default:return"#6366f1"}},p=({active:m,payload:d,label:i})=>{if(m&&d&&d.length){const o=d[0].payload;return e.jsxs("div",{className:"bg-slate-900 border border-white/10 p-4 rounded-2xl shadow-2xl en-text",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2",children:new Date(o.date).toLocaleDateString()}),d.map((u,y)=>e.jsxs("div",{className:"flex items-center gap-3 mb-1 last:mb-0",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:u.color||u.fill||u.stroke}}),e.jsxs("p",{className:"text-[11px] font-black text-white uppercase tracking-tight en-text",children:[u.name||u.dataKey,": ",e.jsx("span",{className:"text-blue-400",children:u.value.toLocaleString()})]})]},y)),o.type&&e.jsxs("p",{className:`mt-2 text-[9px] font-black uppercase tracking-widest px-2 py-0.5 rounded text-center en-text ${o.type==="mortality"?"bg-rose-500/20 text-rose-400":o.type==="in"?"bg-emerald-500/20 text-emerald-400":"bg-blue-500/20 text-blue-400"}`,children:["EVENT: ",o.type]})]})}return null};return e.jsx("div",{className:"p-6 lg:p-14 space-y-8 lg:space-y-14 animate-in fade-in duration-700",children:e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2.5rem] p-8 lg:p-10 shadow-sm group min-h-[450px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-2xl group-hover:rotate-6 transition-transform shadow-sm",children:e.jsx(Ze,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase tracking-tight",children:"Mass Velocity"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:"Weight Progression (Grams)"})]})]}),e.jsx(Mt,{size:24,className:"text-emerald-500"})]}),e.jsx("div",{className:"flex-1 min-h-[300px] w-full relative",children:r?e.jsx(ie,{width:"100%",height:"100%",children:e.jsxs(ve,{data:a.weights,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"massCurve",x1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.15}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]})}),e.jsx(ne,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(oe,{dataKey:"date",hide:!0}),e.jsx(ce,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94a3b8"},domain:["auto","auto"]}),e.jsx(de,{content:e.jsx(p,{})}),e.jsx(je,{type:"monotone",dataKey:"grams",name:"Weight",stroke:"#3b82f6",strokeWidth:4,fillOpacity:1,fill:"url(#massCurve)",animationDuration:1e3})]})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 gap-4 opacity-40",children:[e.jsx(Y,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Awaiting Historical Mass Samples"})]})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2.5rem] p-8 lg:p-10 shadow-sm group min-h-[450px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-50 text-emerald-600 rounded-2xl group-hover:scale-110 transition-transform shadow-sm",children:e.jsx(wt,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase tracking-tight",children:"Egg Collection Volume"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:"Total Daily Yield (Count)"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 rounded-xl border border-emerald-100",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),e.jsx("span",{className:"text-[10px] font-black uppercase text-emerald-600 tracking-widest",children:"Total Yield"})]})})]}),e.jsx("div",{className:"flex-1 min-h-[300px] w-full relative",children:s?e.jsx(ie,{width:"100%",height:"100%",children:e.jsxs(Gs,{data:a.eggs,margin:{top:10,right:10,left:-20,bottom:0},barGap:0,children:[e.jsx(ne,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(oe,{dataKey:"date",hide:!0}),e.jsx(ce,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94a3b8"},domain:["auto","auto"]}),e.jsx(de,{content:e.jsx(p,{})}),e.jsx(mt,{dataKey:"count",name:"Total Eggs",fill:"#10b981",radius:[8,8,0,0],barSize:42,animationDuration:1e3}),e.jsx(ga,{type:"monotone",dataKey:"broken",name:"Broken",stroke:"#ef4444",strokeWidth:2,strokeDasharray:"5 5",dot:!1})]})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 gap-4 opacity-40",children:[e.jsx(Y,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Awaiting Yield Ingestion"})]})})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2.5rem] p-8 lg:p-10 shadow-sm group min-h-[480px] flex flex-col xl:col-span-2 overflow-hidden relative",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-6 shrink-0 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-slate-900 text-white rounded-2xl group-hover:rotate-3 transition-transform shadow-lg",children:e.jsx(_e,{size:24})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase tracking-tight",children:"Chicken Balances"}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:"Live Census Tracking & Discrete Events"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),e.jsx("span",{className:"text-[9px] font-black uppercase text-slate-500 tracking-tight en-text",children:"In"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-rose-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.5)]"}),e.jsx("span",{className:"text-[9px] font-black uppercase text-slate-500 tracking-tight en-text",children:"Loss"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 rounded-xl border border-slate-100",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full shadow-[0_0_8px_rgba(245,158,11,0.5)]"}),e.jsx("span",{className:"text-[9px] font-black uppercase text-slate-500 tracking-tight en-text",children:"Out"})]})]})]}),e.jsx("div",{className:"flex-1 min-h-[320px] w-full relative z-10",children:l?e.jsx(ie,{width:"100%",height:"100%",children:e.jsxs(ve,{data:a.birdBalance,margin:{top:20,right:20,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"popGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#0f172a",stopOpacity:.08}),e.jsx("stop",{offset:"95%",stopColor:"#0f172a",stopOpacity:0})]})}),e.jsx(ne,{strokeDasharray:"3 3",vertical:!0,stroke:"#f1f5f9"}),e.jsx(oe,{dataKey:"date",hide:!0}),e.jsx(ce,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94a3b8"},domain:["dataMin - 100","dataMax + 100"]}),e.jsx(de,{content:e.jsx(p,{})}),e.jsx(je,{type:"monotone",dataKey:"liveBirds",name:"Fleet Population",stroke:"#0f172a",strokeWidth:4,fill:"url(#popGrad)",fillOpacity:1,animationDuration:1500,dot:m=>{const{cx:d,cy:i,payload:o}=m;return o.type?e.jsxs("g",{children:[e.jsx("circle",{cx:d,cy:i,r:8,fill:x(o.type),opacity:.2}),e.jsx("circle",{cx:d,cy:i,r:4.5,fill:x(o.type),stroke:"white",strokeWidth:2,className:"filter drop-shadow-md"})]},`event-${o.date}`):null},activeDot:{r:6,strokeWidth:0}})]})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 gap-4 opacity-40",children:[e.jsx(_e,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Awaiting Census Data"})]})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-slate-50 flex items-center justify-between text-[9px] font-black text-slate-400 uppercase tracking-widest shrink-0 relative z-10 en-text",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(ue,{size:12,className:"text-emerald-500"})," Ledger Verified"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(Y,{size:12})," Sync: Active"]})]}),e.jsx("span",{children:"Protocol: CENSUS-V4.2"})]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-[2.5rem] lg:rounded-[3.5rem] p-8 lg:p-12 xl:col-span-2 shadow-2xl relative overflow-hidden min-h-[450px] flex flex-col",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 text-white",children:e.jsx(pe,{size:120})}),e.jsxs("div",{className:"flex items-center gap-5 mb-10 relative z-10 shrink-0",children:[e.jsx("div",{className:"p-4 bg-white/10 text-white rounded-2xl shadow-lg border border-white/5",children:e.jsx(pe,{size:32})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-2xl font-black text-white uppercase tracking-tighter",children:"Resource Drain Matrix"}),e.jsx("p",{className:"text-[9px] font-black text-slate-500 uppercase tracking-[0.4em] mt-1",children:"Consolidated Feed Withdrawal (KG)"})]})]}),e.jsx("div",{className:"flex-1 min-h-[300px] relative z-10 w-full",children:n?e.jsx(ie,{width:"100%",height:"100%",children:e.jsxs(ve,{data:a.feed,margin:{top:10,right:10,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"feedGrad",x1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#fbbf24",stopOpacity:.2}),e.jsx("stop",{offset:"95%",stopColor:"#fbbf24",stopOpacity:0})]})}),e.jsx(ne,{strokeDasharray:"3 3",vertical:!1,stroke:"#ffffff10"}),e.jsx(oe,{dataKey:"date",hide:!0}),e.jsx(ce,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#64748b"}}),e.jsx(de,{contentStyle:{backgroundColor:"#0f172a",borderRadius:"16px",border:"1px solid #1e293b",color:"white"},itemStyle:{color:"#fbbf24",fontWeight:900}}),e.jsx(je,{type:"stepAfter",dataKey:"consumedKg",name:"Feed Intake",stroke:"#fbbf24",strokeWidth:4,fill:"url(#feedGrad)",animationDuration:1e3})]})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-700 gap-4 opacity-40",children:[e.jsx(pe,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Awaiting Resource Ingestion Stream"})]})})]})]})})},qs=({movement:t,flockId:a,onClose:r,api:s})=>{const[n,l]=c.useState([]),[x,p]=c.useState(!0);c.useEffect(()=>{(async()=>{try{const i=t.flockId||a;if(!i||i==="all"){l([]),p(!1);return}const o=await s.getMovementHistory(i,t.cycleId,t._id);let u=[];o&&Array.isArray(o.history)?u=o.history:o&&Array.isArray(o.data)?u=o.data:Array.isArray(o)&&(u=o),l(u)}catch(i){console.error("Audit history inaccessible",i),l([])}finally{p(!1)}})()},[t._id,a,t.cycleId,s,t.flockId]);const m=Array.isArray(n)?n:[];return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[110] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-2xl overflow-hidden animate-in zoom-in-95 duration-300 flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"p-8 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(Y,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"Audit Trail"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-1",children:["Ref: ",t._id.slice(-8).toUpperCase()]})]})]}),e.jsx("button",{onClick:r,className:"p-3 bg-white hover:bg-rose-50 hover:text-rose-500 text-slate-400 rounded-xl transition-all shadow-sm",children:e.jsx(Ae,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 no-scrollbar",children:x?e.jsxs("div",{className:"py-20 flex flex-col items-center gap-4 opacity-40",children:[e.jsx(se,{className:"animate-spin text-blue-600",size:32}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em]",children:"Querying Node History..."})]}):m.length===0?e.jsxs("div",{className:"py-20 text-center flex flex-col items-center gap-4 opacity-30",children:[e.jsx(qe,{size:48,strokeWidth:1}),e.jsx("p",{className:"text-sm font-black uppercase tracking-widest",children:"No revision history found"})]}):e.jsxs("div",{className:"space-y-8 relative",children:[e.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-slate-100"}),m.map((d,i)=>e.jsxs("div",{className:"relative pl-14 group",children:[e.jsx("div",{className:"absolute left-[21px] top-0 w-2.5 h-2.5 rounded-full bg-slate-200 border-2 border-white group-hover:bg-blue-500 transition-colors"}),e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 group-hover:bg-white group-hover:border-blue-200 group-hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-slate-900 text-white rounded text-[8px] font-black uppercase tracking-widest",children:d.action}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-50",children:[e.jsx(va,{size:12,className:"text-slate-400"})," ",new Date(d.timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black text-blue-600 uppercase",children:[e.jsx(Nt,{size:12})," ",d.userName||"Operator"]})]}),d.changes&&Array.isArray(d.changes)&&d.changes.length>0&&e.jsx("div",{className:"space-y-3 pt-3 border-t border-slate-100",children:d.changes.map((o,u)=>e.jsxs("div",{className:"flex items-center gap-3 text-[11px] font-medium",children:[e.jsx("span",{className:"text-slate-400 font-black uppercase tracking-tighter w-24 truncate",children:o.field}),e.jsx("span",{className:"text-rose-500 line-through opacity-50",children:String(o.oldValue)}),e.jsx(ja,{size:10,className:"text-slate-300"}),e.jsx("span",{className:"text-emerald-600 font-black",children:String(o.newValue)})]},u))})]})]},i))]})}),e.jsx("div",{className:"p-8 border-t border-slate-100 flex justify-end",children:e.jsx("button",{onClick:r,className:"px-10 py-4 bg-slate-900 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em]",children:"Close View"})})]})})},Zs=({flockId:t,cycleId:a,onClose:r,onSuccess:s,api:n})=>{const[l,x]=c.useState([]),[p,m]=c.useState(!1),[d,i]=c.useState(""),o=c.useRef(null),u=g=>{var f;const v=(f=g.target.files)==null?void 0:f[0];if(!v)return;const h=new FileReader;h.onload=b=>{var M;const C=((M=b.target)==null?void 0:M.result).split(`
`),w=C[0].split(",").map(I=>I.trim()),P=C.slice(1).filter(I=>I.trim()).map(I=>{const A=I.split(",").map(L=>L.trim()),D={type:"weight_measurement",confidence:"high"};return w.forEach((L,E)=>{L==="weight"&&(D.weightMetrics={averageWeightGrams:parseFloat(A[E])}),L==="date"&&(D.date=A[E]),L==="count"&&(D.birdMetrics={count:parseInt(A[E])})}),D});x([...l,...P])},h.readAsText(v)},y=()=>{x([...l,{date:new Date().toISOString().split("T")[0],type:"weight_measurement",weightMetrics:{averageWeightGrams:0}}])},k=async()=>{if(l.length!==0){m(!0);try{await n.submitBulkMovement(t,a,l),s()}catch(g){i(g.message||"Bulk ingestion protocol failed")}finally{m(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[250] flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-[3.5rem] shadow-2xl w-full max-w-6xl max-h-[85vh] flex flex-col overflow-hidden animate-in zoom-in-95",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx(lt,{size:32})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter",children:"Bulk Ingestion Engine"}),e.jsxs("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mt-2",children:["Node Proxy: ",t.slice(-8).toUpperCase()," • Cycle: ",a]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>{var g;return(g=o.current)==null?void 0:g.click()},className:"px-6 py-3 bg-white border border-slate-200 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-slate-50 transition-all flex items-center gap-2",children:[e.jsx(Oa,{size:14})," Import CSV"]}),e.jsx("input",{type:"file",ref:o,className:"hidden",accept:".csv",onChange:u}),e.jsx("button",{onClick:r,className:"p-3 bg-white hover:bg-rose-50 text-slate-400 hover:text-rose-500 rounded-2xl transition-all",children:e.jsx(Ae,{size:24})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-10 no-scrollbar",children:l.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 gap-6 opacity-40",children:[e.jsx(ya,{size:80,strokeWidth:1}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-black uppercase tracking-[0.2em]",children:"Buffer Ready"}),e.jsx("p",{className:"text-sm font-bold uppercase mt-2",children:"Upload CSV or add rows manually to begin batch logging"})]})]}):e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100",children:[e.jsx("th",{className:"pb-4 px-4",children:"Effective Date"}),e.jsx("th",{className:"pb-4 px-4",children:"Metric Value"}),e.jsx("th",{className:"pb-4 px-4",children:"Confidence"}),e.jsx("th",{className:"pb-4 px-4 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:l.map((g,v)=>{var h;return e.jsxs("tr",{className:"group hover:bg-slate-50/50",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsx("input",{type:"date",value:g.date,onChange:f=>{const b=[...l];b[v].date=f.target.value,x(b)},className:"bg-transparent font-bold text-sm outline-none focus:text-blue-600"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("input",{type:"number",value:((h=g.weightMetrics)==null?void 0:h.averageWeightGrams)||0,onChange:f=>{const b=[...l];b[v].weightMetrics={averageWeightGrams:parseFloat(f.target.value)},x(b)},className:"bg-transparent font-black text-sm outline-none focus:text-blue-600 tabular-nums"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("select",{value:g.confidence,onChange:f=>{const b=[...l];b[v].confidence=f.target.value,x(b)},className:"bg-transparent text-[10px] font-black uppercase tracking-widest outline-none",children:[e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsx("button",{onClick:()=>x(l.filter((f,b)=>b!==v)),className:"p-2 text-slate-300 hover:text-rose-500 opacity-0 group-hover:opacity-100 transition-all",children:e.jsx(Ce,{size:16})})})]},v)})})]})}),e.jsxs("div",{className:"p-10 border-t border-slate-100 flex items-center justify-between bg-slate-50/30",children:[e.jsxs("button",{onClick:y,className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-blue-600 hover:text-blue-700 transition-colors",children:[e.jsx(ka,{size:16})," Append Data Row"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:r,className:"px-10 py-5 bg-white border border-slate-200 rounded-2xl text-[11px] font-black uppercase tracking-widest text-slate-400",children:"Discard Batch"}),e.jsx("button",{disabled:p||l.length===0,onClick:k,className:"px-14 py-5 bg-slate-900 text-white rounded-2xl text-[11px] font-black uppercase tracking-[0.2em] shadow-2xl hover:bg-black transition-all flex items-center gap-3",children:p?e.jsx(se,{size:18,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(wa,{size:18})," Commit Batch (",l.length,")"]})})]})]})]})})},yr=({movements:t,userRole:a,capabilities:r,t:s,api:n,selectedFlockId:l,flocks:x,selectedCycleId:p,onCycleChange:m,onRefresh:d})=>{var De;const[i,o]=c.useState("list"),[u,y]=c.useState(""),[k,g]=c.useState(!1),[v,h]=c.useState(!1),[f,b]=c.useState(!1),[j,C]=c.useState([]),[w,P]=c.useState(!1),[M,I]=c.useState(t),[A,D]=c.useState(null),[L,E]=c.useState(""),[K,W]=c.useState(null),[_,J]=c.useState(""),[Q,H]=c.useState(!1),[ee,te]=c.useState(null),[ae,Ee]=c.useState(null),[ht,ft]=c.useState({weights:[],feed:[],eggs:[],birdBalance:[]}),[gt,Pe]=c.useState(!1),B=s.langToggle==="EN";c.useEffect(()=>{const N=t.filter(S=>{var le;const z=u.toLowerCase(),$=!z||S.type.toLowerCase().includes(z)||((le=S.reason)==null?void 0:le.toLowerCase().includes(z))||S._id.toLowerCase().includes(z);return S.isDeleted!==!0&&$});I(N)},[t,u]);const Me=async()=>{if(l&&l!=="all"){P(!0);try{const S=((await n.getCycles(l)).cycles||[]).sort((z,$)=>$.cycleId.localeCompare(z.cycleId));if(C(S),!p&&S.length>0){const z=S.find($=>$.status==="active")||S[0];m(z.cycleId)}}catch(N){console.error("Failed to load cycles",N)}finally{P(!1)}}else C([])};c.useEffect(()=>{Me()},[l,n]),c.useEffect(()=>{(async()=>{if(i==="visual"&&l!=="all"&&p){Pe(!0);try{const[S,z,$,le]=await Promise.all([n.getWeights(l,p).catch(()=>({weights:[]})),n.getFeed(l,p).catch(()=>({data:[]})),n.getEggs(l,p).catch(()=>({eggs:[]})),n.getBirdBalance(l,p).catch(()=>({data:[]}))]);ft({weights:S.weights||[],feed:z.data||[],eggs:$.eggs||[],birdBalance:le.data||[]})}catch(S){console.error("Visual sync failed",S)}finally{Pe(!1)}}})()},[i,l,p,n]);const bt=async()=>{if(!K||!_)return;const{movement:N,type:S}=K;try{const z=N.flockId||l;S==="lock"?await n.lockMovement(z,N.cycleId,N._id,_):await n.unlockMovement(z,N.cycleId,N._id,_),d(),W(null),J("")}catch(z){alert(z.message)}},vt=async()=>{if(!A)return;H(!0);const N=A._id;I(S=>S.filter(z=>z._id!==N));try{const S=A.flockId||l;await n.deleteMovement(S,A.cycleId,A._id,L),D(null),E(""),d()}catch(S){alert(S.message||"Deletion failed"),d()}finally{H(!1)}},Be=N=>new Date(N).toLocaleDateString(B?"fa-IR":"en-US",{timeZone:"Asia/Tehran"}),jt=j.find(N=>N.cycleId===p),yt=(De=x.find(N=>N._id===l))==null?void 0:De.name,Oe=l!=="all"&&j.length===0&&!w;return e.jsxs("div",{className:"flex flex-col gap-4 lg:gap-6 animate-in fade-in duration-500",dir:B?"rtl":"ltr",children:[l!=="all"&&p&&!Oe&&e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(Vs,{currentCycle:jt,movementsCount:M.length,flockName:yt,selectedCycleId:p,isRtl:B,formatDate:Be}),e.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-4 bg-slate-900 text-white rounded-[1.5rem] text-[10px] font-black uppercase tracking-widest shadow-xl flex items-center gap-2 hover:bg-black transition-all",children:[e.jsx(lt,{size:16})," ",s.bulkIngestion]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[1.5rem] lg:rounded-[2.5rem] overflow-hidden shadow-sm flex flex-col relative",children:[e.jsx(Us,{viewMode:i,setViewMode:o,searchTerm:u,setSearchTerm:y,selectedCycleId:p,onCycleChange:m,cycles:j,loadingCycles:w,onShowDocs:()=>g(!0),isRtl:B,t:s,userRole:a}),e.jsx("div",{className:"min-h-0",children:Oe?e.jsxs("div",{className:"py-32 flex flex-col items-center justify-center text-center px-10 animate-in zoom-in-95 duration-500",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-50 text-slate-300 rounded-[2.5rem] flex items-center justify-center mb-8",children:e.jsx(Na,{size:48,strokeWidth:1})}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter mb-4",children:B?"چرخه عملیاتی یافت نشد":"No Operational Cycles Detected"}),e.jsx("p",{className:"text-sm font-medium text-slate-400 uppercase tracking-widest max-w-md mb-10 leading-relaxed",children:B?"گله انتخاب شده فاقد چرخه تولید فعال است. برای شروع ثبت داده، یک چرخه جدید ایجاد کنید یا گله دیگری را انتخاب نمایید.":"The selected flock has no production cycles registered in the ledger. Please initiate a cycle or select another node to begin telemetry."}),e.jsxs("button",{onClick:()=>h(!0),className:"px-10 py-5 bg-blue-600 text-white rounded-2xl text-xs font-black uppercase tracking-widest shadow-2xl shadow-blue-500/20 hover:bg-blue-700 transition-all flex items-center gap-3 active:scale-95",children:[e.jsx(At,{size:20})," ",B?"ایجاد اولین چرخه":"Initiate First Cycle"]})]}):i==="list"?e.jsx(Hs,{movements:M,formatDate:Be,onEdit:te,onDelete:D,onLock:N=>W({movement:N,type:"lock"}),onUnlock:N=>W({movement:N,type:"unlock"}),onViewHistory:Ee,userRole:a,capabilities:r}):e.jsx(Ys,{loading:gt,data:ht})})]}),f&&e.jsx(Zs,{flockId:l,cycleId:p,onClose:()=>b(!1),onSuccess:()=>{b(!1),d()},api:n}),v&&e.jsx(Pt,{flockId:l,onClose:()=>h(!1),onSuccess:()=>{h(!1),Me(),d()},api:n,t:s,isRtl:B}),ee&&e.jsx(ba,{onClose:()=>te(null),onSubmit:()=>{te(null),d()},flocks:x,t:s,api:n,onCreateFlock:async()=>{},editingMovement:ee}),ae&&e.jsx(qs,{movement:ae,flockId:ae.flockId||l,onClose:()=>Ee(null),api:n}),A&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] p-10 max-w-md w-full shadow-2xl space-y-6 animate-in zoom-in-95 duration-300",dir:B?"rtl":"ltr",children:[e.jsxs("div",{className:"flex items-center gap-4 text-rose-600",children:[e.jsx(Ce,{size:32}),e.jsx("h3",{className:"text-xl font-black uppercase",children:B?"حذف رکورد":"Delete Record"})]}),e.jsx("p",{className:"text-slate-500 font-medium leading-relaxed",children:B?"آیا از حذف دائمی این رکورد از دفتر کل اطمینان دارید؟ این عملیات قابل بازگشت نیست.":"Are you sure you want to permanently delete this record from the ledger? This action cannot be undone."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest block ml-1",children:B?"علت حذف (اختیاری)":"Deletion Reason (Optional)"}),e.jsx("textarea",{value:L,onChange:N=>E(N.target.value),placeholder:B?"علت حذف را وارد کنید...":"Enter deletion reason for audit...",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl p-4 text-xs font-medium min-h-[80px] outline-none focus:ring-4 focus:ring-rose-500/5 transition-all"})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{onClick:()=>{D(null),E("")},className:"flex-1 py-4 bg-slate-100 text-slate-500 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-slate-200 transition-all",children:B?"انصراف":"Cancel"}),e.jsx("button",{disabled:Q,onClick:vt,className:"flex-1 py-4 bg-rose-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-xl shadow-rose-500/20 hover:bg-rose-700 transition-all flex items-center justify-center gap-2",children:Q?e.jsx(se,{size:14,className:"animate-spin"}):s.confirmOperation})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] p-10 max-w-lg w-full shadow-2xl space-y-8 animate-in zoom-in-95 duration-300",dir:B?"rtl":"ltr",children:[e.jsx("h3",{className:"text-xl font-black uppercase",children:K.type==="lock"?s.verifyAndLock:s.requestUnlock}),e.jsx("textarea",{value:_,onChange:N=>J(N.target.value),placeholder:s.verificationReason,className:"w-full bg-slate-50 border rounded-2xl p-5 text-sm min-h-[120px]"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>W(null),className:"flex-1 py-4 text-slate-400 text-[10px] font-black uppercase",children:s.abort||"Abort"}),e.jsx("button",{disabled:!_.trim(),onClick:bt,className:"flex-[2] py-4 bg-slate-900 text-white rounded-xl text-[10px] font-black uppercase shadow-xl disabled:opacity-30",children:s.confirmOperation})]})]})}),k&&e.jsx($s,{onClose:()=>g(!1)})]})};export{yr as default};
