import{r as n,j as e,Z as u,d as N,L as h,v}from"./index-BqfCj9Cx.js";import{e as g}from"./EventBusService-uYe-P4JI.js";import{B as y}from"./box-D9n03Fvj.js";import{P as k}from"./play-DrkNqYZc.js";import{H as w}from"./history-pvMIkCk2.js";import{C as b}from"./circle-check-nzM3eO1E.js";import{A as f}from"./arrow-right-BsQnWYLF.js";const D=({api:S,t:I})=>{const[z,P]=n.useState([]),[m,o]=n.useState([]),[j,x]=n.useState(!1),[d]=n.useState([{id:"temp-spike-emergency",name:"Thermal Stress Protocol",description:"Automated remediation for environmental thermal spikes",enabled:!0,successRate:98,trigger:{event:"iot.temperature_spike"},steps:[{id:"1",module:"incident",action:"create_incident",parameters:{severity:"critical",title:"Thermal Anomaly"},onSuccess:"2"},{id:"2",module:"notification",action:"notify_team",parameters:{role:"Farm Manager",urgency:"high"}}]},{id:"stock-exhaustion-auto",name:"Autonomous Resupply",description:"Velocity-based feed reordering trigger",enabled:!0,successRate:94,trigger:{event:"supply.stock_critical"},steps:[{id:"1",module:"supply",action:"create_order",parameters:{qty:5e3,priority:"standard"},onSuccess:"2"},{id:"2",module:"financial",action:"allocate_funds",parameters:{category:"feed"}}]}]);n.useEffect(()=>g.subscribe("*",r=>{d.filter(i=>i.enabled&&i.trigger.event===r.type).forEach(i=>p(i,r.data))}),[d]);const p=async(s,r)=>{const t=Math.random().toString(36).slice(2,9),i={executionId:t,playbookId:s.id,status:"running",startTime:new Date().toISOString(),logs:[]};o(l=>[i,...l]),x(!0);for(const l of s.steps)await new Promise(a=>setTimeout(a,800)),o(a=>a.map(c=>c.executionId===t?{...c,logs:[...c.logs,{stepId:l.id,status:"success",timestamp:new Date().toISOString()}]}:c));o(l=>l.map(a=>a.executionId===t?{...a,status:"success",endTime:new Date().toISOString()}:a)),g.publish("orchestration.workflow_completed",{playbookId:s.id,executionId:t}),x(!1)};return e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-900 text-white rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx(u,{size:28,className:j?"animate-pulse text-blue-400":""})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:"Orchestration Pulse"}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mt-3",children:"Managed Event Registry V3.0"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"px-5 py-2.5 bg-emerald-50 border border-emerald-100 rounded-2xl flex items-center gap-3",children:[e.jsx(N,{size:16,className:"text-emerald-500"}),e.jsx("span",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest",children:"Logic Engine Stable"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("h3",{className:"text-xs font-black text-slate-900 uppercase tracking-[0.2em] px-2 flex items-center gap-2",children:[e.jsx(y,{size:16,className:"text-blue-500"})," Active Playbooks"]}),e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] p-6 shadow-sm hover:shadow-xl transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h4",{className:"text-sm font-black text-slate-800 uppercase tracking-tight",children:s.name}),e.jsxs("span",{className:"text-[9px] font-black text-blue-600 bg-blue-50 px-2 py-1 rounded-lg uppercase",children:[s.successRate,"% Success"]})]}),e.jsx("p",{className:"text-[11px] text-slate-500 font-medium leading-relaxed mb-6",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:["Listening: ",s.trigger.event]})]}),e.jsx("button",{onClick:()=>p(s),className:"p-2.5 bg-slate-900 text-white rounded-xl hover:bg-black transition-all shadow-lg shadow-slate-900/10",children:e.jsx(k,{size:14,fill:"currentColor"})})]})]},s.id))})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("h3",{className:"text-xs font-black text-slate-900 uppercase tracking-[0.2em] px-2 flex items-center gap-2",children:[e.jsx(w,{size:16,className:"text-blue-500"})," Execution Registry"]}),e.jsx("div",{className:"bg-white border border-slate-200 rounded-[2.5rem] p-8 min-h-[500px] shadow-sm overflow-y-auto no-scrollbar",children:m.length===0?e.jsxs("div",{className:"h-full py-40 flex flex-col items-center justify-center opacity-30 text-center",children:[e.jsx(u,{size:64,className:"mb-4"}),e.jsx("p",{className:"text-xs font-black uppercase tracking-[0.4em]",children:"Zero Active Flows"})]}):e.jsx("div",{className:"space-y-6",children:m.map(s=>e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-[2rem] p-6 animate-in slide-in-from-right-4 duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shadow-md ${s.status==="success"?"bg-emerald-500 text-white":"bg-blue-600 text-white"}`,children:s.status==="running"?e.jsx(h,{size:18,className:"animate-spin"}):e.jsx(b,{size:18})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"text-xs font-black text-slate-900 uppercase tracking-widest",children:["Run #",s.executionId.toUpperCase()]}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase",children:s.playbookId.replace(/-/g," ")})]})]}),e.jsx("span",{className:"text-[9px] font-mono font-bold text-slate-400",children:new Date(s.startTime).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.logs.map((r,t)=>e.jsxs(v.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 bg-white border border-slate-200 rounded-xl flex items-center gap-3 shadow-sm group hover:border-blue-300 transition-all",children:[e.jsx(b,{size:12,className:"text-emerald-500"}),e.jsxs("span",{className:"text-[10px] font-black text-slate-700 uppercase tracking-tighter",children:["Step ",r.stepId]})]}),t<s.logs.length-1&&e.jsx(f,{size:12,className:"text-slate-300"})]},r.stepId)),s.status==="running"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{size:12,className:"text-slate-300 animate-pulse"}),e.jsxs("div",{className:"px-4 py-2 bg-white/50 border border-slate-100 border-dashed rounded-xl flex items-center gap-3",children:[e.jsx(h,{size:12,className:"animate-spin text-blue-400"}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Processing..."})]})]})]})]},s.executionId))})})]})]})]})};export{D as default};
