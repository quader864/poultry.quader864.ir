import{c as C,r as i,j as e,a as T,h as M,i as y,L as A,k as _,l as O,T as F,d as D}from"./index-Boji9h6s.js";import{A as I,a}from"./types-ajuHBdeq.js";import{B as V}from"./brain-B3Ft14Us.js";import{I as $}from"./info-C2nnCsUG.js";import{M as H}from"./message-square-Wjh9H2gk.js";import{P}from"./plus-D3Rv5N16.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],G=C("circle-check-big",B);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],U=C("tag",W),q={LOW:"bg-blue-100 text-blue-700",MEDIUM:"bg-yellow-100 text-yellow-700",HIGH:"bg-orange-100 text-orange-700",CRITICAL:"bg-red-100 text-red-700"},K=({anomaly:s,isExpanded:r,onToggle:g,onAddHypothesis:m,onResolve:u,t:d,api:f})=>{var w,k;const[c,h]=i.useState(""),[n,x]=i.useState(""),[t,j]=i.useState(!1),[o,z]=i.useState(null),[S,N]=i.useState(!1),b=s._id||s.id||"",v=s.calculatedValue??s.value??0,L=s.ruleName||s.message||"Detection Alert",R=s.reason||s.message||"Threshold violation detected.";i.useEffect(()=>{r&&!o&&(async()=>{N(!0);try{const p=await O.analyzeAnomaly(s);z(p)}catch(p){console.error("AI Analysis failed",p)}finally{N(!1)}})()},[r,o,s]);const E=async()=>{if(c.trim()){j(!0);try{await m(b,c,n),h(""),x("")}finally{j(!1)}}};return e.jsxs("div",{className:`group bg-white rounded-3xl border transition-all duration-300 overflow-hidden shadow-sm ${r?"border-blue-500 ring-4 ring-blue-500/5":"border-slate-200 hover:border-blue-300"}`,children:[e.jsxs("div",{className:"p-6 cursor-pointer flex flex-col lg:flex-row items-start lg:items-center gap-6",onClick:g,children:[e.jsx("div",{className:`shrink-0 w-14 h-14 rounded-2xl flex items-center justify-center ${s.severity===I.CRITICAL?"bg-rose-50 text-rose-600 border border-rose-100":s.severity===I.HIGH?"bg-orange-50 text-orange-600 border border-orange-100":"bg-amber-50 text-amber-600 border-amber-100"}`,children:e.jsx(T,{size:28})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex wrap items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border ${q[s.severity.toUpperCase()]||"bg-slate-100 text-slate-600"}`,children:s.severity}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]",children:new Date(s.date).toLocaleDateString()}),e.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:["ID: ",b.slice(-6).toUpperCase()]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-tighter ${s.status===a.NEW?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"}`,children:s.status})]}),e.jsx("h3",{className:"text-base font-black text-slate-800 tracking-tight line-clamp-1",children:L}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1",children:["Metric: ",s.metricKey||s.affectedMetric]})]}),e.jsxs("div",{className:"flex items-center gap-6 shrink-0 ml-auto",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Calculated Value"}),e.jsx("p",{className:"text-lg font-black text-slate-800 tabular-nums",children:v.toFixed(4)})]}),e.jsx("div",{className:`p-2 rounded-xl transition-transform duration-300 ${r?"rotate-90 bg-slate-100 text-slate-900":"text-slate-300"}`,children:e.jsx(M,{size:20})})]})]}),r&&e.jsx("div",{className:"px-6 pb-6 border-t border-slate-50 animate-in slide-in-from-top-4 duration-300",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 pt-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(V,{size:14,className:"text-blue-600"})," System Metrics Breakdown"]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 space-y-3 border border-slate-100 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Observed"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:v.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Range Min"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:(((w=s.expectedRange)==null?void 0:w.min)??0).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Range Max"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:(((k=s.expectedRange)==null?void 0:k.max)??0).toFixed(2)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-blue-700 rounded-3xl p-6 text-white shadow-xl relative overflow-hidden group/ai",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 rotate-12 group-hover/ai:scale-125 transition-transform duration-1000",children:e.jsx(y,{size:80})}),e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] mb-4 flex items-center gap-2 relative z-10 text-blue-100",children:[e.jsx(y,{size:14})," Sentinel AI Insights"]}),S?e.jsxs("div",{className:"flex flex-col gap-4 py-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{size:16,className:"animate-spin text-blue-200"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-blue-100",children:"Consulting Neural Fabric..."})]}),e.jsx("div",{className:"h-1 bg-white/20 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-300 w-1/3 animate-[shimmer_2s_infinite]"})})]}):o?e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-blue-200 uppercase",children:"AI Diagnosis"}),e.jsx("p",{className:"text-xs font-bold leading-relaxed",children:o.reasoning})]}),e.jsxs("div",{className:"pt-3 border-t border-white/10 space-y-1",children:[e.jsx("p",{className:"text-[9px] font-black text-emerald-300 uppercase",children:"Recommended Action"}),e.jsx("p",{className:"text-xs font-black",children:o.recommendation})]})]}):e.jsx("p",{className:"text-[10px] font-bold text-blue-200 italic relative z-10",children:"Intelligence link disconnected."})]}),e.jsxs("button",{onClick:()=>u(b,a.RESOLVED),className:"w-full py-4 bg-emerald-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-emerald-500/20 hover:bg-emerald-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(G,{size:16})," Mark as Resolved"]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-[2rem] p-6 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(_,{size:60})}),e.jsxs("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3 flex items-center gap-2 relative z-10",children:[e.jsx($,{size:14,className:"text-blue-400"})," Incident Context"]}),e.jsxs("p",{className:"text-base font-medium leading-relaxed italic relative z-10",children:['"',R,'"']})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(H,{size:14,className:"text-indigo-600"})," Resolution Registry"]}),e.jsxs("div",{className:"space-y-3 max-h-[200px] overflow-y-auto no-scrollbar pr-2",children:[(s.hypotheses||[]).map((l,p)=>e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-4 shadow-sm flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white border border-slate-200 flex items-center justify-center shrink-0",children:e.jsx(U,{size:12,className:"text-slate-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-[9px] font-black text-slate-900 uppercase",children:["#",l.tag]}),e.jsx("span",{className:"text-[8px] text-slate-400 font-bold uppercase",children:l.addedAt})]}),e.jsx("p",{className:"text-[11px] text-slate-600 leading-snug font-medium",children:l.note})]})]},p)),(!s.hypotheses||s.hypotheses.length===0)&&e.jsx("p",{className:"text-[10px] text-slate-300 italic py-4",children:"No investigative logs recorded."})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-3xl p-6 border border-slate-200",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-4",children:"Add Investigation Log"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 text-xs font-bold outline-none shadow-sm focus:ring-4 focus:ring-blue-500/5 transition-all",placeholder:"Action Tag (e.g. sanitation)...",value:c,onChange:l=>h(l.target.value)}),e.jsx("textarea",{className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 text-xs font-medium min-h-[80px] shadow-sm outline-none focus:ring-4 focus:ring-blue-500/5 transition-all",placeholder:"Record resolution steps or observations...",value:n,onChange:l=>x(l.target.value)}),e.jsx("button",{disabled:t||!c.trim(),onClick:E,className:"w-full py-4 bg-slate-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all disabled:opacity-50 flex items-center justify-center gap-2 shadow-xl",children:t?e.jsx(A,{size:14,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(P,{size:14})," Commit Findings"]})})]})]})]})]})]})})]})},se=({anomalies:s,onAddHypothesis:r,onResolve:g,t:m,api:u})=>{const[d,f]=i.useState("ALL"),[c,h]=i.useState(null),n=Array.isArray(s)?s:[],x=d==="ALL"?n:n.filter(t=>d===a.OPEN?t.status===a.OPEN||t.status===a.NEW:t.status===d);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-amber-500/20",children:e.jsx(F,{size:22})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:m.anomalies}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:[n.length," total events detected"]})]})]}),e.jsx("div",{className:"flex bg-white border border-slate-200 p-1 rounded-xl shadow-sm",children:["ALL",a.OPEN,a.INVESTIGATING,a.RESOLVED].map(t=>e.jsx("button",{onClick:()=>f(t),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${d===t?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:t==="ALL"?"Total":t===a.OPEN?"Open/New":t},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[x.map(t=>e.jsx(K,{anomaly:t,isExpanded:c===(t._id||t.id),onToggle:()=>h(c===(t._id||t.id)?null:t._id||t.id),onAddHypothesis:r,onResolve:g,t:m,api:u},t._id||t.id)),x.length===0&&e.jsxs("div",{className:"py-32 text-center flex flex-col items-center gap-6 opacity-40",children:[e.jsx(D,{size:64,className:"text-slate-200",strokeWidth:1}),e.jsx("p",{className:"text-sm font-black text-slate-400 uppercase tracking-[0.25em]",children:"Registry Clear - Zero Events Found"})]})]})]})};export{se as default};
