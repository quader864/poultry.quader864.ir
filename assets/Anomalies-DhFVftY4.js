import{c as i,r,j as e,T as z,b as I,C as R,U as T,d as D}from"./index-CZC_pdxc.js";import{A as l,a as k,S as _,P as O}from"./types-DP29Vkv9.js";import{A as $}from"./arrow-up-right-C9U2SODA.js";import{T as V}from"./tag-_jh8PTp8.js";import{S as H}from"./shield-check-DjNDSCTG.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],G=i("arrow-down-right",F);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],P=i("brain",K);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],q=i("circle-check-big",U);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],W=i("message-square",B);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Z=i("shield-alert",Y),J={LOW:"bg-blue-100 text-blue-700",MEDIUM:"bg-yellow-100 text-yellow-700",HIGH:"bg-orange-100 text-orange-700",CRITICAL:"bg-red-100 text-red-700"},ae=({anomalies:p,onAddHypothesis:v,onResolve:w,t:x})=>{const[c,y]=r.useState("ALL"),[d,A]=r.useState(null),[n,h]=r.useState(""),[m,g]=r.useState(""),[S,b]=r.useState(!1),o=Array.isArray(p)?p:[],u=c==="ALL"?o:o.filter(s=>c===l.OPEN?s.status===l.OPEN||s.status===l.NEW:s.status===c),C=async s=>{if(n.trim()){b(!0);try{await v(s,n,m),h(""),g("")}finally{b(!1)}}};return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-500 text-white rounded-xl flex items-center justify-center shadow-lg shadow-amber-500/20",children:e.jsx(z,{size:22})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:x.anomalies}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:[o.length," total events detected"]})]})]}),e.jsx("div",{className:"flex bg-white border border-slate-200 p-1 rounded-xl shadow-sm",children:["ALL",l.OPEN,l.INVESTIGATING,l.RESOLVED].map(s=>e.jsx("button",{onClick:()=>y(s),className:`px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${c===s?"bg-slate-900 text-white shadow-lg":"text-slate-400 hover:text-slate-600"}`,children:s==="ALL"?"Total":s===l.OPEN?"Open/New":s},s))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[u.map(s=>{var j,N;const t=s._id||s.id||"",f=s.calculatedValue??s.value??0,M=s.ruleName||s.message||"Detection Alert",L=s.reason||s.message||"Threshold violation detected.";return e.jsxs("div",{className:`group bg-white rounded-3xl border transition-all duration-300 overflow-hidden shadow-sm ${d===t?"border-blue-500 ring-4 ring-blue-500/5":"border-slate-200 hover:border-blue-300"}`,children:[e.jsxs("div",{className:"p-6 cursor-pointer flex flex-col lg:flex-row items-start lg:items-center gap-6",onClick:()=>A(d===t?null:t),children:[e.jsx("div",{className:`shrink-0 w-14 h-14 rounded-2xl flex items-center justify-center ${s.severity===k.CRITICAL?"bg-rose-50 text-rose-600 border border-rose-100":s.severity===k.HIGH?"bg-orange-50 text-orange-600 border border-orange-100":"bg-amber-50 text-amber-600 border border-amber-100"}`,children:e.jsx(Z,{size:28})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex wrap items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border ${J[s.severity.toUpperCase()]||"bg-slate-100 text-slate-600"}`,children:s.severity}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em]",children:new Date(s.date).toLocaleDateString()}),e.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:["ID: ",t.slice(-6).toUpperCase()]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase tracking-tighter ${s.status===l.NEW?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"}`,children:s.status})]}),e.jsx("h3",{className:"text-base font-black text-slate-800 tracking-tight line-clamp-1",children:M}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1",children:["Metric: ",s.metricKey||s.affectedMetric]})]}),e.jsxs("div",{className:"flex items-center gap-6 shrink-0 ml-auto",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Calculated Value"}),e.jsx("p",{className:"text-lg font-black text-slate-800 tabular-nums",children:f.toFixed(4)})]}),e.jsx("div",{className:`p-2 rounded-xl transition-transform duration-300 ${d===t?"rotate-90 bg-slate-100 text-slate-900":"text-slate-300"}`,children:e.jsx(I,{size:20})})]})]}),d===t&&e.jsx("div",{className:"px-6 pb-6 border-t border-slate-50 animate-in slide-in-from-top-4 duration-300",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 pt-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(P,{size:14,className:"text-blue-600"})," System Metrics Breakdown"]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-4 space-y-3 border border-slate-100 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Observed"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:f.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Range Min"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:(((j=s.expectedRange)==null?void 0:j.min)??0).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Range Max"}),e.jsx("span",{className:"text-sm font-black text-slate-800",children:(((N=s.expectedRange)==null?void 0:N.max)??0).toFixed(2)})]})]})]}),(s.expectedKg!==void 0||s.kgDeviation!==void 0)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(_,{size:14,className:"text-indigo-600"})," Mass Balance Analysis"]}),e.jsxs("div",{className:"bg-indigo-50/30 rounded-2xl p-4 space-y-3 border border-indigo-100 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-indigo-500 uppercase",children:"Actual (KG)"}),e.jsxs("span",{className:"text-sm font-black text-indigo-900",children:[(s.actualKg??0).toLocaleString()," kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-indigo-500 uppercase",children:"Expected (KG)"}),e.jsxs("span",{className:"text-sm font-black text-indigo-900",children:[(s.expectedKg??0).toLocaleString()," kg"]})]}),e.jsxs("div",{className:`flex justify-between items-center pt-2 mt-2 border-t border-indigo-100 ${(s.kgDeviation??0)<0?"text-rose-600":"text-emerald-600"}`,children:[e.jsx("span",{className:"text-xs font-black uppercase",children:"Net Deviation"}),e.jsxs("div",{className:"flex items-center gap-1.5 font-black text-sm",children:[(s.kgDeviation??0)<0?e.jsx(G,{size:14}):e.jsx($,{size:14}),Math.abs(s.kgDeviation??0).toLocaleString()," kg"]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>w(t,l.RESOLVED),className:"flex-1 py-3 bg-emerald-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-emerald-500/20 hover:bg-emerald-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(q,{size:14})," Resolve Case"]})})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 mb-6",children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[e.jsx(R,{size:14})," Intelligence Reason"]}),e.jsxs("p",{className:"text-sm font-medium text-slate-600 leading-relaxed italic",children:['"',L,'"']})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(W,{size:14,className:"text-indigo-600"})," ",x.hypotheses]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[(s.hypotheses||[]).map((a,E)=>e.jsxs("div",{className:"bg-white border border-slate-100 rounded-2xl p-4 shadow-sm flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center shrink-0",children:e.jsx(V,{size:14})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-[10px] font-black text-slate-900 uppercase tracking-tighter bg-slate-100 px-2 py-0.5 rounded",children:["#",a.tag]}),e.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase",children:a.addedAt})]}),e.jsx("p",{className:"text-xs text-slate-600 leading-relaxed font-medium",children:a.note}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(T,{size:10,className:"text-slate-400"}),e.jsx("span",{className:"text-[9px] font-black text-slate-500 uppercase",children:a.addedBy})]})]}),a.confirmed&&e.jsx("div",{className:"bg-emerald-50 text-emerald-600 p-1 rounded-full",children:e.jsx(D,{size:14,strokeWidth:3})})]},E)),(!s.hypotheses||s.hypotheses.length===0)&&e.jsx("div",{className:"py-8 text-center border-2 border-dashed border-slate-100 rounded-2xl",children:e.jsx("p",{className:"text-[10px] font-black text-slate-300 uppercase tracking-[0.2em]",children:"No Investigation Logs"})})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5 border border-slate-200",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3",children:x.addHypothesis}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Tag (e.g. scale_desync, leakage)...",className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-2.5 text-xs font-bold outline-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 transition-all shadow-sm",value:n,onChange:a=>h(a.target.value)}),e.jsx("textarea",{placeholder:"Add detailed investigative note...",className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-2.5 text-xs font-medium outline-none focus:ring-4 focus:ring-blue-500/10 focus:border-blue-500 transition-all min-h-[80px] shadow-sm",value:m,onChange:a=>g(a.target.value)}),e.jsxs("button",{disabled:S||!n.trim(),onClick:()=>C(t),className:"w-full py-3 bg-slate-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-xl",children:[e.jsx(O,{size:14})," Submit Findings"]})]})]})]})]})]})})]},t)}),u.length===0&&e.jsxs("div",{className:"py-32 text-center flex flex-col items-center gap-6 opacity-40",children:[e.jsx(H,{size:64,className:"text-slate-200",strokeWidth:1}),e.jsx("p",{className:"text-sm font-black text-slate-400 uppercase tracking-[0.25em]",children:"Registry Clear - Zero Events Found"})]})]})]})};export{ae as default};
