import{c as g,r as d,j as e,A as Ae,g as Be,f as Ee,s as Oe,x as Pe,T as Re,L as Ve,y as qe,k as Ge}from"./index-Dfm8v7ej.js";import{A as he}from"./types-ajuHBdeq.js";import{g as L,B as We,e as be,m as I}from"./LogicEngine-BaRx16g2.js";import{B as He}from"./book-open-CGoRG6Mh.js";import{C as Ue}from"./code-Cz-X-tP-.js";import{F as Je}from"./flask-conical-ClU7Xv2J.js";import{S as ge}from"./search-Dn7-SK0M.js";import{L as Ke}from"./layers-CWvkg5i4.js";import{C as Qe}from"./circle-check-VEIAJ82F.js";import{T as Ye}from"./toggle-right-CCtymUgn.js";import{I as fe}from"./info-KoxbNrkG.js";import"./trash-2-CPaVpvFj.js";import"./download-zMDTRP1S.js";import"./clock-BmYM6Lvn.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],je=g("arrow-left",Ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],et=g("delete",Xe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],at=g("mouse-pointer-click",tt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],lt=g("ruler",st);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],nt=g("sliders-horizontal",rt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],ot=g("square-terminal",it);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],dt=g("toggle-left",ct),Dt=({api:$,t:s,flocks:ye,inputsWithTypes:ve,allValidVariables:F,blueprints:A,onComplete:ke,setActiveModule:C,isRtl:i})=>{var W,H,U,J,K,Q,Y,Z,X,ee,te,ae,se,le,re,ne,ie,oe,ce,de,xe,pe;const[B,f]=d.useState("select"),[x,j]=d.useState(1),[E,v]=d.useState(!1),[k,D]=d.useState(!1),[N,O]=d.useState(""),[p,h]=d.useState(null),[b,y]=d.useState(null),[m,S]=d.useState(null),[z,Ne]=d.useState({}),[we,Ce]=d.useState(new Set),[M,De]=d.useState(""),[P,xt]=d.useState(""),[w,Se]=d.useState("all"),R={name:"",type:"consumption",unit:"scalar",status:"active",flockId:null,calculation:{formula:"",dependencies:[]},threshold:{expectedMin:0,expectedMax:100,alertMin:0,alertMax:100,baselineType:"total"},anomalyDetection:{enabled:!0,severity:he.MEDIUM,variancePercent:10,consecutiveDays:1,trigger:"exceeds_or_below"}},[a,o]=d.useState(R),T=t=>{const l=be(t,F);o(r=>({...r,calculation:{formula:t,dependencies:l}}))},ze=t=>{o({...R,name:`AUTO: ${t.label}`,type:I(t.domain),unit:t.unit||"scalar",calculation:{formula:t.formula,dependencies:be(t.formula,F)}}),f("custom"),j(3)},_=t=>{var c;const l=((c=a.calculation)==null?void 0:c.formula)||"",n=[...L(l)];b!==null?(n[b]=t,h(b),y(null)):p===-1?(n.splice(0,0,t),h(0)):p===null?n.push(t):(n.splice(p+1,0,t),h(p+1)),T(n.join(" "))},Me=()=>{var c;const t=((c=a.calculation)==null?void 0:c.formula)||"",l=L(t);if(l.length===0)return;const r=[...l];let n=p;if(b!==null){r.splice(b,1);const u=b;n=u===0?-1:u-1,y(null)}else if(p===null)r.pop();else{if(p===-1)return;{r.splice(p,1);const u=p;n=u===0?-1:u-1}}T(r.join(" ")),h(n)},V=()=>{!N.trim()||isNaN(Number(N))||(_(N.trim()),O(""))},Te=t=>{Ce(l=>{const r=new Set(l);return r.has(t)?r.delete(t):r.add(t),r})},_e=async()=>{var t,l,r,n,c,u;if((t=a.calculation)!=null&&t.formula){v(!0),S(null);try{const me=I(a.type||"consumption"),Fe={name:a.name||"Simulation Run",type:me,metric:{key:(a.name||"simulated_vector").toLowerCase().replace(/\s+/g,"_"),unit:a.unit||"scalar",dataSource:"inventory"},calculation:{formula:(l=a.calculation)==null?void 0:l.formula,dependencies:((r=a.calculation)==null?void 0:r.dependencies)||[]},threshold:{expectedMin:(n=a.threshold)==null?void 0:n.expectedMin,expectedMax:(c=a.threshold)==null?void 0:c.expectedMax,baselineType:((u=a.threshold)==null?void 0:u.baselineType)||"total"},testData:z},ue=await $.request("/rules/test-logic",{method:"POST",body:JSON.stringify(Fe)});S(ue.data||ue)}catch{S({calculatedMetric:{value:0},anomalyDetection:{isAnomaly:!1,reason:"Simulation context could not be established."}})}finally{v(!1)}}},Le=async()=>{if(a.name){v(!0);try{const t={...a,type:I(a.type||"consumption")};await $.createRule(t),ke()}catch(t){alert(t.message||"Failed to provision rule")}finally{v(!1)}}},q=["(",")","||","&&","100","1000","+","-","*","/","%",":","==",">","<"],Ie=d.useMemo(()=>{var t;return L(((t=a.calculation)==null?void 0:t.formula)||"")},[(W=a.calculation)==null?void 0:W.formula]),G=d.useMemo(()=>A.filter(t=>{var n;const l=t.label.toLowerCase().includes(P.toLowerCase()),r=w==="all"||((n=t.domain)==null?void 0:n.toLowerCase())===w.toLowerCase();return l&&r}),[A,P,w]),$e=["g","kg","ml","L","birds","eggs","%","scalar","count"];return B==="select"?e.jsxs("div",{className:"max-w-6xl mx-auto py-12 px-4 space-y-12 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-4xl font-black text-slate-900 uppercase tracking-tighter",children:s.architecturalEntry}),e.jsx("p",{className:"text-slate-500 font-medium max-w-xl mx-auto uppercase tracking-widest text-[10px]",children:s.selectConstructionMethod})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{onClick:()=>f("template"),className:"bg-white border border-slate-200 p-10 rounded-[3.5rem] shadow-sm hover:shadow-2xl hover:border-emerald-400 transition-all cursor-pointer group flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-50 text-emerald-600 rounded-[2rem] flex items-center justify-center mb-8 group-hover:scale-110 transition-transform",children:e.jsx(He,{size:40})}),e.jsx("h3",{className:"text-2xl font-black text-slate-900 uppercase tracking-tight mb-2",children:s.blueprintVault}),e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:s.blueprintVaultDesc})]}),e.jsxs("div",{onClick:()=>{f("custom"),j(1),D(!1)},className:"bg-white border border-slate-200 p-10 rounded-[3.5rem] shadow-sm hover:shadow-2xl hover:border-blue-400 transition-all cursor-pointer group flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-blue-50 text-blue-600 rounded-[2rem] flex items-center justify-center mb-8 group-hover:scale-110 transition-transform",children:e.jsx(at,{size:40})}),e.jsx("h3",{className:"text-2xl font-black text-slate-900 uppercase tracking-tight mb-2",children:s.guidedArchitect}),e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest leading-relaxed",children:s.guidedArchitectDesc})]}),e.jsxs("div",{onClick:()=>{f("custom"),j(1),D(!0)},className:"bg-slate-900 border border-white/5 p-10 rounded-[3.5rem] shadow-2xl relative overflow-hidden group transition-all hover:border-blue-500 cursor-pointer flex flex-col items-center text-center",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:scale-110 transition-transform",children:e.jsx(ot,{size:100,className:"text-white"})}),e.jsx("div",{className:"w-20 h-20 bg-white/5 text-blue-400 rounded-3xl flex items-center justify-center mb-8 group-hover:scale-110 transition-transform relative z-10",children:e.jsx(Ue,{size:40})}),e.jsx("h3",{className:"text-2xl font-black text-white uppercase tracking-tight mb-2 relative z-10",children:s.rawEditor}),e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest leading-relaxed relative z-10",children:s.rawEditorDesc})]})]})]}):B==="template"?e.jsxs("div",{className:"max-w-6xl mx-auto py-10 px-4 space-y-10 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 px-2",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("button",{onClick:()=>f("select"),className:"p-3 bg-white border border-slate-200 rounded-2xl text-slate-400 hover:text-slate-900 transition-all shadow-sm",children:e.jsx(je,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter leading-none",children:s.blueprintVault}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mt-3",children:s.registryOfVerified})]})]}),e.jsx("div",{className:"flex bg-slate-100 p-1.5 rounded-[1.5rem] shadow-inner overflow-x-auto no-scrollbar",children:["all","Resources","Growth","Production"].map(t=>e.jsx("button",{onClick:()=>Se(t),className:`px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${w===t?"bg-white text-blue-600 shadow-sm":"text-slate-400 hover:text-600"}`,children:t},t))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:G.map(t=>e.jsxs("div",{onClick:()=>ze(t),className:"bg-white border border-slate-200 rounded-[3rem] p-8 shadow-sm hover:shadow-2xl hover:border-emerald-300 transition-all cursor-pointer group relative overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-50 rounded-2xl flex items-center justify-center text-slate-400 group-hover:bg-emerald-50 group-hover:text-emerald-600 transition-all duration-500 shadow-sm",children:t.domain==="Resources"?e.jsx(Je,{size:28}):t.domain==="Growth"?e.jsx(Ae,{size:28}):e.jsx(Be,{size:28})}),e.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-400 rounded-lg text-[8px] font-black uppercase tracking-widest",children:t.domain})]}),e.jsx("h4",{className:"text-xl font-black text-slate-900 uppercase tracking-tighter mb-2 group-hover:text-emerald-600 transition-colors",children:t.label}),e.jsx("p",{className:"text-xs font-medium text-slate-400 leading-relaxed mb-10 flex-1",children:t.description}),e.jsx("div",{className:"bg-slate-950 rounded-2xl p-4 font-mono text-[9px] text-emerald-400/80 mb-8 border border-white/5 truncate",children:t.formula}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-slate-50 mt-auto",children:[e.jsx("span",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest",children:s.deployNode}),e.jsx(Ee,{size:18,className:"text-slate-300 group-hover:translate-x-1 group-hover:text-emerald-600 transition-all"})]})]},t.id))}),G.length===0&&e.jsxs("div",{className:"py-40 flex flex-col items-center justify-center text-center opacity-30",children:[e.jsx(ge,{size:80,className:"text-slate-300 mb-6",strokeWidth:1}),e.jsx("h3",{className:"text-xl font-black text-slate-400 uppercase tracking-[0.2em]",children:s.zeroMatchingBlueprints})]})]}):e.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col lg:flex-row gap-10 py-6 px-4 animate-in fade-in duration-500",dir:i?"rtl":"ltr",children:[e.jsxs("div",{className:"flex-1 space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 px-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>f("select"),className:"p-2 text-slate-400 hover:bg-slate-100 rounded-lg",children:e.jsx(je,{size:20})}),e.jsxs("h3",{className:"text-sm font-black text-slate-900 uppercase tracking-widest",children:[s.architectStep," ",x,"/5"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>D(!k),className:`px-4 py-1.5 rounded-lg text-[9px] font-black uppercase tracking-widest border transition-all ${k?"bg-slate-900 text-white border-slate-900 shadow-lg":"bg-white text-slate-500 border-slate-200"}`,children:k?s.terminalActive:s.matrixActive}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:`h-1.5 w-6 rounded-full transition-all ${x===t?"bg-blue-600 w-10":x>t?"bg-blue-200":"bg-slate-100"}`},t))})]})]}),e.jsxs("div",{className:"bg-white border border-slate-100 rounded-[3.5rem] p-8 lg:p-16 shadow-2xl flex flex-col",children:[x===1&&e.jsxs("div",{className:"space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter mb-2",children:s.ruleIdentity}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:s.namespaceConfig})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-2 col-span-3",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.protocolIdentifier}),e.jsx("input",{className:"w-full bg-slate-50 border border-slate-200 rounded-[1.5rem] px-8 py-6 text-base font-bold outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:a.name,onChange:t=>o({...a,name:t.target.value}),placeholder:"e.g., ANALYTICS_V4_DRIFT_SENSOR"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.logicType}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-xs font-black uppercase",value:a.type,onChange:t=>o({...a,type:t.target.value}),children:[e.jsx("option",{value:"consumption",children:"Consumption Flow"}),e.jsx("option",{value:"water",children:"Water / Environment"}),e.jsx("option",{value:"mortality",children:"Mortality Vector"}),e.jsx("option",{value:"weight",children:"Mass / Weight"}),e.jsx("option",{value:"custom",children:"Custom Node"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.metricUnit}),e.jsxs("div",{className:"relative",children:[e.jsx(lt,{size:14,className:`absolute ${i?"right-4":"left-4"} top-1/2 -translate-y-1/2 text-slate-400`}),e.jsx("select",{className:`w-full bg-slate-50 border border-slate-200 rounded-2xl ${i?"pr-10 pl-6":"pl-10 pr-6"} py-4 text-xs font-black uppercase outline-none focus:ring-8 focus:ring-blue-500/5 transition-all`,value:a.unit,onChange:t=>o({...a,unit:t.target.value}),children:$e.map(t=>e.jsx("option",{value:t,children:t.toUpperCase()},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.fleetContext}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-xs font-black uppercase",value:a.flockId||"",onChange:t=>o({...a,flockId:t.target.value||null}),children:[e.jsx("option",{value:"",children:i?"اجرای سراسری":"Global Enforcement"}),ye.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]})]})]}),x===2&&e.jsxs("div",{className:"space-y-10 animate-in fade-in slide-in-from-bottom-4 duration-500 flex flex-col",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter mb-2",children:s.computationalLogic}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:s.formulaConstructionRegistry})]}),k?e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.advancedFormulaEditor}),e.jsx("textarea",{className:"w-full bg-slate-950 rounded-[2.5rem] p-10 font-mono text-xl text-blue-400 shadow-2xl border border-white/10 outline-none focus:ring-8 focus:ring-blue-500/5 transition-all resize-none min-h-[250px]",value:((H=a.calculation)==null?void 0:H.formula)||"",onChange:t=>T(t.target.value),placeholder:"Type your complex logic here... (e.g. (feed * 0.1) + mortality)"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-950 rounded-[3rem] p-10 min-h-[180px] flex flex-wrap content-start items-center gap-x-2 gap-y-4 shadow-2xl border border-white/5 relative",dir:"ltr",children:[e.jsx("button",{onClick:()=>{h(-1),y(null)},className:`w-1 h-10 rounded-full transition-all ${p===-1?"bg-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.8)]":"bg-transparent hover:bg-white/5"}`}),Ie.map((t,l)=>e.jsxs(Oe.Fragment,{children:[e.jsx("button",{onClick:()=>{y(l),h(null)},className:`px-5 py-3 rounded-2xl text-[10px] font-black uppercase transition-all border-2 ${b===l?"border-yellow-400 bg-indigo-600 text-white":q.includes(t)?"border-white/5 bg-slate-800 text-indigo-300":"border-transparent bg-blue-600 text-white shadow-lg"}`,children:t}),e.jsx("button",{onClick:()=>{h(l),y(null)},className:`w-1 h-10 rounded-full transition-all ${p===l?"bg-blue-500 shadow-[0_0_15px_rgba(59,130,246,0.8)]":"bg-transparent hover:bg-white/5"}`})]},l))]}),e.jsxs("div",{className:"p-8 bg-slate-50 border border-slate-200 rounded-[2.5rem] shadow-sm space-y-8",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[q.map(t=>e.jsx("button",{onClick:()=>_(t),className:"w-14 h-14 bg-white rounded-2xl shadow-sm border border-slate-200 hover:border-indigo-500 transition-all flex items-center justify-center font-black text-base",children:t},t)),e.jsx("div",{className:`${i?"mr-auto":"ml-auto"} flex gap-3`,children:e.jsx("button",{onClick:Me,className:"w-14 h-14 bg-white text-rose-500 rounded-2xl border border-slate-200 hover:bg-rose-50 transition-all flex items-center justify-center",children:e.jsx(et,{size:18})})})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200 flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{type:"text",placeholder:i?"عدد سفارشی...":"Custom Number...",value:N,onChange:t=>O(t.target.value),className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-3 text-sm font-bold outline-none focus:ring-4 focus:ring-blue-500/5",onKeyDown:t=>t.key==="Enter"&&V()})}),e.jsx("button",{onClick:V,className:"px-6 py-3 bg-slate-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all",children:i?"درج":"Inject"})]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3rem] shadow-sm flex flex-col mt-10",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 bg-slate-50/50 rounded-t-[3rem]",children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] shrink-0 flex items-center gap-2",children:[e.jsx(nt,{size:12})," ",s.metricInputCatalog]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(ge,{size:14,className:`absolute ${i?"right-3":"left-3"} top-1/2 -translate-y-1/2 text-slate-300`}),e.jsx("input",{className:`w-full ${i?"pr-9 pl-4":"pl-9 pr-4"} py-2 bg-white border border-slate-200 rounded-xl text-[10px] font-bold uppercase outline-none focus:ring-4 focus:ring-blue-500/10 transition-all`,placeholder:s.filterVectors,value:M,onChange:t=>De(t.target.value)})]})]}),e.jsx("div",{className:"p-6 space-y-3",children:Object.entries(ve).map(([t,l])=>{const r=l.filter(c=>c.key.toLowerCase().includes(M.toLowerCase())||c.label.toLowerCase().includes(M.toLowerCase()));if(r.length===0)return null;const n=we.has(t);return e.jsxs("div",{className:"space-y-1 border border-slate-100 rounded-2xl overflow-hidden bg-white shadow-sm",children:[e.jsxs("button",{onClick:()=>Te(t),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-slate-50 transition-all text-left",children:[e.jsxs("span",{className:"text-[10px] font-black uppercase text-slate-600 tracking-widest flex items-center gap-2",children:[e.jsx(Ke,{size:12,className:"text-blue-500"})," ",t]}),e.jsx(Pe,{size:14,className:`text-slate-300 transition-transform duration-300 ${n?"rotate-180 text-blue-500":""}`})]}),n&&e.jsx("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 animate-in slide-in-from-top-2",children:r.map(c=>e.jsxs("button",{onClick:()=>_(c.key),className:`p-4 bg-slate-50 border border-slate-100 rounded-2xl text-left hover:bg-indigo-600 hover:text-white transition-all flex flex-col gap-1 group ${i?"text-right":"text-left"}`,children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight truncate",children:c.label}),e.jsx("span",{className:"text-[8px] font-bold opacity-50 uppercase group-hover:opacity-100",children:c.key})]},c.key))})]},t)})})]})]}),x===3&&e.jsxs("div",{className:"space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter mb-2",children:s.boundaryControl}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:s.operationalEnvelope})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] border-b border-slate-100 pb-2 flex items-center gap-2",children:[e.jsx(Qe,{size:12,className:"text-emerald-500"})," ",s.nominalPerformance]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.expMin}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(U=a.threshold)==null?void 0:U.expectedMin,onChange:t=>o({...a,threshold:{...a.threshold,expectedMin:parseFloat(t.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.expMax}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(J=a.threshold)==null?void 0:J.expectedMax,onChange:t=>o({...a,threshold:{...a.threshold,expectedMax:parseFloat(t.target.value)||0}})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.baselineMethodology}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-xs font-black uppercase outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(K=a.threshold)==null?void 0:K.baselineType,onChange:t=>o({...a,threshold:{...a.threshold,baselineType:t.target.value}}),children:[e.jsx("option",{value:"total",children:i?"مجموع اسمی (خام)":"Scalar Total (Raw Sum)"}),e.jsx("option",{value:"percentage",children:i?"درصد (0.0 - 100.0)":"Percentage (0.0 - 100.0)"}),e.jsx("option",{value:"perBird",children:i?"محاسبه به ازای هر پرنده":"Per Bird Calculation"}),e.jsx("option",{value:"average",children:i?"میانگین متحرک":"Rolling Mean Average"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"text-[10px] font-black text-rose-500 uppercase tracking-[0.2em] border-b border-rose-100 pb-2 flex items-center gap-2",children:[e.jsx(Re,{size:12})," ",s.anomalyViolation]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.alertMin}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-rose-500/5 transition-all",value:(Q=a.threshold)==null?void 0:Q.alertMin,onChange:t=>o({...a,threshold:{...a.threshold,alertMin:parseFloat(t.target.value)||0}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.alertMax}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-rose-500/5 transition-all",value:(Y=a.threshold)==null?void 0:Y.alertMax,onChange:t=>o({...a,threshold:{...a.threshold,alertMax:parseFloat(t.target.value)||0}})})]})]})]})]})]}),x===4&&e.jsxs("div",{className:"space-y-12 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter mb-2",children:s.signalDispatch}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:s.alertSensitivityNode})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 bg-slate-50 border border-slate-200 rounded-2xl shadow-inner",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${(Z=a.anomalyDetection)!=null&&Z.enabled?"bg-blue-100 text-blue-600":"bg-slate-200 text-slate-400"}`,children:e.jsx(We,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase text-slate-800",children:s.detectionLogic}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase",children:(X=a.anomalyDetection)!=null&&X.enabled?s.nodeActive:s.nodeQuiescent})]})]}),e.jsx("button",{onClick:()=>{var t;return o({...a,anomalyDetection:{...a.anomalyDetection,enabled:!((t=a.anomalyDetection)!=null&&t.enabled)}})},className:"transition-all",children:(ee=a.anomalyDetection)!=null&&ee.enabled?e.jsx(Ye,{size:40,className:"text-blue-600"}):e.jsx(dt,{size:40,className:"text-slate-300"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.anomalySeverityClass}),e.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-xs font-black uppercase outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(te=a.anomalyDetection)==null?void 0:te.severity,onChange:t=>o({...a,anomalyDetection:{...a.anomalyDetection,severity:t.target.value}}),children:Object.values(he).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.varianceTolerance}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(ae=a.anomalyDetection)==null?void 0:ae.variancePercent,onChange:t=>o({...a,anomalyDetection:{...a.anomalyDetection,variancePercent:parseInt(t.target.value)||0}})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.eventTriggerProtocol}),e.jsxs("select",{className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-xs font-black uppercase outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(se=a.anomalyDetection)==null?void 0:se.trigger,onChange:t=>o({...a,anomalyDetection:{...a.anomalyDetection,trigger:t.target.value}}),children:[e.jsx("option",{value:"exceeds_or_below",children:i?"نقض سراسری (دو طرفه)":"Global Breach (Dual Boundary)"}),e.jsx("option",{value:"above_only",children:i?"نقض سقف (فقط بالا)":"Ceiling Breach (Upper Only)"}),e.jsx("option",{value:"below_only",children:i?"نقض کف (فقط پایین)":"Floor Breach (Lower Only)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:s.persistenceAging}),e.jsx("input",{type:"number",className:"w-full bg-slate-50 border border-slate-200 rounded-2xl px-6 py-4 text-base font-black outline-none focus:ring-8 focus:ring-blue-500/5 transition-all",value:(le=a.anomalyDetection)==null?void 0:le.consecutiveDays,onChange:t=>o({...a,anomalyDetection:{...a.anomalyDetection,consecutiveDays:parseInt(t.target.value)||1}})}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 mt-2 px-1 italic",children:s.alertTriggerNote.replace("{days}",String((re=a.anomalyDetection)==null?void 0:re.consecutiveDays))})]})]})]})]}),x===5&&e.jsxs("div",{className:"space-y-10 animate-in fade-in slide-in-from-bottom-4 duration-500 flex flex-col",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-black text-slate-900 uppercase tracking-tighter mb-2",children:s.simulationRun}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:s.verifyNodeIntegrity})]}),e.jsxs("div",{className:"bg-slate-50 rounded-[3rem] p-10 border border-slate-200 space-y-10 shadow-inner flex flex-col",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8 pr-2",children:(((ne=a.calculation)==null?void 0:ne.dependencies)||[]).map(t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[9px] font-black text-slate-500 uppercase tracking-widest ml-1",children:[t," ",s.simulationValue]}),e.jsx("input",{type:"number",className:"w-full bg-white border border-slate-200 rounded-2xl px-5 py-4 text-sm font-black tabular-nums outline-none",value:z[t]||"",onChange:l=>Ne({...z,[t]:parseFloat(l.target.value)||0})})]},t))}),e.jsx("button",{onClick:_e,className:"w-full py-6 bg-slate-900 text-white rounded-[2rem] text-[12px] font-black uppercase tracking-[0.3em] hover:bg-black transition-all shadow-xl mt-auto",children:s.executeDiagnosticSimulation}),m&&e.jsxs("div",{className:`p-10 rounded-[3.5rem] border-2 shadow-2xl animate-in zoom-in-95 duration-500 mt-6 ${(ie=m.anomalyDetection)!=null&&ie.isAnomaly?"bg-rose-50 border-rose-100":"bg-emerald-50 border-emerald-100"}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase mb-1",children:s.simulatedSignalOutput}),e.jsxs("h4",{className:"text-6xl font-black text-slate-900 tabular-nums tracking-tighter",children:[(((oe=m.calculatedMetric)==null?void 0:oe.value)??m.value??0).toFixed(4),a.unit&&e.jsx("span",{className:"text-lg ml-2 text-slate-400 uppercase",children:a.unit})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`px-5 py-2.5 rounded-2xl text-[10px] font-black uppercase tracking-widest inline-block ${(ce=m.anomalyDetection)!=null&&ce.isAnomaly?"bg-rose-500 text-white":"bg-emerald-500 text-white"}`,children:(de=m.anomalyDetection)!=null&&de.isAnomaly?s.violationDetected:s.nominalConsensus}),((xe=m.anomalyDetection)==null?void 0:xe.expectedRange)&&e.jsxs("p",{className:"mt-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:[s.target,": ",m.anomalyDetection.expectedRange," ",a.unit]})]})]}),((pe=m.anomalyDetection)==null?void 0:pe.reason)&&e.jsxs("p",{className:"mt-8 text-sm font-bold text-slate-600 uppercase leading-relaxed border-t border-slate-100 pt-6 flex items-start gap-3",children:[e.jsx(fe,{size:16,className:"text-blue-500 shrink-0 mt-0.5"}),m.anomalyDetection.reason]})]})]})]}),e.jsxs("div",{className:"mt-12 pt-12 border-t border-slate-50 flex gap-6 shrink-0",children:[x>1&&e.jsx("button",{onClick:()=>j(t=>t-1),className:"flex-1 py-6 border border-slate-200 rounded-[2rem] text-[12px] font-black uppercase tracking-[0.2em] text-slate-400 hover:bg-slate-50 transition-all",children:s.back}),x<5?e.jsx("button",{onClick:()=>j(t=>t+1),className:"flex-[2] py-6 rounded-[2rem] text-[12px] font-black uppercase tracking-[0.2em] bg-slate-900 text-white shadow-2xl hover:bg-black transition-all",children:s.continue}):e.jsx("button",{onClick:Le,disabled:E,className:"flex-[2] py-6 rounded-[2rem] text-[12px] font-black uppercase tracking-[0.3em] shadow-2xl bg-blue-600 text-white hover:bg-blue-700 transition-all flex items-center justify-center gap-3",children:E?e.jsx(Ve,{size:24,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{size:24,strokeWidth:3})," ",s.commitToGlobalRegistry]})})]})]})]}),e.jsxs("div",{className:"w-full lg:w-96 space-y-8 shrink-0",children:[e.jsxs("div",{className:"bg-slate-900 rounded-[3rem] p-10 shadow-2xl text-white relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-blue-600/20 rounded-full translate-x-24 -translate-y-24 group-hover:scale-150 transition-transform duration-1000"}),e.jsx("h3",{className:"text-xl font-black uppercase tracking-tight mb-4 relative z-10",children:s.architectSupport}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase leading-relaxed mb-10 relative z-10 tracking-widest",children:s.architectSupportDesc}),e.jsxs("button",{onClick:()=>C==null?void 0:C("logic-support"),className:"w-full py-5 bg-white/10 hover:bg-white/20 border border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all relative z-10 flex items-center justify-center gap-2",children:[e.jsx(fe,{size:16})," ",s.reference]})]}),x===2&&e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[3rem] p-8 shadow-sm animate-in slide-in-from-bottom-4",children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-900 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(Ge,{size:14,className:"text-blue-500"})," ",s.logicGuard]}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 leading-relaxed uppercase",children:s.logicGuardDesc})]})]})]})};export{Dt as default};
